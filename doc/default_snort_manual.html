<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.9" />
<title>Snort++ User Manual</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

.monospaced, code, pre {
  font-family: "Courier New", Courier, monospace;
  font-size: inherit;
  color: navy;
  padding: 0;
  margin: 0;
}
pre {
  white-space: pre-wrap;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #888;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; vertical-align: text-bottom; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel0, div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }

div.unbreakable { page-break-inside: avoid; }


/*
 * xhtml11 specific
 *
 * */

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


@media screen {
  body {
    max-width: 50em; /* approximately 80 characters wide */
    margin-left: 16em;
  }

  #toc {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 13em;
    padding: 0.5em;
    padding-bottom: 1.5em;
    margin: 0;
    overflow: auto;
    border-right: 3px solid #f8f8f8;
    background-color: white;
  }

  #toc .toclevel1 {
    margin-top: 0.5em;
  }

  #toc .toclevel2 {
    margin-top: 0.25em;
    display: list-item;
    color: #aaaaaa;
  }

  #toctitle {
    margin-top: 0.5em;
  }
}
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([1-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName.toLowerCase() == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install(2);
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>Snort++ User Manual</h1>
<span id="author">The Snort Team</span><br />
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock">
<div class="content">
<img src="./snorty.png" alt="Snorty" width="480" />
</div>
</div>
<div class="literalblock">
<div class="content">
<pre><code> ,,_     -*&gt; Snort++ &lt;*-
o"  )~   Version 3.0.0-a1 (Build 131) from 2.9.6-9
 ''''    By Martin Roesch &amp; The Snort Team
         http://snort.org/snort/snort-team
         Copyright (C) 2014 Cisco and/or its affiliates. All rights reserved.
         Copyright (C) 1998-2013 Sourcefire, Inc., et al.</code></pre>
</div></div>
<div id="toc">
  <div id="toctitle">Contents</div>
  <noscript><p><b>JavaScript must be enabled in your browser to display the table of contents.</b></p></noscript>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview">Overview</h2>
<div class="sectionbody">
<div class="paragraph"><p>Snort++ is an updated version of the Snort IPS (intrusion prevention
system).  This document assumes you have some familiarity with Snort and
are looking to see what Snort++ has to offer.  Here are some of the basic
goals for Snort++:</p></div>
<div class="ulist"><ul>
<li>
<p>
Support multiple packet processing threads
</p>
</li>
<li>
<p>
Use a shared configuration and attribute table
</p>
</li>
<li>
<p>
Use a simple, scriptable configuration
</p>
</li>
<li>
<p>
Make key components pluggable
</p>
</li>
<li>
<p>
Autogenerate reference documentation
</p>
</li>
<li>
<p>
Autodetect services for portless configuration
</p>
</li>
<li>
<p>
Support sticky buffers in rules
</p>
</li>
<li>
<p>
Provide better cross platform support
</p>
</li>
</ul></div>
<div class="paragraph"><p>The above goals are met with this first alpha release.  Additional,
longer-term goals are:</p></div>
<div class="ulist"><ul>
<li>
<p>
Use a shared network map
</p>
</li>
<li>
<p>
Support pipelining of packet processing
</p>
</li>
<li>
<p>
Support hardware offload and data plane integration
</p>
</li>
<li>
<p>
Rewrite critical modules like TCP reassembly and HTTP inspection
</p>
</li>
<li>
<p>
Support proxy mode
</p>
</li>
<li>
<p>
Facilitate component testing
</p>
</li>
<li>
<p>
Simplify memory management
</p>
</li>
<li>
<p>
Provide all of Snort&#8217;s functionality
</p>
</li>
</ul></div>
<div class="paragraph"><p>This first alpha release is based on Snort 2.9.6-9 and excludes all but one
of Snort&#8217;s dynamic preprocessors.  Work is underway to port that
functionality and additions will be rolled out as they become available.</p></div>
<div class="sect2">
<h3 id="_configuration">Configuration</h3>
<div class="paragraph"><p>Note that retaining backwards compatibility is not a goal.  While Snort++
leverages some of the Snort code base, a lot has changed.  The
configuration of Snort++ is done with Lua, so your old conf won&#8217;t work as
is.  Rules are still text based but nonetheless incompatible.  However,
Snort2Lua will help you convert your conf and rules to the new format.</p></div>
<div class="paragraph"><p>The original Snort manual may be useful for some background information not
yet documented for Snort++.  The configuration differences are given in
this manual.</p></div>
</div>
<div class="sect2">
<h3 id="_modules">Modules</h3>
<div class="paragraph"><p>Snort++ is organized into a collection of builtin and plugin modules.
If a module has parameters, it is configured by a Lua table of the same
name.  For example, we can see what the active module has to offer with
this command:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>$ snort --help-module active</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>What: configure responses</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>Type: basic</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>Configuration:</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>int active.attempts = 0: number of TCP packets sent per response (with
varying sequence numbers) { 0:20 }</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>string active.device: use 'ip' for network layer responses or 'eth0' etc
for link layer</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>string active.dst_mac: use format '01:23:45:67:89:ab'</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>int active.max_responses = 0: maximum number of responses { 0: }</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>int active.min_interval = 255: minimum number of seconds between
responses { 1: }</code></pre>
</div></div>
<div class="paragraph"><p>This says active is a basic module that has several parameters.  For each,
you will see:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>type module.name = default: help { range }</code></pre>
</div></div>
<div class="paragraph"><p>For example, the active module has a max_responses parameter that takes
non-negative integer values and defaults to zero.  We can change that in
Lua as follows:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>active = { max_responses = 1 }</code></pre>
</div></div>
<div class="paragraph"><p>or:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>active = { }
active.max_responses = 1</code></pre>
</div></div>
<div class="paragraph"><p>If we also wanted to limit retries to at least 5 seconds, we could do:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>active = { max_responses = 1, min_interval = 5 }</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_plugins">Plugins</h3>
<div class="paragraph"><p>There are several plugin types:</p></div>
<div class="ulist"><ul>
<li>
<p>
Codec - to decode and encode packets
</p>
</li>
<li>
<p>
Inspector - like the prior preprocessors, for normalization, etc.
</p>
</li>
<li>
<p>
IpsOption - for detection in Snort++ IPS rules
</p>
</li>
<li>
<p>
IpsAction - for custom rule actions
</p>
</li>
<li>
<p>
Logger - for handling events
</p>
</li>
<li>
<p>
Mpse - for fast pattern matching
</p>
</li>
<li>
<p>
So - for dynamic rules
</p>
</li>
</ul></div>
<div class="paragraph"><p>Most plugins can be built statically or dynamically.  By default they are
all static.  There is no difference in functionality between static or
dynamic plugins but the dynamic build generates a slightly lighter weight
binary.  Either way you can add dynamic plugins with --plugin-path and
newer versions will replace older versions, even when built statically.</p></div>
<div class="paragraph"><p>The power of plugins is that they have a very focused purpose and can be
created with relative ease.  For example, you can extend the rule language
by writing your own IpsOption and it will plug in and function just like
existing options.  The extra directory has examples of each type of plugin.</p></div>
</div>
<div class="sect2">
<h3 id="_scripts">Scripts</h3>
<div class="paragraph"><p>Some things just need to be tweaked or prototyped quickly.  In addition to
the Lua conf, which is a script that can contain functions to compute
settings, etc., you can also script Loggers and IpsOptions.</p></div>
</div>
<div class="sect2">
<h3 id="_new_http_inspector">New Http Inspector</h3>
<div class="paragraph"><p>The Http Inspector is being rewritten from scratch. The incomplete
work-in-progress is included in this release as "new_http_inspect". The
original Http Inspector remains available for regular use.</p></div>
<div class="paragraph"><p>The new Http Inspector is based entirely on processing HTTP messages that
it parses from the TCP data stream. This is in contrast to its predecessor
which frequently works directly with raw packets. The new approach makes
the inspector much simpler, enabling easy addition of new features. It
also renders HTTP inspection independent of how the message is subdivided
into packets, neutralizing many potential evasions.</p></div>
<div class="paragraph"><p>The inspector will contain much more detailed information about HTTP
features such as methods, header fields, and status codes, with easy
addition of new items through tables. This information will be used to
provide a more thorough inspection capability for incorrect or suspicious
protocol usage. Detection will benefit from normalization of individual
message header field values using algorithms tailored to the specific field.
For example a field containing a date will be normalized into a standard
date format.</p></div>
<div class="paragraph"><p>Long-term the goal is to implement SPDY/HTTP 2.0 and other advanced web
protocols.</p></div>
</div>
<div class="sect2">
<h3 id="_binder">Binder</h3>
<div class="paragraph"><p>The binder collects all the legacy Snort preprocessor network and port
settings and config binding settings into one table within each policy.
You can now bind by both VLANs and CIDRs instead of one or the other.  The
criteria are given by binder.when and include policy ID, interfaces, VLANs,
networks, protocol, ports, role, and service.</p></div>
<div class="paragraph"><p>If service inspectors and wizard are configured but no binder is
configured, a default binder is created that binds based on the wizard.</p></div>
</div>
<div class="sect2">
<h3 id="_wizard">Wizard</h3>
<div class="paragraph"><p>The wizard examines the initial payload of TCP and UDP sessions and
attempts to determine which service inspector if any should examine the
traffic.  Use the wizard for portless configurations or to augment
port-based configurations to catch otherwise unknown traffic, including
command and control channels.  The wizard is still under development and
should be considered experimental.  If you find you need to tweak the
defaults please let us know.</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_getting_started">Getting Started</h2>
<div class="sectionbody">
<div class="paragraph"><p>The following pointers will help you get started:</p></div>
<div class="sect2">
<h3 id="_dependencies">Dependencies</h3>
<div class="paragraph"><p>Required:</p></div>
<div class="ulist"><ul>
<li>
<p>
autotools or cmake to build from source
</p>
</li>
<li>
<p>
g++ &gt;= 4.8 or other recent C++11 compiler
</p>
</li>
<li>
<p>
daq from <a href="http://www.snort.org">http://www.snort.org</a> for packet IO
</p>
</li>
<li>
<p>
dnet from <a href="http://code.google.com/p/libdnet/">http://code.google.com/p/libdnet/</a> for network utility functions
</p>
</li>
<li>
<p>
LuaJIT from <a href="http://luajit.org">http://luajit.org</a> for configuration and scripting
</p>
</li>
<li>
<p>
pcap from <a href="http://www.tcpdump.org">http://www.tcpdump.org</a> for tcpdump style logging
</p>
</li>
<li>
<p>
pcre from <a href="http://www.pcre.org">http://www.pcre.org</a> for regular expression pattern matching
</p>
</li>
<li>
<p>
zlib from <a href="http://www.zlib.net">http://www.zlib.net</a> for decompression
</p>
</li>
<li>
<p>
pkgconfig from <a href="http://www.freedesktop.org">http://www.freedesktop.org</a> to build the example plugins
</p>
</li>
</ul></div>
<div class="paragraph"><p>Optional:</p></div>
<div class="ulist"><ul>
<li>
<p>
asciidoc from <a href="http://www.methods.co.nz/asciidoc/">http://www.methods.co.nz/asciidoc/</a> to build the HTML
  manual
</p>
</li>
<li>
<p>
dblatex from <a href="http://dblatex.sourceforge.net">http://dblatex.sourceforge.net</a> to build the pdf manual (in
  addition to asciidoc)
</p>
</li>
<li>
<p>
check from <a href="http://check.sourceforge.net">http://check.sourceforge.net</a> to build unit tests
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_building">Building</h3>
<div class="ulist"><ul>
<li>
<p>
Optionally built features are listed in the reference section.
</p>
</li>
<li>
<p>
Create an install path:
</p>
<div class="literalblock">
<div class="content">
<pre><code>export my_path=/path/to/snorty
mkdir -p $my_path</code></pre>
</div></div>
</li>
<li>
<p>
Do one of the following:
</p>
<div class="olist loweralpha"><ol class="loweralpha">
<li>
<p>
To build with autotools, simply do the usual from the top level directory:
</p>
<div class="literalblock">
<div class="content">
<pre><code>./configure --prefix=$my_path
make -j 8
make install</code></pre>
</div></div>
</li>
<li>
<p>
To build with cmake and make, run configure_cmake.sh.  It will
   automatically create and populate a new subdirectory named <em>build</em>.
</p>
<div class="literalblock">
<div class="content">
<pre><code>./configure_cmake.sh --prefix=$my_path
cd build
make -j 8
make install
ln -s $my_path/conf $my_path/etc</code></pre>
</div></div>
</li>
<li>
<p>
You can also specify a cmake project generator or use ccmake:
</p>
<div class="literalblock">
<div class="content">
<pre><code>./configure_cmake --generator=Xcode --prefix=$my_path</code></pre>
</div></div>
</li>
</ol></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_run">Run</h3>
<div class="paragraph"><p>First set up the environment:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>export LUA_PATH=$my_path/include/snort/lua/\?.lua\;\;
export SNORT_LUA_PATH=$my_path/etc</code></pre>
</div></div>
<div class="paragraph"><p>Then give it a go:</p></div>
<div class="ulist"><ul>
<li>
<p>
Get some help:
</p>
<div class="literalblock">
<div class="content">
<pre><code>$my_path/bin/snort --help
$my_path/bin/snort --help-module suppress
$my_path/bin/snort --help-config | grep thread</code></pre>
</div></div>
</li>
<li>
<p>
Examine and dump a pcap:
</p>
<div class="literalblock">
<div class="content">
<pre><code>$my_path/bin/snort -r &lt;pcap&gt;
$my_path/bin/snort -K text -d -e -q -r &lt;pcap&gt;</code></pre>
</div></div>
</li>
<li>
<p>
Verify config, with or w/o rules:
</p>
<div class="literalblock">
<div class="content">
<pre><code>$my_path/bin/snort -c $my_path/etc/snort.lua
$my_path/bin/snort -c $my_path/etc/snort.lua -R $my_path/etc/sample.rules</code></pre>
</div></div>
</li>
<li>
<p>
Run IDS mode.  To keep it brief, look at the first n packets in each file:
</p>
<div class="literalblock">
<div class="content">
<pre><code>$my_path/bin/snort -c $my_path/etc/snort.lua -R $my_path/etc/sample.rules \
    -r &lt;pcap&gt; -A alert_test -n 100000</code></pre>
</div></div>
</li>
<li>
<p>
Let&#8217;s suppress 1:2123.  We could edit the conf or just do this:
</p>
<div class="literalblock">
<div class="content">
<pre><code>$my_path/bin/snort -c $my_path/etc/snort.lua -R $my_path/etc/sample.rules \
    -r &lt;pcap&gt; -A alert_test -n 100000 --lua "suppress = { { gid = 1, sid = 2123 } }"</code></pre>
</div></div>
</li>
<li>
<p>
Go whole hog on a directory with multiple packet threads:
</p>
<div class="literalblock">
<div class="content">
<pre><code>$my_path/bin/snort -c $my_path/etc/snort.lua -R $my_path/etc/sample.rules \
    --pcap-filter \*.pcap --pcap-dir &lt;dir&gt; -A alert_fast -n 1000 --max-packet-threads 8</code></pre>
</div></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_tips">Tips</h3>
<div class="ulist"><ul>
<li>
<p>
Legacy rules and includes must be put in ips.include = <em>filename</em>
  and/or ips.rules = <em>string</em> or [[ multi line string ]].
</p>
</li>
<li>
<p>
You can also use snort2lua to convert your legacy Snort conf file into a
  Snort++ lua file.
</p>
</li>
<li>
<p>
You can override or add to your lua config with the --lua command line
  option.  You can even add rules to your config via the command line.
</p>
</li>
<li>
<p>
The Lua config is a <em>live</em> script that is executed when loaded.  You can
  add functions, grab environment variables, compute values, etc.
</p>
</li>
<li>
<p>
By default, symbols unknown to Snort++ are silently ignored.  You can
  generate warnings for with --warn-unknown.  Adding --pedantic makes them
  fatal.  To ignore such symbols, export them in the environment variable
  SNORT_IGNORE.
</p>
</li>
<li>
<p>
You can also rename symbols that you want to disable.  For example,
  changing normalizer to Xnormalizer will disable the normalizer.  This can
  be easier than commenting in some cases.
</p>
</li>
<li>
<p>
Load plugins from the command line with --plugin-path /path/to/install/lib.
</p>
</li>
<li>
<p>
Snort++ tries hard not to error out too quickly.  It will report multiple
  semantic errors.  It always assumes the simplest mode of operation.
</p>
</li>
<li>
<p>
You can process multiple sources at one time by using the -z or
  --max-threads option.
</p>
</li>
<li>
<p>
Unit tests are configured with --enable-unit-tests (libcheck is
  required).  They can then be run with snort --unit-test [&lt;mode&gt;] where mode
  is a libcheck print_mode (silent, minimal, normal, etc.).
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_help">Help</h3>
<div class="listingblock">
<div class="content">
<pre><code>Snort has several options to get more help:

-? list command line options (same as --help)
--help this overview of help
--help-commands [&lt;module prefix&gt;] output matching commands
--help-config [&lt;module prefix&gt;] output matching config options
--help-counts [&lt;module prefix&gt;] output matching peg counts
--help-module &lt;module&gt; output description of given module
--help-modules list all available modules with brief help
--help-plugins list all available plugins with brief help
--help-options [&lt;option prefix&gt;] output matching command line options
--help-signals dump available control signals
--list-buffers output available inspection buffers
--list-builtin [&lt;module prefix&gt;] output matching builtin rules
--list-gids [&lt;module prefix&gt;] output matching generators
--list-modules [&lt;module type&gt;] list all known modules
--list-plugins list all known modules
--show-plugins list module and plugin versions

--help* and --list* options preempt other processing so should be last on the
command line since any following options are ignored.  To ensure options like
--markup and --plugin-path take effect, place them ahead of the help or list
options.

Options that filter output based on a matching prefix, such as --help-config
won't output anything if there is no match.  If no prefix is given, everything
matches.

Report bugs to bugs@snort.org.</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_common_errors">Common Errors</h3>
<div class="paragraph"><p><em>FATAL: snort_config is required</em></p></div>
<div class="ulist"><ul>
<li>
<p>
add this line near top of file:
</p>
<div class="literalblock">
<div class="content">
<pre><code>require('snort_config')</code></pre>
</div></div>
</li>
</ul></div>
<div class="paragraph"><p><em>PANIC: unprotected error in call to Lua API (cannot open
snort_defaults.lua: No such file or directory)</em></p></div>
<div class="ulist"><ul>
<li>
<p>
export SNORT_LUA_PATH to point to any dofiles
</p>
</li>
</ul></div>
<div class="paragraph"><p><em>ERROR can&#8217;t find xyz</em></p></div>
<div class="ulist"><ul>
<li>
<p>
if xyz is the name of a module, make sure you are not assigning a scalar
  where a table is required (e.g. xyz = 2 should be xyz = { }).
</p>
</li>
</ul></div>
<div class="paragraph"><p><em>ERROR can&#8217;t find x.y</em></p></div>
<div class="ulist"><ul>
<li>
<p>
module x does not have a parameter named y.  check --help-module x for
  available parameters.
</p>
</li>
</ul></div>
<div class="paragraph"><p><em>ERROR invalid x.y = z</em></p></div>
<div class="ulist"><ul>
<li>
<p>
the value z is out of range for x.y.  check --help-config x.y for the range
  allowed.
</p>
</li>
</ul></div>
<div class="paragraph"><p><em>ERROR: x = { y = z } is in conf but is not being applied</em></p></div>
<div class="ulist"><ul>
<li>
<p>
make sure that x = { } isn&#8217;t set later because it will override the
  earlier setting.  same for x.y.
</p>
</li>
</ul></div>
<div class="paragraph"><p><em>FATAL: can&#8217;t load lua/errors.lua: lua/errors.lua:68: <em>=</em> expected near
';'</em></p></div>
<div class="ulist"><ul>
<li>
<p>
this is a syntax error reported by Lua to Snort on line 68 of errors.lua.
</p>
</li>
</ul></div>
<div class="paragraph"><p><em>ERROR: rules(2) unknown rule keyword: find.</em></p></div>
<div class="ulist"><ul>
<li>
<p>
this was due to not including the --script-path.
</p>
</li>
</ul></div>
<div class="paragraph"><p><em>WARNING: unknown symbol x</em></p></div>
<div class="ulist"><ul>
<li>
<p>
if you any variables, you can squelch such warnings by setting them in
  an environment variable SNORT_IGNORE.  to ignore x, y, and z:
</p>
<div class="literalblock">
<div class="content">
<pre><code>export SNORT_IGNORE="x y z"</code></pre>
</div></div>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_gotchas">Gotchas</h3>
<div class="ulist"><ul>
<li>
<p>
A nil key in a table will not caught.  Neither will a nil value in a
  table.  Neither of the following will cause errors, nor will they
  actually set http_server.post_depth:
</p>
<div class="literalblock">
<div class="content">
<pre><code>http_server = { post_depth }
http_server = { post_depth = undefined_symbol }</code></pre>
</div></div>
</li>
<li>
<p>
It is not an error to set a value multiple times.  The actual value
  applied may not be the last in the table either.  It is best to avoid
  such cases.
</p>
<div class="literalblock">
<div class="content">
<pre><code>http_server =
{
    post_depth = 1234,
    post_depth = 4321
}</code></pre>
</div></div>
</li>
<li>
<p>
Snort can&#8217;t tell you the exact filename or line number of a semantic
  error but it will tell you the fully qualified name.
</p>
</li>
<li>
<p>
The dump DAQ will not work with multiple threads unless you use --daq-var
  file=/dev/null.  This will be fixed in at some point to use the Snort log
  directory, etc.
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_basic_modules">Basic Modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>Internal modules which are not plugins are termed "basic".  These include
configuration for core processing.</p></div>
<div class="sect2">
<h3 id="_active">active</h3>
<div class="paragraph"><p>What: configure responses</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>active.attempts</strong> = 0: number of TCP packets sent per response (with varying sequence numbers) { 0:20 }
</p>
</li>
<li>
<p>
string <strong>active.device</strong>: use <em>ip</em> for network layer responses or <em>eth0</em> etc for link layer
</p>
</li>
<li>
<p>
string <strong>active.dst_mac</strong>: use format <em>01:23:45:67:89:ab</em>
</p>
</li>
<li>
<p>
int <strong>active.max_responses</strong> = 0: maximum number of responses { 0: }
</p>
</li>
<li>
<p>
int <strong>active.min_interval</strong> = 255: minimum number of seconds between responses { 1: }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_alerts">alerts</h3>
<div class="paragraph"><p>What: configure alerts</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>alerts.alert_with_interface_name</strong> = false: include interface in alert info (fast, full, or syslog only)
</p>
</li>
<li>
<p>
bool <strong>alerts.default_rule_state</strong> = true: enable or disable ips rules
</p>
</li>
<li>
<p>
int <strong>alerts.detection_filter_memcap</strong> = 1048576: set available memory for filters { 0: }
</p>
</li>
<li>
<p>
int <strong>alerts.event_filter_memcap</strong> = 1048576: set available memory for filters { 0: }
</p>
</li>
<li>
<p>
int <strong>alerts.flowbits_size</strong> = 1024: maximum number of allowed unique flowbits { 0:2048 }
</p>
</li>
<li>
<p>
string <strong>alerts.order</strong> = pass drop alert log: change the order of rule action application
</p>
</li>
<li>
<p>
int <strong>alerts.rate_filter_memcap</strong> = 1048576: set available memory for filters { 0: }
</p>
</li>
<li>
<p>
string <strong>alerts.reference_net</strong>: set the CIDR for homenet (for use with -l or -B, does NOT change $HOME_NET in IDS mode)
</p>
</li>
<li>
<p>
bool <strong>alerts.stateful</strong> = false: don&#8217;t alert w/o established session (note: rule action still taken)
</p>
</li>
<li>
<p>
string <strong>alerts.tunnel_verdicts</strong>: let DAQ handle non-allow verdicts for GTP|Teredo|6in4|4in6 traffic
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_attribute_table">attribute_table</h3>
<div class="paragraph"><p>What: configure hosts loading</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>attribute_table.max_hosts</strong> = 1024: maximum number of hosts in attribute table { 32:207551 }
</p>
</li>
<li>
<p>
int <strong>attribute_table.max_services_per_host</strong> = 8: maximum number of services per host entry in attribute table { 1:65535 }
</p>
</li>
<li>
<p>
int <strong>attribute_table.max_metadata_services</strong> = 8: maximum number of services in rule metadata { 1:256 }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_classifications">classifications</h3>
<div class="paragraph"><p>What: define rule categories with priority</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>classifications[].name</strong>: name used with classtype rule option
</p>
</li>
<li>
<p>
int <strong>classifications[].priority</strong> = 1: default priority for class { 0: }
</p>
</li>
<li>
<p>
string <strong>classifications[].text</strong>: description of class
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_daq">daq</h3>
<div class="paragraph"><p>What: configure packet acquisition interface</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>daq.dir</strong>: directory where to search for DAQ plugins
</p>
</li>
<li>
<p>
select <strong>daq.mode</strong>: set mode of operation { passive | inline | read-file }
</p>
</li>
<li>
<p>
bool <strong>daq.no_promisc</strong> = false: whether to put DAQ device into promiscuous mode
</p>
</li>
<li>
<p>
string <strong>daq.type</strong> = pcap: select type of DAQ
</p>
</li>
<li>
<p>
string <strong>daq.var</strong>: list of name=value DAQ-specific parameters
</p>
</li>
<li>
<p>
int <strong>daq.snaplen</strong> = deflt: set snap length (same as -P) { 0:65535 }
</p>
</li>
<li>
<p>
bool <strong>daq.decode_data_link</strong> = false: display the second layer header info
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>daq.pcaps</strong>: total files processed
</p>
</li>
<li>
<p>
<strong>daq.received</strong>: total packets received from DAQ
</p>
</li>
<li>
<p>
<strong>daq.analyzed</strong>: total packets analyzed from DAQ
</p>
</li>
<li>
<p>
<strong>daq.dropped</strong>: packets dropped
</p>
</li>
<li>
<p>
<strong>daq.filtered</strong>: packets filtered out
</p>
</li>
<li>
<p>
<strong>daq.outstanding</strong>: packets unprocessed
</p>
</li>
<li>
<p>
<strong>daq.injected</strong>: active responses or replacements
</p>
</li>
<li>
<p>
<strong>daq.allow</strong>: total allow verdicts
</p>
</li>
<li>
<p>
<strong>daq.block</strong>: total block verdicts
</p>
</li>
<li>
<p>
<strong>daq.replace</strong>: total replace verdicts
</p>
</li>
<li>
<p>
<strong>daq.whitelist</strong>: total whitelist verdicts
</p>
</li>
<li>
<p>
<strong>daq.blacklist</strong>: total blacklist verdicts
</p>
</li>
<li>
<p>
<strong>daq.ignore</strong>: total ignore verdicts
</p>
</li>
<li>
<p>
<strong>daq.internal blacklist</strong>: packets blacklisted internally due to lack of DAQ support
</p>
</li>
<li>
<p>
<strong>daq.internal whitelist</strong>: packets whitelisted internally due to lack of DAQ support
</p>
</li>
<li>
<p>
<strong>daq.skipped</strong>: packets skipped at startup
</p>
</li>
<li>
<p>
<strong>daq.fail open</strong>: packets passed during initialization
</p>
</li>
<li>
<p>
<strong>daq.idle</strong>: attempts to acquire from DAQ without available packets
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_decode">decode</h3>
<div class="paragraph"><p>What: general decoder rules</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:450</strong> (decode) BAD-TRAFFIC bad IP protocol
</p>
</li>
<li>
<p>
<strong>116:293</strong> (decode) two or more IP (v4 and/or v6) encapsulation layers present
</p>
</li>
<li>
<p>
<strong>116:459</strong> (decode) fragment with zero length
</p>
</li>
<li>
<p>
<strong>116:150</strong> (decode) bad traffic loopback IP
</p>
</li>
<li>
<p>
<strong>116:151</strong> (decode) bad traffic same src/dst IP
</p>
</li>
<li>
<p>
<strong>116:467</strong> (decode) too many protocols present
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_detection">detection</h3>
<div class="paragraph"><p>What: configure general IPS rule processing parameters</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>detection.asn1</strong> = 256: maximum decode nodes { 1: }
</p>
</li>
<li>
<p>
bool <strong>detection.pcre_enable</strong> = true: disable pcre pattern matching
</p>
</li>
<li>
<p>
int <strong>detection.pcre_match_limit</strong> = 1500: limit pcre backtracking, -1 = max, 0 = off { -1:1000000 }
</p>
</li>
<li>
<p>
int <strong>detection.pcre_match_limit_recursion</strong> = 1500: limit pcre stack consumption, -1 = max, 0 = off { -1:10000 }
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>detection.analyzed</strong>: packets sent to detection
</p>
</li>
<li>
<p>
<strong>detection.alerts</strong>: alerts not including IP reputation
</p>
</li>
<li>
<p>
<strong>detection.total alerts</strong>: alerts including IP reputation
</p>
</li>
<li>
<p>
<strong>detection.logged</strong>: logged packets
</p>
</li>
<li>
<p>
<strong>detection.passed</strong>: passed packets
</p>
</li>
<li>
<p>
<strong>detection.match limit</strong>: fast pattern matches not processed
</p>
</li>
<li>
<p>
<strong>detection.queue limit</strong>: events not queued because queue full
</p>
</li>
<li>
<p>
<strong>detection.log limit</strong>: events queued but not logged
</p>
</li>
<li>
<p>
<strong>detection.event limit</strong>: events filtered
</p>
</li>
<li>
<p>
<strong>detection.alert limit</strong>: events previously triggered on same PDU
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_event_filter">event_filter</h3>
<div class="paragraph"><p>What: configure thresholding of events</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>event_filter[].gid</strong> = 1: rule generator ID { 0: }
</p>
</li>
<li>
<p>
int <strong>event_filter[].sid</strong> = 1: rule signature ID { 0: }
</p>
</li>
<li>
<p>
enum <strong>event_filter[].type</strong>: 1st count events | every count events | once after count events { limit | threshold | both }
</p>
</li>
<li>
<p>
enum <strong>event_filter[].track</strong>: filter only matching source or destination addresses { by_src | by_dst }
</p>
</li>
<li>
<p>
int <strong>event_filter[].count</strong> = 0: number of events in interval before tripping; -1 to disable { -1: }
</p>
</li>
<li>
<p>
int <strong>event_filter[].seconds</strong> = 0: count interval { 0: }
</p>
</li>
<li>
<p>
string <strong>event_filter[].ip</strong>: restrict filter to these addresses according to track
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_event_queue">event_queue</h3>
<div class="paragraph"><p>What: configure event queue parameters</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>event_queue.max_queue</strong> = 8: maximum events to queue { 1: }
</p>
</li>
<li>
<p>
int <strong>event_queue.log</strong> = 3: maximum events to log { 1: }
</p>
</li>
<li>
<p>
enum <strong>event_queue.order_events</strong> = content_length: criteria for ordering incoming events { priority|content_length }
</p>
</li>
<li>
<p>
bool <strong>event_queue.process_all_events</strong> = false: process just first action group or all action groups
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_file_id">file_id</h3>
<div class="paragraph"><p>What: configure file identification</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>file_id.type_depth</strong> = 1460: stop type ID at this point { 0: }
</p>
</li>
<li>
<p>
int <strong>file_id.signature_depth</strong> = 10485760: stop signature at this point { 0: }
</p>
</li>
<li>
<p>
int <strong>file_id.block_timeout</strong> = 86400: stop blocking after this many seconds { 0: }
</p>
</li>
<li>
<p>
int <strong>file_id.lookup_timeout</strong> = 2: give up on lookup after this many seconds { 0: }
</p>
</li>
<li>
<p>
bool <strong>file_id.block_timeout_lookup</strong> = false: block if lookup times out
</p>
</li>
<li>
<p>
bool <strong>file_id.enable_type</strong> = false: enable type ID
</p>
</li>
<li>
<p>
bool <strong>file_id.enable_signature</strong> = false: enable signature calculation
</p>
</li>
<li>
<p>
int <strong>file_id.show_data_depth</strong> = 100: print this many octets { 0: }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_hosts">hosts</h3>
<div class="paragraph"><p>What: configure hosts</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
addr <strong>hosts[].ip</strong> = 0.0.0.0/32: hosts address / cidr
</p>
</li>
<li>
<p>
enum <strong>hosts[].frag_policy</strong> = linux: defragmentation policy { unknown | first | linux | bsd | bsd_right |last | windows | solaris }
</p>
</li>
<li>
<p>
enum <strong>hosts[].tcp_policy</strong> = linux: tcp reassembly policy { unknown | first | last | bsd | linux | old-linux | windows | win-2003 | vista | solaris | hpux | hpux10 | irix | macos }
</p>
</li>
<li>
<p>
string <strong>hosts[].services[].name</strong>: service identifier
</p>
</li>
<li>
<p>
enum <strong>hosts[].services[].proto</strong> = tcp: ip protocol { tcp | udp }
</p>
</li>
<li>
<p>
port <strong>hosts[].services[].port</strong>: port number
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_ips">ips</h3>
<div class="paragraph"><p>What: configure IPS rule processing</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>ips.enable_builtin_rules</strong> = false: enable events from builtin rules w/o stubs
</p>
</li>
<li>
<p>
int <strong>ips.id</strong> = 0: correlate unified2 events with configuration { 0:65535 }
</p>
</li>
<li>
<p>
string <strong>ips.include</strong>: legacy snort rules and includes
</p>
</li>
<li>
<p>
enum <strong>ips.mode</strong> = tap: set policy mode { tap | inline | inline-test }
</p>
</li>
<li>
<p>
string <strong>ips.rules</strong>: snort rules and includes
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_network">network</h3>
<div class="paragraph"><p>What: configure basic network parameters</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
multi <strong>network.checksum_drop</strong> = none: drop if checksum is bad { all | ip | noip | tcp | notcp | udp | noudp | icmp | noicmp | none }
</p>
</li>
<li>
<p>
multi <strong>network.checksum_eval</strong> = none: checksums to verify { all | ip | noip | tcp | notcp | udp | noudp | icmp | noicmp | none }
</p>
</li>
<li>
<p>
bool <strong>network.decode_drops</strong> = false: enable dropping of packets by the decoder
</p>
</li>
<li>
<p>
int <strong>network.id</strong> = 0: correlate unified2 events with configuration { 0:65535 }
</p>
</li>
<li>
<p>
int <strong>network.min_ttl</strong> = 1: alert / normalize packets with lower ttl / hop limit (you must enable rules and / or normalization also) { 1:255 }
</p>
</li>
<li>
<p>
int <strong>network.new_ttl</strong> = 1: use this value for responses and when normalizing { 1:255 }
</p>
</li>
<li>
<p>
int <strong>network.layers</strong> = 40: The maximum number of protocols that Snort can correctly decode { 3:255 }
</p>
</li>
<li>
<p>
int <strong>network.max_ip6_extensions</strong> = 0: The number of IP6 options Snort will process for a given IPv6 layer. If this limit is hit, rule 116:456 may fire.  0 = unlimited { 0:255 }
</p>
</li>
<li>
<p>
int <strong>network.max_ip_layers</strong> = 0: The maximum number of IP layers Snort will process for a given packet If this limit is hit, rule 116:293 may fire.  0 = unlimited { 0:255 }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_output">output</h3>
<div class="paragraph"><p>What: configure general output parameters</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>output.dump_chars_only</strong> = false: turns on character dumps (same as -C)
</p>
</li>
<li>
<p>
bool <strong>output.dump_payload</strong> = false: dumps application layer (same as -d)
</p>
</li>
<li>
<p>
bool <strong>output.dump_payload_verbose</strong> = false: dumps raw packet starting at link layer (same as -X)
</p>
</li>
<li>
<p>
bool <strong>output.log_ipv6_extra_data</strong> = false: log IPv6 source and destination addresses as unified2 extra data records
</p>
</li>
<li>
<p>
string <strong>output.event_trace.file</strong>: where to write event trace logs
</p>
</li>
<li>
<p>
int <strong>output.event_trace.max_data</strong> = 0: maximum amount of packet data to capture { 0:65535 }
</p>
</li>
<li>
<p>
bool <strong>output.quiet</strong> = false: suppress non-fatal information (still show alerts, same as -q)
</p>
</li>
<li>
<p>
string <strong>output.logdir</strong> = .: where to put log files (same as -l)
</p>
</li>
<li>
<p>
bool <strong>output.nolog</strong> = false: turn off logging (alerts still work, same as -N)
</p>
</li>
<li>
<p>
bool <strong>output.obfuscate</strong> = false: obfuscate the logged IP addresses (same as -O)
</p>
</li>
<li>
<p>
bool <strong>output.show_year</strong> = false: include year in timestamp in the alert and log files (same as -y)
</p>
</li>
<li>
<p>
int <strong>output.tagged_packet_limit</strong> = 256: maximum number of packets tagged for non-packet metrics { 0: }
</p>
</li>
<li>
<p>
bool <strong>output.verbose</strong> = false: be verbose (same as -v)
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_packets">packets</h3>
<div class="paragraph"><p>What: configure basic packet handling</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>packets.address_space_agnostic</strong> = false: determines whether DAQ address space info is used to track fragments and connections
</p>
</li>
<li>
<p>
string <strong>packets.bpf_file</strong>: file with BPF to select traffic for Snort
</p>
</li>
<li>
<p>
bool <strong>packets.enable_inline_init_failopen</strong> = true: whether to pass traffic during later stage of initialization to avoid drops
</p>
</li>
<li>
<p>
int <strong>packets.limit</strong> = 0: maximum number of packets to process before stopping (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
int <strong>packets.skip</strong> = 0: number of packets to skip before before processing { 0: }
</p>
</li>
<li>
<p>
bool <strong>packets.vlan_agnostic</strong> = false: determines whether VLAN info is used to track fragments and connections
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_ppm">ppm</h3>
<div class="paragraph"><p>What: packet and rule latency monitoring and control (requires --enable-ppm)</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>ppm.max_pkt_time</strong> = 0: enable packet latency thresholding (usec), 0 = off { 0: }
</p>
</li>
<li>
<p>
bool <strong>ppm.fastpath_expensive_packets</strong> = false: stop inspection if the max_pkt_time is exceeded
</p>
</li>
<li>
<p>
enum <strong>ppm.pkt_log</strong> = none: log event if max_pkt_time is exceeded { none | log | alert | both }
</p>
</li>
<li>
<p>
bool <strong>ppm.debug_pkts</strong> = false: enable packet debug
</p>
</li>
<li>
<p>
int <strong>ppm.max_rule_time</strong> = 0: enable rule latency thresholding (usec), 0 = off { 0: }
</p>
</li>
<li>
<p>
int <strong>ppm.threshold</strong> = 5: number of times to exceed limit before disabling rule { 1: }
</p>
</li>
<li>
<p>
bool <strong>ppm.suspend_expensive_rules</strong> = false: temporarily disable rule if threshold is reached
</p>
</li>
<li>
<p>
int <strong>ppm.suspend_timeout</strong> = 60: seconds to suspend rule, 0 = permanent { 0: }
</p>
</li>
<li>
<p>
enum <strong>ppm.rule_log</strong> = none: enable event logging for suspended rules { none|log|alert|both }
</p>
</li>
<li>
<p>
bool <strong>ppm.debug_rules</strong> = false: enable rule debug
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>134:1</strong> (ppm) rule options disabled by rule latency
</p>
</li>
<li>
<p>
<strong>134:2</strong> (ppm) rule options re-enabled by rule latency
</p>
</li>
<li>
<p>
<strong>134:3</strong> (ppm) packet aborted due to latency
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_process">process</h3>
<div class="paragraph"><p>What: configure basic process setup</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>process.chroot</strong>: set chroot directory (same as -t)
</p>
</li>
<li>
<p>
int <strong>process.threads[].cpu</strong> = 0: pin the associated source/thread to this cpu { 0:127 }
</p>
</li>
<li>
<p>
string <strong>process.threads[].source</strong>: set cpu affinity for this source (either pcap or &lt;iface&gt;
</p>
</li>
<li>
<p>
int <strong>process.threads[].thread</strong> = 0: set cpu affinity for the &lt;cur_thread_num&gt; thread that runs { 0: }
</p>
</li>
<li>
<p>
bool <strong>process.daemon</strong> = false: fork as a daemon (same as -D)
</p>
</li>
<li>
<p>
bool <strong>process.dirty_pig</strong> = false: shutdown without internal cleanup
</p>
</li>
<li>
<p>
string <strong>process.set_gid</strong>: set group ID (same as -g)
</p>
</li>
<li>
<p>
string <strong>process.set_uid</strong>: set user ID (same as -u)
</p>
</li>
<li>
<p>
string <strong>process.umask</strong>: set process umask (same as -m)
</p>
</li>
<li>
<p>
bool <strong>process.utc</strong> = false: use UTC instead of local time for timestamps
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_profile">profile</h3>
<div class="paragraph"><p>What: configure profiling of rules and/or modules (requires --enable-perf-profiling)</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>profile.rules.count</strong> = -1: print results to given level (-1 = all, 0 = off?) { -1: }
</p>
</li>
<li>
<p>
enum <strong>profile.rules.sort</strong> = avg_ticks: sort by given field { checks | avg_ticks | total_ticks | matches | no_matches | avg_ticks_per_match | avg_ticks_per_no_match }
</p>
</li>
<li>
<p>
int <strong>profile.modules.count</strong> = -1: print results to given level (-1 = all, 0 = off?) { -1: }
</p>
</li>
<li>
<p>
enum <strong>profile.modules.sort</strong> = avg_ticks: sort by given field { checks | avg_ticks | total_ticks }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_rate_filter">rate_filter</h3>
<div class="paragraph"><p>What: configure rate filters (which change rule actions)</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>rate_filter[].gid</strong> = 1: rule generator ID { 0: }
</p>
</li>
<li>
<p>
int <strong>rate_filter[].sid</strong> = 1: rule signature ID { 0: }
</p>
</li>
<li>
<p>
enum <strong>rate_filter[].track</strong> = by_src: filter only matching source or destination addresses { by_src | by_dst | by_rule }
</p>
</li>
<li>
<p>
int <strong>rate_filter[].count</strong> = 1: number of events in interval before tripping { 0: }
</p>
</li>
<li>
<p>
int <strong>rate_filter[].seconds</strong> = 1: count interval { 0: }
</p>
</li>
<li>
<p>
select <strong>rate_filter[].new_action</strong> = alert: take this action on future hits until timeout { alert | drop | log | pass | | reject | sdrop }
</p>
</li>
<li>
<p>
int <strong>rate_filter[].timeout</strong> = 1: count interval { 0: }
</p>
</li>
<li>
<p>
string <strong>rate_filter[].apply_to</strong>: restrict filter to these addresses according to track
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_references">references</h3>
<div class="paragraph"><p>What: define reference systems used in rules</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>references[].name</strong>: name used with reference rule option
</p>
</li>
<li>
<p>
string <strong>references[].url</strong>: where this reference is defined
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_rule_state">rule_state</h3>
<div class="paragraph"><p>What: enable/disable specific IPS rules</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>rule_state.gid</strong> = 0: rule generator ID { 0: }
</p>
</li>
<li>
<p>
int <strong>rule_state.sid</strong> = 0: rule signature ID { 0: }
</p>
</li>
<li>
<p>
bool <strong>rule_state.enable</strong> = true: enable or disable rule in all policies
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_search_engine">search_engine</h3>
<div class="paragraph"><p>What: configure fast pattern matcher</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>search_engine.bleedover_port_limit</strong> = 1024: maximum ports in rule before demotion to any-any port group { 1: }
</p>
</li>
<li>
<p>
bool <strong>search_engine.bleedover_warnings_enabled</strong> = false: print warning if a rule is demoted to any-any port group
</p>
</li>
<li>
<p>
bool <strong>search_engine.enable_single_rule_group</strong> = false: put all rules into one group
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug</strong> = false: print verbose fast pattern info
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_nocontent_rule_tests</strong> = false: print rule group info during packet evaluation
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_rule_group_build_details</strong> = false: print rule group info during compilation
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_rule_groups_uncompiled</strong> = false: prints uncompiled rule group information
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_rule_groups_compiled</strong> = false: prints compiled rule group information
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_fast_pattern</strong> = false: print fast pattern info for each rule
</p>
</li>
<li>
<p>
int <strong>search_engine.max_pattern_len</strong> = 0: truncate patterns when compiling into state machine (0 means no maximum) { 0: }
</p>
</li>
<li>
<p>
int <strong>search_engine.max_queue_events</strong> = 5: maximum number of matching fast pattern states to queue per packet
</p>
</li>
<li>
<p>
bool <strong>search_engine.no_stream_inserts</strong> = false: don&#8217;t inspect reassembled payload - good for performance, bad for detection
</p>
</li>
<li>
<p>
string <strong>search_engine.search_method</strong> = ac_bnfa_q: set fast pattern algorithm - choose available search engine
</p>
</li>
<li>
<p>
bool <strong>search_engine.split_any_any</strong> = false: evaluate any-any rules separately to save memory
</p>
</li>
<li>
<p>
bool <strong>search_engine.search_optimize</strong> = false: tweak state machine construction for better performance
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_snort">snort</h3>
<div class="paragraph"><p>What: command line configuration and shell commands</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>snort.-?</strong>: &lt;option prefix&gt; output matching command line option quick help (same as --help-options) { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.-A</strong>: &lt;mode&gt; set alert mode: none, cmg, or alert_*
</p>
</li>
<li>
<p>
implied <strong>snort.-B</strong>: &lt;mask&gt; obfuscated IP addresses in alerts and packet dumps using CIDR mask
</p>
</li>
<li>
<p>
implied <strong>snort.-C</strong>: print out payloads with character data only (no hex)
</p>
</li>
<li>
<p>
string <strong>snort.-c</strong>: &lt;conf&gt; use this configuration
</p>
</li>
<li>
<p>
implied <strong>snort.-D</strong>: run Snort in background (daemon) mode
</p>
</li>
<li>
<p>
implied <strong>snort.-d</strong>: dump the Application Layer
</p>
</li>
<li>
<p>
implied <strong>snort.-E</strong>: enable daemon restart
</p>
</li>
<li>
<p>
implied <strong>snort.-e</strong>: display the second layer header info
</p>
</li>
<li>
<p>
implied <strong>snort.-f</strong>: turn off fflush() calls after binary log writes
</p>
</li>
<li>
<p>
int <strong>snort.-G</strong>: &lt;0xid&gt; (same as --logid) { 0:65535 }
</p>
</li>
<li>
<p>
string <strong>snort.-g</strong>: &lt;gname&gt; run snort gid as &lt;gname&gt; group (or gid) after initialization
</p>
</li>
<li>
<p>
implied <strong>snort.-H</strong>: make hash tables deterministic
</p>
</li>
<li>
<p>
string <strong>snort.-i</strong>: &lt;iface&gt;&#8230; list of interfaces
</p>
</li>
<li>
<p>
port <strong>snort.-j</strong>: &lt;port&gt; to listen for telnet connections
</p>
</li>
<li>
<p>
select <strong>snort.-K</strong> = none: &lt;mode&gt; logging mode { none|text|pcap }
</p>
</li>
<li>
<p>
enum <strong>snort.-k</strong> = all: &lt;mode&gt; checksum mode (all,noip,notcp,noudp,noicmp,none) { all|noip|notcp|noudp|noicmp|none }
</p>
</li>
<li>
<p>
string <strong>snort.-l</strong>: &lt;logdir&gt; log to this directory instead of current directory
</p>
</li>
<li>
<p>
implied <strong>snort.-M</strong>: log messages to syslog (not alerts)
</p>
</li>
<li>
<p>
int <strong>snort.-m</strong>: &lt;umask&gt; set umask = &lt;umask&gt; { 0: }
</p>
</li>
<li>
<p>
implied <strong>snort.-N</strong>: ignored - for REG_TEST only
</p>
</li>
<li>
<p>
int <strong>snort.-n</strong>: &lt;count&gt; stop after count packets { 0: }
</p>
</li>
<li>
<p>
implied <strong>snort.-O</strong>: obfuscate the logged IP addresses
</p>
</li>
<li>
<p>
implied <strong>snort.-Q</strong>: enable inline mode operation
</p>
</li>
<li>
<p>
implied <strong>snort.-q</strong>: quiet mode - Don&#8217;t show banner and status report
</p>
</li>
<li>
<p>
string <strong>snort.-R</strong>: &lt;rules&gt; include this rules file in the default policy
</p>
</li>
<li>
<p>
string <strong>snort.-r</strong>: &lt;pcap&gt;&#8230; (same as --pcap-list)
</p>
</li>
<li>
<p>
string <strong>snort.-S</strong>: &lt;n=v&gt; set rules file variable n equal to value v
</p>
</li>
<li>
<p>
int <strong>snort.-s</strong>: &lt;snap&gt; (same as --snaplen) { 68:65535 }
</p>
</li>
<li>
<p>
implied <strong>snort.-T</strong>: test and report on the current Snort configuration
</p>
</li>
<li>
<p>
string <strong>snort.-t</strong>: &lt;dir&gt; chroots process to &lt;dir&gt; after initialization
</p>
</li>
<li>
<p>
implied <strong>snort.-U</strong>: use UTC for timestamps
</p>
</li>
<li>
<p>
string <strong>snort.-u</strong>: &lt;uname&gt; run snort as &lt;uname&gt; or &lt;uid&gt; after initialization
</p>
</li>
<li>
<p>
implied <strong>snort.-V</strong>: (same as --version)
</p>
</li>
<li>
<p>
implied <strong>snort.-v</strong>: be verbose
</p>
</li>
<li>
<p>
implied <strong>snort.-W</strong>: lists available interfaces
</p>
</li>
<li>
<p>
implied <strong>snort.-w</strong>: dump 802.11 management and control frames
</p>
</li>
<li>
<p>
implied <strong>snort.-X</strong>: dump the raw packet data starting at the link layer
</p>
</li>
<li>
<p>
implied <strong>snort.-x</strong>: same as --pedantic
</p>
</li>
<li>
<p>
implied <strong>snort.-y</strong>: include year in timestamp in the alert and log files
</p>
</li>
<li>
<p>
int <strong>snort.-z</strong>: &lt;count&gt; maximum number of packet threads (same as --max-packet-threads) { 1: }
</p>
</li>
<li>
<p>
implied <strong>snort.--alert-before-pass</strong>: process alert, drop, sdrop, or reject before pass; default is pass before alert, drop,&#8230;
</p>
</li>
<li>
<p>
string <strong>snort.--bpf</strong>: &lt;filter options&gt; are standard BPF options, as seen in TCPDump
</p>
</li>
<li>
<p>
string <strong>snort.--c2x</strong>: output hex for given char
</p>
</li>
<li>
<p>
implied <strong>snort.--create-pidfile</strong>: create PID file, even when not in Daemon mode
</p>
</li>
<li>
<p>
string <strong>snort.--daq</strong>: &lt;type&gt; select packet acquisition module (default is pcap)
</p>
</li>
<li>
<p>
string <strong>snort.--daq-dir</strong>: &lt;dir&gt; tell snort where to find desired DAQ
</p>
</li>
<li>
<p>
implied <strong>snort.--daq-list</strong>: list packet acquisition modules available in optional dir, default is static modules only
</p>
</li>
<li>
<p>
string <strong>snort.--daq-mode</strong>: &lt;mode&gt; select the DAQ operating mode
</p>
</li>
<li>
<p>
string <strong>snort.--daq-var</strong>: &lt;name=value&gt; specify extra DAQ configuration variable
</p>
</li>
<li>
<p>
implied <strong>snort.--dirty-pig</strong>: don&#8217;t flush packets on shutdown
</p>
</li>
<li>
<p>
implied <strong>snort.--dump-builtin-rules</strong>: [&lt;module prefix&gt;] output stub rules for selected modules
</p>
</li>
<li>
<p>
implied <strong>snort.--dump-dynamic-rules</strong>: output stub rules for all loaded rules libraries
</p>
</li>
<li>
<p>
string <strong>snort.--dump-defaults</strong>: [&lt;module prefix&gt;] output module defaults in Lua format { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--dump-version</strong>: output the version, the whole version, and only the version { (optional) }
</p>
</li>
<li>
<p>
implied <strong>snort.--enable-inline-test</strong>: enable Inline-Test Mode Operation
</p>
</li>
<li>
<p>
implied <strong>snort.--help</strong>: list command line options
</p>
</li>
<li>
<p>
string <strong>snort.--help-commands</strong>: [&lt;module prefix&gt;] output matching commands { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--help-config</strong>: [&lt;module prefix&gt;] output matching config options { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--help-counts</strong>: [&lt;module prefix&gt;] output matching peg counts { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--help-module</strong>: &lt;module&gt; output description of given module
</p>
</li>
<li>
<p>
implied <strong>snort.--help-modules</strong>: list all available modules with brief help
</p>
</li>
<li>
<p>
string <strong>snort.--help-options</strong>: &lt;option prefix&gt; output matching command line option quick help (same as -?) { (optional) }
</p>
</li>
<li>
<p>
implied <strong>snort.--help-plugins</strong>: list all available plugins with brief help
</p>
</li>
<li>
<p>
implied <strong>snort.--help-signals</strong>: dump available control signals
</p>
</li>
<li>
<p>
implied <strong>snort.--id-subdir</strong>: create/use instance subdirectories in logdir instead of instance filename prefix
</p>
</li>
<li>
<p>
implied <strong>snort.--id-zero</strong>: use id prefix / subdirectory even with one packet thread
</p>
</li>
<li>
<p>
implied <strong>snort.--list-buffers</strong>: output available inspection buffers
</p>
</li>
<li>
<p>
string <strong>snort.--list-builtin</strong>: &lt;module prefix&gt; output matching builtin rules { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--list-gids</strong>: [&lt;module prefix&gt;] output matching generators { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--list-modules</strong>: [&lt;module type&gt;] list all known modules of given type { (optional) }
</p>
</li>
<li>
<p>
implied <strong>snort.--list-plugins</strong>: list all known plugins
</p>
</li>
<li>
<p>
string <strong>snort.--lua</strong>: &lt;chunk&gt; extend/override conf with chunk; may be repeated
</p>
</li>
<li>
<p>
int <strong>snort.--logid</strong>: &lt;0xid&gt; log Identifier to uniquely id events for multiple snorts (same as -G) { 0:65535 }
</p>
</li>
<li>
<p>
implied <strong>snort.--markup</strong>: output help in asciidoc compatible format
</p>
</li>
<li>
<p>
int <strong>snort.--max-packet-threads</strong>: &lt;count&gt; configure maximum number of packet threads (same as -z) { 0: }
</p>
</li>
<li>
<p>
implied <strong>snort.--nostamps</strong>: don&#8217;t include timestamps in log file names
</p>
</li>
<li>
<p>
implied <strong>snort.--nolock-pidfile</strong>: do not try to lock Snort PID file
</p>
</li>
<li>
<p>
implied <strong>snort.--pause</strong>: wait for resume/quit command before processing packets/terminating
</p>
</li>
<li>
<p>
string <strong>snort.--pcap-file</strong>: &lt;file&gt; file that contains a list of pcaps to read - read mode is implied
</p>
</li>
<li>
<p>
string <strong>snort.--pcap-list</strong>: &lt;list&gt; a space separated list of pcaps to read - read mode is implied
</p>
</li>
<li>
<p>
string <strong>snort.--pcap-dir</strong>: &lt;dir&gt; a directory to recurse to look for pcaps - read mode is implied
</p>
</li>
<li>
<p>
string <strong>snort.--pcap-filter</strong>: &lt;filter&gt; filter to apply when getting pcaps from file or directory
</p>
</li>
<li>
<p>
int <strong>snort.--pcap-loop</strong>: &lt;count&gt; read all pcaps &lt;count&gt; times;  0 will read until Snort is terminated { -1: }
</p>
</li>
<li>
<p>
implied <strong>snort.--pcap-no-filter</strong>: reset to use no filter when getting pcaps from file or directory
</p>
</li>
<li>
<p>
implied <strong>snort.--pcap-reload</strong>: if reading multiple pcaps, reload snort config between pcaps
</p>
</li>
<li>
<p>
implied <strong>snort.--pcap-reset</strong>: ignored - for REG_TEST only
</p>
</li>
<li>
<p>
implied <strong>snort.--pcap-show</strong>: print a line saying what pcap is currently being read
</p>
</li>
<li>
<p>
implied <strong>snort.--pedantic</strong>: warnings are fatal
</p>
</li>
<li>
<p>
string <strong>snort.--plugin-path</strong>: &lt;path&gt; where to find plugins
</p>
</li>
<li>
<p>
implied <strong>snort.--process-all-events</strong>: process all action groups
</p>
</li>
<li>
<p>
string <strong>snort.--rule</strong>: &lt;rules&gt; to be added to configuration; may be repeated
</p>
</li>
<li>
<p>
implied <strong>snort.--rule-to-hex</strong>: output so rule header to stdout for text rule on stdin
</p>
</li>
<li>
<p>
implied <strong>snort.--rule-to-text</strong>: output plain so rule header to stdout for text rule on stdin
</p>
</li>
<li>
<p>
string <strong>snort.--run-prefix</strong>: &lt;pfx&gt; prepend this to each output file
</p>
</li>
<li>
<p>
string <strong>snort.--script-path</strong>: &lt;path&gt; where to find luajit scripts
</p>
</li>
<li>
<p>
implied <strong>snort.--shell</strong>: enable the interactive command line
</p>
</li>
<li>
<p>
implied <strong>snort.--show-plugins</strong>: list module and plugin versions
</p>
</li>
<li>
<p>
int <strong>snort.--skip</strong>: &lt;n&gt; skip 1st n packets { 0: }
</p>
</li>
<li>
<p>
int <strong>snort.--snaplen</strong>: &lt;snap&gt; set snaplen of packet (same as -s) { 68:65535 }
</p>
</li>
<li>
<p>
implied <strong>snort.--stdin-rules</strong>: read rules from stdin until EOF or a line starting with END is read
</p>
</li>
<li>
<p>
implied <strong>snort.--treat-drop-as-alert</strong>: converts drop, sdrop, and reject rules into alert rules during startup
</p>
</li>
<li>
<p>
implied <strong>snort.--treat-drop-as-ignore</strong>: use drop, sdrop, and reject rules to ignore session traffic when not inline
</p>
</li>
<li>
<p>
implied <strong>snort.--version</strong>: show version number (same as -V)
</p>
</li>
<li>
<p>
implied <strong>snort.--warn-all</strong>: enable all warnings
</p>
</li>
<li>
<p>
implied <strong>snort.--warn-flowbits</strong>: warn about flowbits that are checked but not set and vice-versa
</p>
</li>
<li>
<p>
implied <strong>snort.--warn-unknown</strong>: warn about unknown symbols in your config
</p>
</li>
<li>
<p>
int <strong>snort.--x2c</strong>: output ASCII char for given hex
</p>
</li>
</ul></div>
<div class="paragraph"><p>Commands:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>snort.show_plugins</strong>(): show available plugins
</p>
</li>
<li>
<p>
<strong>snort.dump_stats</strong>(): show summary statistics
</p>
</li>
<li>
<p>
<strong>snort.rotate_stats</strong>(): roll perfmonitor log files
</p>
</li>
<li>
<p>
<strong>snort.reload_config</strong>(): load new configuration
</p>
</li>
<li>
<p>
<strong>snort.pause</strong>(): suspend packet processing
</p>
</li>
<li>
<p>
<strong>snort.resume</strong>(): continue packet processing
</p>
</li>
<li>
<p>
<strong>snort.detach</strong>(): exit shell w/o shutdown
</p>
</li>
<li>
<p>
<strong>snort.quit</strong>(): shutdown and dump-stats
</p>
</li>
<li>
<p>
<strong>snort.help</strong>(): this output
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>snort.local commands</strong>: total local commands processed
</p>
</li>
<li>
<p>
<strong>snort.remote commands</strong>: total remote commands processed
</p>
</li>
<li>
<p>
<strong>snort.signals</strong>: total signals processed
</p>
</li>
<li>
<p>
<strong>snort.conf reloads</strong>: number of times configuration was reloaded
</p>
</li>
<li>
<p>
<strong>snort.attribute table reloads</strong>: number of times hosts table was reloaded
</p>
</li>
<li>
<p>
<strong>snort.attribute table hosts</strong>: total number of hosts in table
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_suppress">suppress</h3>
<div class="paragraph"><p>What: configure event suppressions</p></div>
<div class="paragraph"><p>Type: basic</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>suppress[].gid</strong> = 0: rule generator ID { 0: }
</p>
</li>
<li>
<p>
int <strong>suppress[].sid</strong> = 0: rule signature ID { 0: }
</p>
</li>
<li>
<p>
enum <strong>suppress[].track</strong>: suppress only matching source or destination addresses { by_src | by_dst }
</p>
</li>
<li>
<p>
string <strong>suppress[].ip</strong>: restrict suppression to these addresses according to track
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_codec_modules">Codec Modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>Codec is short for coder / decoder.  These modules are used for basic
protocol decoding, anomaly detection, and construction of active responses.</p></div>
<div class="sect2">
<h3 id="_arp">arp</h3>
<div class="paragraph"><p>What: support for address resolution protocol</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:109</strong> (arp) truncated ARP
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_auth">auth</h3>
<div class="paragraph"><p>What: support for IP authentication header</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:465</strong> (auth) truncated authentication header
</p>
</li>
<li>
<p>
<strong>116:466</strong> (auth) bad authentication header length
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_eapol">eapol</h3>
<div class="paragraph"><p>What: support for extensible authentication protocol over LAN</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:110</strong> (eapol) truncated EAP header
</p>
</li>
<li>
<p>
<strong>116:111</strong> (eapol) EAP key truncated
</p>
</li>
<li>
<p>
<strong>116:112</strong> (eapol) EAP header truncated
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_erspan2">erspan2</h3>
<div class="paragraph"><p>What: support for encapsulated remote switched port analyzer - type 2</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:462</strong> (erspan2) ERSpan header version mismatch
</p>
</li>
<li>
<p>
<strong>116:463</strong> (erspan2) captured &lt; ERSpan type2 header length
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_erspan3">erspan3</h3>
<div class="paragraph"><p>What: support for encapsulated remote switched port analyzer - type 3</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:464</strong> (erspan3) captured &lt; ERSpan type3 header length
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_esp">esp</h3>
<div class="paragraph"><p>What: support for encapsulating security payload</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>esp.decode_esp</strong> = false: enable for inspection of esp traffic that has authentication but not encryption
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:294</strong> (esp) truncated encapsulated security payload header
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_eth">eth</h3>
<div class="paragraph"><p>What: support for ethernet protocol (DLT 1) (DLT 51)</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:424</strong> (eth) truncated eth header
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_gre">gre</h3>
<div class="paragraph"><p>What: support for generic routing encapsulation</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:160</strong> (gre) GRE header length &gt; payload length
</p>
</li>
<li>
<p>
<strong>116:161</strong> (gre) multiple encapsulations in packet
</p>
</li>
<li>
<p>
<strong>116:162</strong> (gre) invalid GRE version
</p>
</li>
<li>
<p>
<strong>116:163</strong> (gre) invalid GRE header
</p>
</li>
<li>
<p>
<strong>116:164</strong> (gre) invalid GRE v.1 PPTP header
</p>
</li>
<li>
<p>
<strong>116:165</strong> (gre) GRE trans header length &gt; payload length
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_gtp">gtp</h3>
<div class="paragraph"><p>What: support for general-packet-radio-service tunnelling protocol</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:297</strong> (gtp) two or more GTP encapsulation layers present
</p>
</li>
<li>
<p>
<strong>116:298</strong> (gtp) GTP header length is invalid
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_icmp4">icmp4</h3>
<div class="paragraph"><p>What: support for Internet control message protocol v4</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:105</strong> (icmp4) ICMP header truncated
</p>
</li>
<li>
<p>
<strong>116:106</strong> (icmp4) ICMP timestamp header truncated
</p>
</li>
<li>
<p>
<strong>116:107</strong> (icmp4) ICMP address header truncated
</p>
</li>
<li>
<p>
<strong>116:250</strong> (icmp4) ICMP original IP header truncated
</p>
</li>
<li>
<p>
<strong>116:251</strong> (icmp4) ICMP version and original IP header versions differ
</p>
</li>
<li>
<p>
<strong>116:252</strong> (icmp4) ICMP original datagram length &lt; original IP header length
</p>
</li>
<li>
<p>
<strong>116:253</strong> (icmp4) ICMP original IP payload &lt; 64 bits
</p>
</li>
<li>
<p>
<strong>116:254</strong> (icmp4) ICMP original IP payload &gt; 576 bytes
</p>
</li>
<li>
<p>
<strong>116:255</strong> (icmp4) ICMP original IP fragmented and offset not 0
</p>
</li>
<li>
<p>
<strong>116:415</strong> (icmp4) ICMP4 packet to multicast dest address
</p>
</li>
<li>
<p>
<strong>116:416</strong> (icmp4) ICMP4 packet to broadcast dest address
</p>
</li>
<li>
<p>
<strong>116:418</strong> (icmp4) ICMP4 type other
</p>
</li>
<li>
<p>
<strong>116:434</strong> (icmp4) ICMP ping NMAP
</p>
</li>
<li>
<p>
<strong>116:435</strong> (icmp4) ICMP icmpenum v1.1.1
</p>
</li>
<li>
<p>
<strong>116:436</strong> (icmp4) ICMP redirect host
</p>
</li>
<li>
<p>
<strong>116:437</strong> (icmp4) ICMP redirect net
</p>
</li>
<li>
<p>
<strong>116:438</strong> (icmp4) ICMP traceroute ipopts
</p>
</li>
<li>
<p>
<strong>116:439</strong> (icmp4) ICMP source quench
</p>
</li>
<li>
<p>
<strong>116:440</strong> (icmp4) broadscan smurf scanner
</p>
</li>
<li>
<p>
<strong>116:441</strong> (icmp4) ICMP destination unreachable communication administratively prohibited
</p>
</li>
<li>
<p>
<strong>116:442</strong> (icmp4) ICMP destination unreachable communication with destination host is administratively prohibited
</p>
</li>
<li>
<p>
<strong>116:443</strong> (icmp4) ICMP destination unreachable communication with destination network is administratively prohibited
</p>
</li>
<li>
<p>
<strong>116:451</strong> (icmp4) ICMP path MTU denial of service attempt
</p>
</li>
<li>
<p>
<strong>116:452</strong> (icmp4) BAD-TRAFFIC Linux ICMP header DOS attempt
</p>
</li>
<li>
<p>
<strong>116:426</strong> (icmp4) truncated ICMP4 header
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>icmp4.bad checksum</strong>: non-zero icmp checksums
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_icmp6">icmp6</h3>
<div class="paragraph"><p>What: support for Internet control message protocol v6</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:427</strong> (icmp6) truncated ICMP6 header
</p>
</li>
<li>
<p>
<strong>116:431</strong> (icmp6) ICMP6 type not decoded
</p>
</li>
<li>
<p>
<strong>116:432</strong> (icmp6) ICMP6 packet to multicast address
</p>
</li>
<li>
<p>
<strong>116:285</strong> (icmp6) ICMPv6 packet of type 2 (message too big) with MTU field &lt; 1280
</p>
</li>
<li>
<p>
<strong>116:286</strong> (icmp6) ICMPv6 packet of type 1 (destination unreachable) with non-RFC 2463 code
</p>
</li>
<li>
<p>
<strong>116:287</strong> (icmp6) ICMPv6 router solicitation packet with a code not equal to 0
</p>
</li>
<li>
<p>
<strong>116:288</strong> (icmp6) ICMPv6 router advertisement packet with a code not equal to 0
</p>
</li>
<li>
<p>
<strong>116:289</strong> (icmp6) ICMPv6 router solicitation packet with the reserved field not equal to 0
</p>
</li>
<li>
<p>
<strong>116:290</strong> (icmp6) ICMPv6 router advertisement packet with the reachable time field set &gt; 1 hour
</p>
</li>
<li>
<p>
<strong>116:457</strong> (icmp6) ICMPv6 packet of type 1 (destination unreachable) with non-RFC 4443 code
</p>
</li>
<li>
<p>
<strong>116:460</strong> (icmp6) ICMPv6 node info query/response packet with a code greater than 2
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>icmp6.bad checksum (ip4)</strong>: nonzero ipcm4 checksums
</p>
</li>
<li>
<p>
<strong>icmp6.bad checksum (ip6)</strong>: nonzero ipcm6 checksums
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_igmp">igmp</h3>
<div class="paragraph"><p>What: support for Internet group management protocol</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:455</strong> (igmp) DOS IGMP IP options validation attempt
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_ipv4">ipv4</h3>
<div class="paragraph"><p>What: support for Internet protocol v4</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:1</strong> (ipv4) Not IPv4 datagram
</p>
</li>
<li>
<p>
<strong>116:2</strong> (ipv4) hlen &lt; minimum
</p>
</li>
<li>
<p>
<strong>116:3</strong> (ipv4) IP dgm len &lt; IP Hdr len
</p>
</li>
<li>
<p>
<strong>116:4</strong> (ipv4) Ipv4 Options found with bad lengths
</p>
</li>
<li>
<p>
<strong>116:5</strong> (ipv4) Truncated Ipv4 Options
</p>
</li>
<li>
<p>
<strong>116:6</strong> (ipv4) IP dgm len &gt; captured len
</p>
</li>
<li>
<p>
<strong>116:404</strong> (ipv4) IPV4 packet with zero TTL
</p>
</li>
<li>
<p>
<strong>116:405</strong> (ipv4) IPV4 packet with bad frag bits (both MF and DF set)
</p>
</li>
<li>
<p>
<strong>116:407</strong> (ipv4) IPV4 packet frag offset + length exceed maximum
</p>
</li>
<li>
<p>
<strong>116:408</strong> (ipv4) IPV4 packet from <em>current net</em> source address
</p>
</li>
<li>
<p>
<strong>116:409</strong> (ipv4) IPV4 packet to <em>current net</em> dest address
</p>
</li>
<li>
<p>
<strong>116:410</strong> (ipv4) IPV4 packet from multicast source address
</p>
</li>
<li>
<p>
<strong>116:411</strong> (ipv4) IPV4 packet from reserved source address
</p>
</li>
<li>
<p>
<strong>116:412</strong> (ipv4) IPV4 packet to reserved dest address
</p>
</li>
<li>
<p>
<strong>116:413</strong> (ipv4) IPV4 packet from broadcast source address
</p>
</li>
<li>
<p>
<strong>116:414</strong> (ipv4) IPV4 packet to broadcast dest address
</p>
</li>
<li>
<p>
<strong>116:428</strong> (ipv4) IPV4 packet below TTL limit
</p>
</li>
<li>
<p>
<strong>116:430</strong> (ipv4) IPV4 packet both DF and offset set
</p>
</li>
<li>
<p>
<strong>116:448</strong> (ipv4) BAD-TRAFFIC IP reserved bit set
</p>
</li>
<li>
<p>
<strong>116:449</strong> (ipv4) BAD-TRAFFIC unassigned/reserved IP protocol
</p>
</li>
<li>
<p>
<strong>116:444</strong> (ipv4) MISC IP option set
</p>
</li>
<li>
<p>
<strong>116:425</strong> (ipv4) truncated IP4 header
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>ipv4.bad checksum</strong>: nonzero ip checksums
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_ipv6">ipv6</h3>
<div class="paragraph"><p>What: support for Internet protocol v6</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:270</strong> (ipv6) IPv6 packet below TTL limit
</p>
</li>
<li>
<p>
<strong>116:271</strong> (ipv6) IPv6 header claims to not be IPv6
</p>
</li>
<li>
<p>
<strong>116:272</strong> (ipv6) IPV6 truncated extension header
</p>
</li>
<li>
<p>
<strong>116:273</strong> (ipv6) IPV6 truncated header
</p>
</li>
<li>
<p>
<strong>116:274</strong> (ipv6) IP dgm len &lt; IP Hdr len
</p>
</li>
<li>
<p>
<strong>116:275</strong> (ipv6) IP dgm len &gt; captured len
</p>
</li>
<li>
<p>
<strong>116:276</strong> (ipv6) IPv6 packet with destination address ::0
</p>
</li>
<li>
<p>
<strong>116:277</strong> (ipv6) IPv6 packet with multicast source address
</p>
</li>
<li>
<p>
<strong>116:278</strong> (ipv6) IPv6 packet with reserved multicast destination address
</p>
</li>
<li>
<p>
<strong>116:279</strong> (ipv6) IPv6 header includes an undefined option type
</p>
</li>
<li>
<p>
<strong>116:280</strong> (ipv6) IPv6 address includes an unassigned multicast scope value
</p>
</li>
<li>
<p>
<strong>116:281</strong> (ipv6) IPv6 header includes an invalid value for the <em>next header</em> field
</p>
</li>
<li>
<p>
<strong>116:282</strong> (ipv6) IPv6 header includes a routing extension header followed by a hop-by-hop header
</p>
</li>
<li>
<p>
<strong>116:283</strong> (ipv6) IPv6 header includes two routing extension headers
</p>
</li>
<li>
<p>
<strong>116:292</strong> (ipv6) IPv6 header has destination options followed by a routing header
</p>
</li>
<li>
<p>
<strong>116:291</strong> (ipv6) IPV6 tunneled over IPv4, IPv6 header truncated, possible Linux kernel attack
</p>
</li>
<li>
<p>
<strong>116:295</strong> (ipv6) IPv6 header includes an option which is too big for the containing header
</p>
</li>
<li>
<p>
<strong>116:296</strong> (ipv6) IPv6 packet includes out-of-order extension headers
</p>
</li>
<li>
<p>
<strong>116:429</strong> (ipv6) IPV6 packet has zero hop limit
</p>
</li>
<li>
<p>
<strong>116:453</strong> (ipv6) BAD-TRAFFIC ISATAP-addressed IPv6 traffic spoofing attempt
</p>
</li>
<li>
<p>
<strong>116:458</strong> (ipv6) bogus fragmentation packet, possible BSD attack
</p>
</li>
<li>
<p>
<strong>116:461</strong> (ipv6) IPV6 routing type 0 extension header
</p>
</li>
<li>
<p>
<strong>116:456</strong> (ipv6) too many IP6 extension headers
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_mpls">mpls</h3>
<div class="paragraph"><p>What: support for multiprotocol label switching</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>mpls.enable_mpls_multicast</strong> = false: enables support for MPLS multicast
</p>
</li>
<li>
<p>
bool <strong>mpls.enable_mpls_overlapping_ip</strong> = false: enable if private network addresses overlap and must be differentiated by MPLS label(s)
</p>
</li>
<li>
<p>
int <strong>mpls.max_mpls_stack_depth</strong> = -1: set MPLS stack depth { -1: }
</p>
</li>
<li>
<p>
enum <strong>mpls.mpls_payload_type</strong> = ip4: set encapsulated payload type { eth | ip4 | ip6 }
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:170</strong> (mpls) bad MPLS frame
</p>
</li>
<li>
<p>
<strong>116:171</strong> (mpls) MPLS label 0 appears in non-bottom header
</p>
</li>
<li>
<p>
<strong>116:172</strong> (mpls) MPLS label 1 appears in bottom header
</p>
</li>
<li>
<p>
<strong>116:173</strong> (mpls) MPLS label 2 appears in non-bottom header
</p>
</li>
<li>
<p>
<strong>116:174</strong> (mpls) MPLS label 3 appears in header
</p>
</li>
<li>
<p>
<strong>116:175</strong> (mpls) MPLS label 4, 5,.. or 15 appears in header
</p>
</li>
<li>
<p>
<strong>116:176</strong> (mpls) too many MPLS headers
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_pgm">pgm</h3>
<div class="paragraph"><p>What: support for pragmatic general multicast</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:454</strong> (pgm) BAD-TRAFFIC PGM nak list overflow attempt
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_pppoe">pppoe</h3>
<div class="paragraph"><p>What: support for point-to-point protocol over ethernet</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:120</strong> (pppoe) bad PPPOE frame detected
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_tcp">tcp</h3>
<div class="paragraph"><p>What: support for transmission control protocol</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:45</strong> (tcp) TCP packet len is smaller than 20 bytes
</p>
</li>
<li>
<p>
<strong>116:46</strong> (tcp) TCP data offset is less than 5
</p>
</li>
<li>
<p>
<strong>116:47</strong> (tcp) TCP header length exceeds packet length
</p>
</li>
<li>
<p>
<strong>116:54</strong> (tcp) TCP options found with bad lengths
</p>
</li>
<li>
<p>
<strong>116:55</strong> (tcp) truncated TCP options
</p>
</li>
<li>
<p>
<strong>116:56</strong> (tcp) T/TCP detected
</p>
</li>
<li>
<p>
<strong>116:57</strong> (tcp) obsolete TCP options found
</p>
</li>
<li>
<p>
<strong>116:58</strong> (tcp) experimental TCP options found
</p>
</li>
<li>
<p>
<strong>116:59</strong> (tcp) TCP window scale option found with length &gt; 14
</p>
</li>
<li>
<p>
<strong>116:400</strong> (tcp) XMAS attack detected
</p>
</li>
<li>
<p>
<strong>116:401</strong> (tcp) Nmap XMAS attack detected
</p>
</li>
<li>
<p>
<strong>116:419</strong> (tcp) TCP urgent pointer exceeds payload length or no payload
</p>
</li>
<li>
<p>
<strong>116:420</strong> (tcp) TCP SYN with FIN
</p>
</li>
<li>
<p>
<strong>116:421</strong> (tcp) TCP SYN with RST
</p>
</li>
<li>
<p>
<strong>116:422</strong> (tcp) TCP PDU missing ack for established session
</p>
</li>
<li>
<p>
<strong>116:423</strong> (tcp) TCP has no SYN, ACK, or RST
</p>
</li>
<li>
<p>
<strong>116:433</strong> (tcp) DDOS shaft SYN flood
</p>
</li>
<li>
<p>
<strong>116:446</strong> (tcp) BAD-TRAFFIC TCP port 0 traffic
</p>
</li>
<li>
<p>
<strong>116:402</strong> (tcp) DOS NAPTHA vulnerability detected
</p>
</li>
<li>
<p>
<strong>116:403</strong> (tcp) bad traffic SYN to multicast address
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>tcp.bad checksum (ip4)</strong>: nonzero tcp over ip checksums
</p>
</li>
<li>
<p>
<strong>tcp.bad checksum (ip6)</strong>: nonzero tcp over ipv6 checksums
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_udp">udp</h3>
<div class="paragraph"><p>What: support for user datagram protocol</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>udp.deep_teredo_inspection</strong> = false: look for Teredo on all UDP ports (default is only 3544)
</p>
</li>
<li>
<p>
bool <strong>udp.enable_gtp</strong> = false: decode GTP encapsulations
</p>
</li>
<li>
<p>
bit_list <strong>udp.gtp_ports</strong> = 2152 3386: set GTP ports { 65535 }
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:95</strong> (udp) truncated UDP header
</p>
</li>
<li>
<p>
<strong>116:96</strong> (udp) invalid UDP header, length field &lt; 8
</p>
</li>
<li>
<p>
<strong>116:97</strong> (udp) short UDP packet, length field &gt; payload length
</p>
</li>
<li>
<p>
<strong>116:98</strong> (udp) long UDP packet, length field &lt; payload length
</p>
</li>
<li>
<p>
<strong>116:406</strong> (udp) invalid IPv6 UDP packet, checksum zero
</p>
</li>
<li>
<p>
<strong>116:445</strong> (udp) misc large UDP Packet
</p>
</li>
<li>
<p>
<strong>116:447</strong> (udp) BAD-TRAFFIC UDP port 0 traffic
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>udp.bad checksum (ip4)</strong>: nonzero udp over ipv4 checksums
</p>
</li>
<li>
<p>
<strong>udp.bad checksum (ip6)</strong>: nonzero udp over ipv6 checksums
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_vlan">vlan</h3>
<div class="paragraph"><p>What: support for local area network</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:130</strong> (vlan) bad VLAN frame
</p>
</li>
<li>
<p>
<strong>116:131</strong> (vlan) bad LLC header
</p>
</li>
<li>
<p>
<strong>116:132</strong> (vlan) bad extra LLC info
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_wlan">wlan</h3>
<div class="paragraph"><p>What: support for wireless local area network protocol (DLT 105)</p></div>
<div class="paragraph"><p>Type: codec</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>116:133</strong> (wlan) bad 802.11 LLC header
</p>
</li>
<li>
<p>
<strong>116:134</strong> (wlan) bad 802.11 extra LLC info
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_data_modules">Data Modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>Data modules are adjunct configurations for use with certain inspectors.</p></div>
<div class="sect2">
<h3 id="_ftp_client">ftp_client</h3>
<div class="paragraph"><p>What: FTP client configuration module for use with ftp_server</p></div>
<div class="paragraph"><p>Type: data</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>ftp_client.bounce</strong> = false: check for bounces
</p>
</li>
<li>
<p>
addr <strong>ftp_client.bounce_to[].address</strong> = 1.0.0.0/32: allowed ip address in CIDR format
</p>
</li>
<li>
<p>
port <strong>ftp_client.bounce_to[].port</strong> = 20: allowed port { 1: }
</p>
</li>
<li>
<p>
port <strong>ftp_client.bounce_to[].last_port</strong>: optional allowed range from port to last_port inclusive { 0: }
</p>
</li>
<li>
<p>
bool <strong>ftp_client.ignore_telnet_erase_cmds</strong> = false: ignore erase character and erase line commands when normalizing
</p>
</li>
<li>
<p>
int <strong>ftp_client.max_resp_len</strong> = -1: maximum ftp response accepted by client { -1: }
</p>
</li>
<li>
<p>
bool <strong>ftp_client.telnet_cmds</strong> = false: detect telnet escape sequences on ftp control channel
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_http_global">http_global</h3>
<div class="paragraph"><p>What: http inspector global configuration and client rules for use with http_server</p></div>
<div class="paragraph"><p>Type: data</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>http_global.compress_depth</strong> = 65535: maximum amount of packet payload to decompress { 1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.b64_decode_depth</strong> = 0: single packet decode depth { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.bitenc_decode_depth</strong> = 0: single packet decode depth { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.max_mime_mem</strong> = 838860: single packet decode depth { 3276: }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.qp_decode_depth</strong> = 0: single packet decode depth { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.uu_decode_depth</strong> = 0: single packet decode depth { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decompress_depth</strong> = 65535: maximum amount of decompressed data to process { 1:65535 }
</p>
</li>
<li>
<p>
bool <strong>http_global.detect_anomalous_servers</strong> = false: inspect non-configured ports for HTTP - bad idea
</p>
</li>
<li>
<p>
int <strong>http_global.max_gzip_mem</strong> = 838860: total memory used for decompression across all active sessions { 3276: }
</p>
</li>
<li>
<p>
int <strong>http_global.memcap</strong> = 150994944: limit of memory used for logging extra data { 2304: }
</p>
</li>
<li>
<p>
bool <strong>http_global.proxy_alert</strong> = false: alert on proxy usage for servers without allow_proxy_use
</p>
</li>
<li>
<p>
int <strong>http_global.unicode_map.code_page</strong> = 1252: select code page in map file { 0: }
</p>
</li>
<li>
<p>
string <strong>http_global.unicode_map.map_file</strong>: unicode map file
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>119:1</strong> (http_global) ascii encoding
</p>
</li>
<li>
<p>
<strong>119:2</strong> (http_global) double decoding attack
</p>
</li>
<li>
<p>
<strong>119:3</strong> (http_global) u encoding
</p>
</li>
<li>
<p>
<strong>119:4</strong> (http_global) bare byte unicode encoding
</p>
</li>
<li>
<p>
<strong>119:5</strong> (http_global) base36 encoding
</p>
</li>
<li>
<p>
<strong>119:6</strong> (http_global) UTF-8 encoding
</p>
</li>
<li>
<p>
<strong>119:7</strong> (http_global) IIS unicode codepoint encoding
</p>
</li>
<li>
<p>
<strong>119:8</strong> (http_global) multi_slash encoding
</p>
</li>
<li>
<p>
<strong>119:9</strong> (http_global) IIS backslash evasion
</p>
</li>
<li>
<p>
<strong>119:10</strong> (http_global) self directory traversal
</p>
</li>
<li>
<p>
<strong>119:11</strong> (http_global) directory traversal
</p>
</li>
<li>
<p>
<strong>119:12</strong> (http_global) apache whitespace (tab)
</p>
</li>
<li>
<p>
<strong>119:13</strong> (http_global) non-RFC http delimiter
</p>
</li>
<li>
<p>
<strong>119:14</strong> (http_global) non-RFC defined char
</p>
</li>
<li>
<p>
<strong>119:15</strong> (http_global) oversize request-URI directory
</p>
</li>
<li>
<p>
<strong>119:16</strong> (http_global) oversize chunk encoding
</p>
</li>
<li>
<p>
<strong>119:17</strong> (http_global) unauthorized proxy use detected
</p>
</li>
<li>
<p>
<strong>119:18</strong> (http_global) webroot directory traversal
</p>
</li>
<li>
<p>
<strong>119:19</strong> (http_global) long header
</p>
</li>
<li>
<p>
<strong>119:20</strong> (http_global) max header fields
</p>
</li>
<li>
<p>
<strong>119:21</strong> (http_global) multiple content length
</p>
</li>
<li>
<p>
<strong>119:22</strong> (http_global) chunk size mismatch detected
</p>
</li>
<li>
<p>
<strong>119:23</strong> (http_global) invalid ip in true-client-IP/XFF header
</p>
</li>
<li>
<p>
<strong>119:24</strong> (http_global) multiple host hdrs detected
</p>
</li>
<li>
<p>
<strong>119:25</strong> (http_global) hostname exceeds 255 characters
</p>
</li>
<li>
<p>
<strong>119:26</strong> (http_global) header parsing space saturation
</p>
</li>
<li>
<p>
<strong>119:27</strong> (http_global) client consecutive small chunk sizes
</p>
</li>
<li>
<p>
<strong>119:28</strong> (http_global) post w/o content-length or chunks
</p>
</li>
<li>
<p>
<strong>119:29</strong> (http_global) multiple true IPs in a session
</p>
</li>
<li>
<p>
<strong>119:30</strong> (http_global) both true-client-IP and XFF hdrs present
</p>
</li>
<li>
<p>
<strong>119:31</strong> (http_global) unknown method
</p>
</li>
<li>
<p>
<strong>119:32</strong> (http_global) simple request
</p>
</li>
<li>
<p>
<strong>119:33</strong> (http_global) unescaped space in http URI
</p>
</li>
<li>
<p>
<strong>119:34</strong> (http_global) too many pipelined requests
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>http_global.packets</strong>: total packets processed
</p>
</li>
<li>
<p>
<strong>http_global.gets</strong>: GET requests
</p>
</li>
<li>
<p>
<strong>http_global.posts</strong>: POST requests
</p>
</li>
<li>
<p>
<strong>http_global.request headers</strong>: total requests
</p>
</li>
<li>
<p>
<strong>http_global.response headers</strong>: total responses
</p>
</li>
<li>
<p>
<strong>http_global.request cookies</strong>: requests with Cookie
</p>
</li>
<li>
<p>
<strong>http_global.response cookies</strong>: responses with Set-Cookie
</p>
</li>
<li>
<p>
<strong>http_global.post params</strong>: POST parameters extracted
</p>
</li>
<li>
<p>
<strong>http_global.unicode</strong>: unicode normalizations
</p>
</li>
<li>
<p>
<strong>http_global.double unicode</strong>: double unicode normalizations
</p>
</li>
<li>
<p>
<strong>http_global.non-ascii</strong>: non-ascii normalizations
</p>
</li>
<li>
<p>
<strong>http_global.paths with ../</strong>: directory traversal normalizations
</p>
</li>
<li>
<p>
<strong>http_global.paths with //</strong>: double slash normalizations
</p>
</li>
<li>
<p>
<strong>http_global.paths with ./</strong>: relative directory normalizations
</p>
</li>
<li>
<p>
<strong>http_global.gzip packets</strong>: packets with gzip compression
</p>
</li>
<li>
<p>
<strong>http_global.compressed bytes</strong>: total comparessed bytes processed
</p>
</li>
<li>
<p>
<strong>http_global.decompressed bytes</strong>: total bytes decompressed
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_port_scan_global">port_scan_global</h3>
<div class="paragraph"><p>What: shared settings for port_scan inspectors for use with port_scan</p></div>
<div class="paragraph"><p>Type: data</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>port_scan_global.memcap</strong> = 1048576: maximum tracker memory { 1: }
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>port_scan_global.packets</strong>: total packets
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_inspector_modules">Inspector Modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>These modules perform a variety of functions, including analysis of
protocols beyond basic decoding.</p></div>
<div class="sect2">
<h3 id="_arp_spoof">arp_spoof</h3>
<div class="paragraph"><p>What: detect ARP attacks and anomalies</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
ip4 <strong>arp_spoof.hosts[].ip</strong>: host ip address
</p>
</li>
<li>
<p>
mac <strong>arp_spoof.hosts[].mac</strong>: host mac address
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>112:1</strong> (arp_spoof) unicast ARP request
</p>
</li>
<li>
<p>
<strong>112:2</strong> (arp_spoof) ethernet/ARP mismatch request for source
</p>
</li>
<li>
<p>
<strong>112:3</strong> (arp_spoof) ethernet/ARP mismatch request for destination
</p>
</li>
<li>
<p>
<strong>112:4</strong> (arp_spoof) attempted ARP cache overwrite attack
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>arp_spoof.packets</strong>: total packets
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_back_orifice">back_orifice</h3>
<div class="paragraph"><p>What: back orifice detection</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>105:1</strong> (back_orifice) BO traffic detected
</p>
</li>
<li>
<p>
<strong>105:2</strong> (back_orifice) BO client traffic detected
</p>
</li>
<li>
<p>
<strong>105:3</strong> (back_orifice) BO server traffic detected
</p>
</li>
<li>
<p>
<strong>105:4</strong> (back_orifice) BO Snort buffer attack
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>back_orifice.packets</strong>: total packets
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_binder_2">binder</h3>
<div class="paragraph"><p>What: configure processing based on CIDRs, ports, services, etc.</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>binder[].when.policy_id</strong>: unique ID for selection of this config by external logic { 0: }
</p>
</li>
<li>
<p>
bit_list <strong>binder[].when.ifaces</strong>: list of interface indices { 255 }
</p>
</li>
<li>
<p>
bit_list <strong>binder[].when.vlans</strong>: list of VLAN IDs { 4095 }
</p>
</li>
<li>
<p>
addr_list <strong>binder[].when.nets</strong>: list of networks
</p>
</li>
<li>
<p>
enum <strong>binder[].when.proto</strong>: protocol { any | ip | icmp | tcp | udp }
</p>
</li>
<li>
<p>
bit_list <strong>binder[].when.ports</strong>: list of ports { 65535 }
</p>
</li>
<li>
<p>
enum <strong>binder[].when.role</strong> = any: use the given configuration on one or any end of a session { client | server | any }
</p>
</li>
<li>
<p>
string <strong>binder[].when.service</strong>: override default configuration
</p>
</li>
<li>
<p>
enum <strong>binder[].use.action</strong> = inspect: what to do with matching traffic { block | allow | inspect }
</p>
</li>
<li>
<p>
string <strong>binder[].use.file</strong>: use configuration in given file
</p>
</li>
<li>
<p>
string <strong>binder[].use.service</strong>: override automatic service identification
</p>
</li>
<li>
<p>
string <strong>binder[].use.type</strong>: select module for binding
</p>
</li>
<li>
<p>
string <strong>binder[].use.name</strong> = defaults to type: symbol name
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>binder.packets</strong>: initial bindings
</p>
</li>
<li>
<p>
<strong>binder.blocks</strong>: block bindings
</p>
</li>
<li>
<p>
<strong>binder.allows</strong>: allow bindings
</p>
</li>
<li>
<p>
<strong>binder.inspects</strong>: inspect bindings
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_ftp_data">ftp_data</h3>
<div class="paragraph"><p>What: FTP data channel handler</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>ftp_data.packets</strong>: total packets
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_ftp_server">ftp_server</h3>
<div class="paragraph"><p>What: main FTP module; ftp_client should also be configured</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>ftp_server.chk_str_fmt</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.data_chan_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.data_xfer_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.directory_cmds[].dir_cmd</strong>: directory command
</p>
</li>
<li>
<p>
int <strong>ftp_server.directory_cmds[].rsp_code</strong> = 200: expected successful response code for command { 200: }
</p>
</li>
<li>
<p>
string <strong>ftp_server.file_put_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.file_get_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.encr_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.login_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
bool <strong>ftp_server.check_encrypted</strong> = false: check for end of encryption
</p>
</li>
<li>
<p>
string <strong>ftp_server.cmd_validity[].command</strong>: command string
</p>
</li>
<li>
<p>
string <strong>ftp_server.cmd_validity[].format</strong>: format specification
</p>
</li>
<li>
<p>
int <strong>ftp_server.cmd_validity[].length</strong> = 0: specify non-default maximum for command { 0: }
</p>
</li>
<li>
<p>
int <strong>ftp_server.def_max_param_len</strong> = 100: default maximum length of commands handled by server; 0 is unlimited { 1: }
</p>
</li>
<li>
<p>
bool <strong>ftp_server.encrypted_traffic</strong> = false: check for encrypted telnet and ftp
</p>
</li>
<li>
<p>
string <strong>ftp_server.ftp_cmds</strong>: specify additional commands supported by server beyond RFC 959
</p>
</li>
<li>
<p>
bool <strong>ftp_server.ignore_data_chan</strong> = false: do not inspect ftp data channels
</p>
</li>
<li>
<p>
bool <strong>ftp_server.ignore_telnet_erase_cmds</strong> = false: ignore erase character and erase line commands when normalizing
</p>
</li>
<li>
<p>
bool <strong>ftp_server.print_cmds</strong> = false: print command configurations on start up
</p>
</li>
<li>
<p>
bool <strong>ftp_server.telnet_cmds</strong> = false: detect telnet escape sequences of ftp control channel
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>125:1</strong> (ftp_server) TELNET cmd on FTP command channel
</p>
</li>
<li>
<p>
<strong>125:2</strong> (ftp_server) invalid FTP command
</p>
</li>
<li>
<p>
<strong>125:3</strong> (ftp_server) FTP command parameters were too long
</p>
</li>
<li>
<p>
<strong>125:4</strong> (ftp_server) FTP command parameters were malformed
</p>
</li>
<li>
<p>
<strong>125:5</strong> (ftp_server) FTP command parameters contained potential string format
</p>
</li>
<li>
<p>
<strong>125:6</strong> (ftp_server) FTP response message was too long
</p>
</li>
<li>
<p>
<strong>125:7</strong> (ftp_server) FTP traffic encrypted
</p>
</li>
<li>
<p>
<strong>125:8</strong> (ftp_server) FTP bounce attempt
</p>
</li>
<li>
<p>
<strong>125:9</strong> (ftp_server) evasive (incomplete) TELNET cmd on FTP command channel
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>ftp_server.packets</strong>: total packets
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_http_inspect">http_inspect</h3>
<div class="paragraph"><p>What: http inspection and server rules; also configure http_inspect</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>http_inspect.allow_proxy_use</strong> = false: don&#8217;t alert on proxy use for this server
</p>
</li>
<li>
<p>
bool <strong>http_inspect.apache_whitespace</strong> = false: don&#8217;t alert if tab is used in lieu of space characters
</p>
</li>
<li>
<p>
bool <strong>http_inspect.ascii</strong> = false: enable decoding ASCII like %2f to /
</p>
</li>
<li>
<p>
bool <strong>http_inspect.bare_byte</strong> = false: decode non-standard, non-ASCII character encodings
</p>
</li>
<li>
<p>
int <strong>http_inspect.chunk_length</strong> = 500000: alert on chunk lengths greater than specified { 1: }
</p>
</li>
<li>
<p>
int <strong>http_inspect.client_flow_depth</strong> = 0: raw request payload to inspect { -1:1460 }
</p>
</li>
<li>
<p>
bool <strong>http_inspect.directory</strong> = false: normalize . and .. sequences out of URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.double_decode</strong> = false: iis specific extra decoding
</p>
</li>
<li>
<p>
bool <strong>http_inspect.enable_cookies</strong> = true: extract cookies
</p>
</li>
<li>
<p>
bool <strong>http_inspect.enable_xff</strong> = false: log True-Client-IP and X-Forwarded-For headers with unified2 alerts as extra data
</p>
</li>
<li>
<p>
bool <strong>http_inspect.extended_ascii_uri</strong> = false: allow extended ASCII codes in the request URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.extended_response_inspection</strong> = true: extract response headers
</p>
</li>
<li>
<p>
string <strong>http_inspect.http_methods</strong> = GET POST PUT SEARCH MKCOL COPY MOVE LOCK UNLOCK NOTIFY POLL BCOPY BDELETE BMOVE LINK UNLINK OPTIONS HEAD DELETE TRACE TRACK CONNECT SOURCE SUBSCRIBE UNSUBSCRIBE PROPFIND PROPPATCH BPROPFIND BPROPPATCH RPC_CONNECT PROXY_SUCCESS BITS_POST CCM_POST SMS_POST RPC_IN_DATA RPC_OUT_DATA RPC_ECHO_DATA: request methods allowed in addition to GET and POST
</p>
</li>
<li>
<p>
bool <strong>http_inspect.iis_backslash</strong> = false: normalize directory slashes
</p>
</li>
<li>
<p>
bool <strong>http_inspect.iis_delimiter</strong> = false: allow use of non-standard delimiter
</p>
</li>
<li>
<p>
bool <strong>http_inspect.iis_unicode</strong> = false: enable unicode code point mapping using unicode_map settings
</p>
</li>
<li>
<p>
int <strong>http_inspect.iis_unicode_map.code_page</strong> = 1252: select code page in map file { 0: }
</p>
</li>
<li>
<p>
string <strong>http_inspect.iis_unicode_map.map_file</strong>: unicode map file
</p>
</li>
<li>
<p>
bool <strong>http_inspect.inspect_gzip</strong> = true: enable gzip decompression of compressed bodies
</p>
</li>
<li>
<p>
bool <strong>http_inspect.inspect_uri_only</strong> = false: disable all detection except for uricontent
</p>
</li>
<li>
<p>
bool <strong>http_inspect.log_hostname</strong> = false: enable logging of Hostname with unified2 alerts as extra data
</p>
</li>
<li>
<p>
bool <strong>http_inspect.log_uri</strong> = false: enable logging of URI with unified2 alerts as extra data
</p>
</li>
<li>
<p>
int <strong>http_inspect.max_header_length</strong> = 750: maximum allowed client request header field { 0:65535 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.max_headers</strong> = 100: maximum allowed client request headers { 0:1024 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.max_spaces</strong> = 200: maximum allowed whitespaces when folding { 0:65535 }
</p>
</li>
<li>
<p>
bool <strong>http_inspect.multi_slash</strong> = false: normalize out consecutive slashes in URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.no_pipeline_req</strong> = false: don&#8217;t inspect pipelined requests after first (still does general detection)
</p>
</li>
<li>
<p>
bit_list <strong>http_inspect.non_rfc_chars</strong> = 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07: alert on given non-RFC chars being present in the URI { 255 }
</p>
</li>
<li>
<p>
bool <strong>http_inspect.non_strict</strong> = true: allows HTTP 0.9 processing
</p>
</li>
<li>
<p>
bool <strong>http_inspect.normalize_cookies</strong> = false: normalize cookies similar to URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.normalize_headers</strong> = false: normalize headers other than cookie similar to URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.normalize_javascript</strong> = true: normalize javascript between &lt;script&gt; tags
</p>
</li>
<li>
<p>
int <strong>http_inspect.max_javascript_whitespaces</strong> = 200: maximum number of consecutive whitespaces { 0: }
</p>
</li>
<li>
<p>
bool <strong>http_inspect.normalize_utf</strong> = true: normalize response bodies with UTF content-types
</p>
</li>
<li>
<p>
int <strong>http_inspect.oversize_dir_length</strong> = 500: alert if a URL has a directory longer than this limit { 0: }
</p>
</li>
<li>
<p>
int <strong>http_inspect.post_depth</strong> = 65495: amount of POST data to inspect { -1:65535 }
</p>
</li>
<li>
<p>
enum <strong>http_inspect.profile</strong> = none: set defaults appropriate for selected server { none | all | apache | iis | iis_40 | iis_50 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.server_flow_depth</strong> = 0: response payload to inspect; includes headers with extended_response_inspection { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.small_chunk_count</strong> = 5: alert if more than this limit of consecutive chunks are below small_chunk_length { 0:255 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.small_chunk_length</strong> = 10: alert if more than small_chunk_count consecutive chunks below this limit { 0:255 }
</p>
</li>
<li>
<p>
bool <strong>http_inspect.tab_uri_delimiter</strong> = false: whether a tab not preceded by a space is considered a delimiter or part of URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.u_encode</strong> = true: decode %uXXXX character sequences
</p>
</li>
<li>
<p>
bool <strong>http_inspect.unlimited_decompress</strong> = true: decompress across multiple packets
</p>
</li>
<li>
<p>
bool <strong>http_inspect.utf_8</strong> = false: decode UTF-8 unicode sequences in URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.webroot</strong> = false: alert on directory traversals past the top level (web server root)
</p>
</li>
<li>
<p>
bit_list <strong>http_inspect.whitespace_chars</strong>: allowed white space characters { 255 }
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>120:1</strong> (http_inspect) anomalous http server on undefined HTTP port
</p>
</li>
<li>
<p>
<strong>120:2</strong> (http_inspect) invalid status code in HTTP response
</p>
</li>
<li>
<p>
<strong>120:3</strong> (http_inspect) no content-length or transfer-encoding in HTTP response
</p>
</li>
<li>
<p>
<strong>120:4</strong> (http_inspect) HTTP response has UTF charset which failed to normalize
</p>
</li>
<li>
<p>
<strong>120:5</strong> (http_inspect) HTTP response has UTF-7 charset
</p>
</li>
<li>
<p>
<strong>120:6</strong> (http_inspect) HTTP response gzip decompression failed
</p>
</li>
<li>
<p>
<strong>120:7</strong> (http_inspect) server consecutive small chunk sizes
</p>
</li>
<li>
<p>
<strong>120:8</strong> (http_inspect) invalid content-length or chunk size
</p>
</li>
<li>
<p>
<strong>120:9</strong> (http_inspect) javascript obfuscation levels exceeds 1
</p>
</li>
<li>
<p>
<strong>120:10</strong> (http_inspect) javascript whitespaces exceeds max allowed
</p>
</li>
<li>
<p>
<strong>120:11</strong> (http_inspect) multiple encodings within javascript obfuscated data
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_new_http_inspect">new_http_inspect</h3>
<div class="paragraph"><p>What: new HTTP inspector</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>new_http_inspect.test_input</strong> = false: read HTTP messages from text file
</p>
</li>
<li>
<p>
bool <strong>new_http_inspect.test_output</strong> = false: print out HTTP section data
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>219:1</strong> (new_http_inspect) ascii encoding
</p>
</li>
<li>
<p>
<strong>219:2</strong> (new_http_inspect) double decoding attack
</p>
</li>
<li>
<p>
<strong>219:3</strong> (new_http_inspect) u encoding
</p>
</li>
<li>
<p>
<strong>219:4</strong> (new_http_inspect) bare byte unicode encoding
</p>
</li>
<li>
<p>
<strong>219:5</strong> (new_http_inspect) obsolete event&#8212;should not appear
</p>
</li>
<li>
<p>
<strong>219:6</strong> (new_http_inspect) UTF-8 encoding
</p>
</li>
<li>
<p>
<strong>219:7</strong> (new_http_inspect) IIS unicode codepoint encoding
</p>
</li>
<li>
<p>
<strong>219:8</strong> (new_http_inspect) multi_slash encoding
</p>
</li>
<li>
<p>
<strong>219:9</strong> (new_http_inspect) IIS backslash evasion
</p>
</li>
<li>
<p>
<strong>219:10</strong> (new_http_inspect) self directory traversal
</p>
</li>
<li>
<p>
<strong>219:11</strong> (new_http_inspect) directory traversal
</p>
</li>
<li>
<p>
<strong>219:12</strong> (new_http_inspect) apache whitespace (tab)
</p>
</li>
<li>
<p>
<strong>219:13</strong> (new_http_inspect) non-RFC http delimiter
</p>
</li>
<li>
<p>
<strong>219:14</strong> (new_http_inspect) non-RFC defined char
</p>
</li>
<li>
<p>
<strong>219:15</strong> (new_http_inspect) oversize request-uri directory
</p>
</li>
<li>
<p>
<strong>219:16</strong> (new_http_inspect) oversize chunk encoding
</p>
</li>
<li>
<p>
<strong>219:17</strong> (new_http_inspect) unauthorized proxy use detected
</p>
</li>
<li>
<p>
<strong>219:18</strong> (new_http_inspect) webroot directory traversal
</p>
</li>
<li>
<p>
<strong>219:19</strong> (new_http_inspect) long header
</p>
</li>
<li>
<p>
<strong>219:20</strong> (new_http_inspect) max header fields
</p>
</li>
<li>
<p>
<strong>219:21</strong> (new_http_inspect) multiple content length
</p>
</li>
<li>
<p>
<strong>219:22</strong> (new_http_inspect) chunk size mismatch detected
</p>
</li>
<li>
<p>
<strong>219:23</strong> (new_http_inspect) invalid IP in true-client-IP/XFF header
</p>
</li>
<li>
<p>
<strong>219:24</strong> (new_http_inspect) multiple host hdrs detected
</p>
</li>
<li>
<p>
<strong>219:25</strong> (new_http_inspect) hostname exceeds 255 characters
</p>
</li>
<li>
<p>
<strong>219:26</strong> (new_http_inspect) header parsing space saturation
</p>
</li>
<li>
<p>
<strong>219:27</strong> (new_http_inspect) client consecutive small chunk sizes
</p>
</li>
<li>
<p>
<strong>219:28</strong> (new_http_inspect) post w/o content-length or chunks
</p>
</li>
<li>
<p>
<strong>219:29</strong> (new_http_inspect) multiple true ips in a session
</p>
</li>
<li>
<p>
<strong>219:30</strong> (new_http_inspect) both true-client-IP and XFF hdrs present
</p>
</li>
<li>
<p>
<strong>219:31</strong> (new_http_inspect) unknown method
</p>
</li>
<li>
<p>
<strong>219:32</strong> (new_http_inspect) simple request
</p>
</li>
<li>
<p>
<strong>219:33</strong> (new_http_inspect) unescaped space in HTTP URI
</p>
</li>
<li>
<p>
<strong>219:34</strong> (new_http_inspect) too many pipelined requests
</p>
</li>
<li>
<p>
<strong>219:35</strong> (new_http_inspect) anomalous http server on undefined HTTP port
</p>
</li>
<li>
<p>
<strong>219:36</strong> (new_http_inspect) invalid status code in HTTP response
</p>
</li>
<li>
<p>
<strong>219:37</strong> (new_http_inspect) no content-length or transfer-encoding in HTTP response
</p>
</li>
<li>
<p>
<strong>219:38</strong> (new_http_inspect) HTTP response has UTF charset which failed to normalize
</p>
</li>
<li>
<p>
<strong>219:39</strong> (new_http_inspect) HTTP response has UTF-7 charset
</p>
</li>
<li>
<p>
<strong>219:40</strong> (new_http_inspect) HTTP response gzip decompression failed
</p>
</li>
<li>
<p>
<strong>219:41</strong> (new_http_inspect) server consecutive small chunk sizes
</p>
</li>
<li>
<p>
<strong>219:42</strong> (new_http_inspect) invalid content-length or chunk size
</p>
</li>
<li>
<p>
<strong>219:43</strong> (new_http_inspect) javascript obfuscation levels exceeds 1
</p>
</li>
<li>
<p>
<strong>219:44</strong> (new_http_inspect) javascript whitespaces exceeds max allowed
</p>
</li>
<li>
<p>
<strong>219:45</strong> (new_http_inspect) multiple encodings within javascript obfuscated data
</p>
</li>
<li>
<p>
<strong>219:46</strong> (new_http_inspect) SWF file zlib decompression failure
</p>
</li>
<li>
<p>
<strong>219:47</strong> (new_http_inspect) SWF file LZMA decompression failure
</p>
</li>
<li>
<p>
<strong>219:48</strong> (new_http_inspect) PDF file deflate decompression failure
</p>
</li>
<li>
<p>
<strong>219:49</strong> (new_http_inspect) PDF file unsupported compression type
</p>
</li>
<li>
<p>
<strong>219:50</strong> (new_http_inspect) PDF file cascaded compression
</p>
</li>
<li>
<p>
<strong>219:51</strong> (new_http_inspect) PDF file parse failure
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_normalizer">normalizer</h3>
<div class="paragraph"><p>What: packet scrubbing for inline mode</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>normalizer.ip4.base</strong> = true: clear options
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip4.df</strong> = false: clear don&#8217;t frag flag
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip4.rf</strong> = false: clear reserved flag
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip4.tos</strong> = false: clear tos / differentiated services byte
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip4.trim</strong> = false: truncate excess payload beyond datagram length
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.base</strong> = true: clear reserved bits and option padding and fix urgent pointer / flags issues
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.ips</strong> = false: ensure consistency in retransmitted data
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.urp</strong> = true: adjust urgent pointer if beyond segment length
</p>
</li>
<li>
<p>
select <strong>normalizer.tcp.ecn</strong> = off: clear ecn for all packets | sessions w/o ecn setup { off | packet | stream }
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.trim</strong> = false: trim data on syn and reset and any outside window or past mss,
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.opts</strong> = false: clear all options except mss, wscale, timestamp, and any explicitly allowed
</p>
</li>
<li>
<p>
multi <strong>normalizer.tcp.allow_names</strong>: don&#8217;t clear given option names { sack | echo | partial_order | conn_count | alt_checksum | md5 }
</p>
</li>
<li>
<p>
string <strong>normalizer.tcp.allow_codes</strong>: don&#8217;t clear given option codes
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip6</strong> = false: clear reserved flag
</p>
</li>
<li>
<p>
bool <strong>normalizer.icmp4</strong> = false: clear reserved flag
</p>
</li>
<li>
<p>
bool <strong>normalizer.icmp6</strong> = false: clear reserved flag
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>normalizer.ip4 trim</strong>: eth packets trimmed to datagram size
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 tos</strong>: type of service normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 df</strong>: don&#8217;t frag bit normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 rf</strong>: reserved flag bit clears
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 ttl</strong>: time-to-live normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 opts</strong>: ip4 options cleared
</p>
</li>
<li>
<p>
<strong>normalizer.icmp4 echo</strong>: icmp4 ping normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip6 hops</strong>: ip6 hop limit normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip6 options</strong>: ip6 options cleared
</p>
</li>
<li>
<p>
<strong>normalizer.icmp6 echo</strong>: icmp6 echo normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.tcp syn options</strong>: SYN only options cleared from non-SYN packets
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ts ecr</strong>: timestamp cleared on non-ACKs
</p>
</li>
<li>
<p>
<strong>normalizer.tcp options</strong>: packets with options cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp paddding</strong>: packets with padding cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp reserved</strong>: packets with reserved bits cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ecn pkt</strong>: packets with ECN bits cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp nonce</strong>: packets with nonce bit cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp urgent flag</strong>: packets without urgent flag with urgent pointer cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp urgent ptr</strong>: packets without data with urgent poniter cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp trim</strong>: tcp segments trimmed to correct size
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ecn session</strong>: ECN bits cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ts nop</strong>: timestamp options cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ips data</strong>: normalized segments
</p>
</li>
<li>
<p>
<strong>normalizer.tcp block</strong>: blocked segments
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_perf_monitor">perf_monitor</h3>
<div class="paragraph"><p>What: performance monitoring and flow statistics collection</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>perf_monitor.packets</strong> = 10000: minim packets to report { 0: }
</p>
</li>
<li>
<p>
int <strong>perf_monitor.seconds</strong> = 60: report interval; 0 means report at exit only { 0: }
</p>
</li>
<li>
<p>
int <strong>perf_monitor.flow_ip_memcap</strong> = 52428800: maximum memory for flow tracking { 0: }
</p>
</li>
<li>
<p>
int <strong>perf_monitor.max_file_size</strong> = 4096: files will be rolled over if they exceed this size { 4096: }
</p>
</li>
<li>
<p>
int <strong>perf_monitor.flow_ports</strong> = 1023: maximum ports to track { 0: }
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.reset</strong> = true: reset (clear) statistics after each reporting interval
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.max</strong> = false: calculate theoretical maximum performance
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.console</strong> = false: output to console
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.events</strong> = false: report on qualified vs non-qualified events
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.file</strong> = false: output base stats to perf_monitor.csv instead of stdout
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.flow</strong> = false: enable traffic statistics
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.flow_file</strong> = false: output traffic statistics to a perf_monitor_flow.csv instead of stdout
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.flow_ip</strong> = false: enable statistics on host pairs
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.flow_ip_file</strong> = false: output host pair statistics to perf_monitor_flow_ip.csv instead of stdout
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>perf_monitor.packets</strong>: total packets
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_port_scan">port_scan</h3>
<div class="paragraph"><p>What: port scan inspector; also configure port_scan_global</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
multi <strong>port_scan.protos</strong> = all: choose the protocols to monitor { tcp | udp | icmp | ip | all }
</p>
</li>
<li>
<p>
multi <strong>port_scan.scan_types</strong> = all: choose type of scans to look for { portscan | portsweep | decoy_portscan | distributed_portscan | all }
</p>
</li>
<li>
<p>
enum <strong>port_scan.sense_level</strong> = medium: choose the level of detection { low | medium | high }
</p>
</li>
<li>
<p>
string <strong>port_scan.watch_ip</strong>: list of CIDRs with optional ports to watch
</p>
</li>
<li>
<p>
string <strong>port_scan.ignore_scanners</strong>: list of CIDRs with optional ports to ignore if the source of scan alerts
</p>
</li>
<li>
<p>
string <strong>port_scan.ignore_scanned</strong>: list of CIDRs with optional ports to ignore if the destination of scan alerts
</p>
</li>
<li>
<p>
bool <strong>port_scan.include_midstream</strong> = false: list of CIDRs with optional ports
</p>
</li>
<li>
<p>
bool <strong>port_scan.logfile</strong> = false: write scan events to file
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>122:1</strong> (port_scan) TCP portscan
</p>
</li>
<li>
<p>
<strong>122:2</strong> (port_scan) TCP decoy portscan
</p>
</li>
<li>
<p>
<strong>122:3</strong> (port_scan) TCP portsweep
</p>
</li>
<li>
<p>
<strong>122:4</strong> (port_scan) TCP distributed portscan
</p>
</li>
<li>
<p>
<strong>122:5</strong> (port_scan) TCP filtered portscan
</p>
</li>
<li>
<p>
<strong>122:6</strong> (port_scan) TCP filtered decoy portscan
</p>
</li>
<li>
<p>
<strong>122:7</strong> (port_scan) TCP filtered portsweep
</p>
</li>
<li>
<p>
<strong>122:8</strong> (port_scan) TCP filtered distributed portscan
</p>
</li>
<li>
<p>
<strong>122:9</strong> (port_scan) IP protocol scan
</p>
</li>
<li>
<p>
<strong>122:10</strong> (port_scan) IP decoy protocol scan
</p>
</li>
<li>
<p>
<strong>122:11</strong> (port_scan) IP protocol sweep
</p>
</li>
<li>
<p>
<strong>122:12</strong> (port_scan) IP distributed protocol scan
</p>
</li>
<li>
<p>
<strong>122:13</strong> (port_scan) IP filtered protocol scan
</p>
</li>
<li>
<p>
<strong>122:14</strong> (port_scan) IP filtered decoy protocol scan
</p>
</li>
<li>
<p>
<strong>122:15</strong> (port_scan) IP filtered protocol sweep
</p>
</li>
<li>
<p>
<strong>122:16</strong> (port_scan) IP filtered distributed protocol scan
</p>
</li>
<li>
<p>
<strong>122:17</strong> (port_scan) UDP portscan
</p>
</li>
<li>
<p>
<strong>122:18</strong> (port_scan) UDP decoy portscan
</p>
</li>
<li>
<p>
<strong>122:19</strong> (port_scan) UDP portsweep
</p>
</li>
<li>
<p>
<strong>122:20</strong> (port_scan) UDP distributed portscan
</p>
</li>
<li>
<p>
<strong>122:21</strong> (port_scan) UDP filtered portscan
</p>
</li>
<li>
<p>
<strong>122:22</strong> (port_scan) UDP filtered decoy portscan
</p>
</li>
<li>
<p>
<strong>122:23</strong> (port_scan) UDP filtered portsweep
</p>
</li>
<li>
<p>
<strong>122:24</strong> (port_scan) UDP filtered distributed portscan
</p>
</li>
<li>
<p>
<strong>122:25</strong> (port_scan) ICMP sweep
</p>
</li>
<li>
<p>
<strong>122:26</strong> (port_scan) ICMP filtered sweep
</p>
</li>
<li>
<p>
<strong>122:27</strong> (port_scan) open port
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_rpc_decode">rpc_decode</h3>
<div class="paragraph"><p>What: RPC inspector</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>106:1</strong> (rpc_decode) fragmented RPC records
</p>
</li>
<li>
<p>
<strong>106:2</strong> (rpc_decode) multiple RPC records
</p>
</li>
<li>
<p>
<strong>106:3</strong> (rpc_decode) large RPC record fragment
</p>
</li>
<li>
<p>
<strong>106:4</strong> (rpc_decode) incomplete RPC segment
</p>
</li>
<li>
<p>
<strong>106:5</strong> (rpc_decode) zero-length RPC fragment
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>rpc_decode.packets</strong>: total packets
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_stream">stream</h3>
<div class="paragraph"><p>What: common flow tracking</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>stream.icmp_cache.memcap</strong>: maximum cache memory { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.icmp_cache.idle_timeout</strong> = 60: maximum inactive time before retiring session tracker { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.icmp_cache.pruning_timeout</strong> = 30: minimum inactive time before being eligible for pruning { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.icmp_cache.max_sessions</strong> = 262144: maximum simultaneous tcp sessions tracked before pruning { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.ip_cache.memcap</strong>: maximum cache memory { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.ip_cache.idle_timeout</strong> = 60: maximum inactive time before retiring session tracker { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.ip_cache.pruning_timeout</strong> = 30: minimum inactive time before being eligible for pruning { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.ip_cache.max_sessions</strong> = 262144: maximum simultaneous tcp sessions tracked before pruning { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.tcp_cache.memcap</strong>: maximum cache memory { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.tcp_cache.idle_timeout</strong> = 60: maximum inactive time before retiring session tracker { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.tcp_cache.pruning_timeout</strong> = 30: minimum inactive time before being eligible for pruning { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.tcp_cache.max_sessions</strong> = 262144: maximum simultaneous tcp sessions tracked before pruning { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.udp_cache.memcap</strong>: maximum cache memory { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.udp_cache.idle_timeout</strong> = 60: maximum inactive time before retiring session tracker { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.udp_cache.pruning_timeout</strong> = 30: minimum inactive time before being eligible for pruning { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.udp_cache.max_sessions</strong> = 262144: maximum simultaneous tcp sessions tracked before pruning { 0: }
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>stream.tcp flows</strong>: total tcp sessions
</p>
</li>
<li>
<p>
<strong>stream.tcp prunes</strong>: tcp sessions pruned
</p>
</li>
<li>
<p>
<strong>stream.udp flows</strong>: total udp sessions
</p>
</li>
<li>
<p>
<strong>stream.udp prunes</strong>: udp sessions pruned
</p>
</li>
<li>
<p>
<strong>stream.icmp flows</strong>: total icmp sessions
</p>
</li>
<li>
<p>
<strong>stream.icmp prunes</strong>: icmp sessions pruned
</p>
</li>
<li>
<p>
<strong>stream.ip flows</strong>: total ip sessions
</p>
</li>
<li>
<p>
<strong>stream.ip prunes</strong>: ip sessions pruned
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_stream_icmp">stream_icmp</h3>
<div class="paragraph"><p>What: stream inspector for ICMP flow tracking</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>stream_icmp.session_timeout</strong> = 30: session tracking timeout { 1:86400 }
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>stream_icmp.created</strong>: icmp session trackers created
</p>
</li>
<li>
<p>
<strong>stream_icmp.released</strong>: icmp session trackers released
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_stream_ip">stream_ip</h3>
<div class="paragraph"><p>What: stream inspector for IP flow tracking and defragmentation</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>stream_ip.max_frags</strong> = 8192: maximum number of simultaneous fragments being tracked { 1: }
</p>
</li>
<li>
<p>
int <strong>stream_ip.max_overlaps</strong> = 0: maximum allowed overlaps per datagram; 0 is unlimited { 0: }
</p>
</li>
<li>
<p>
int <strong>stream_ip.min_frag_length</strong> = 0: alert if fragment length is below this limit before or after trimming { 0: }
</p>
</li>
<li>
<p>
int <strong>stream_ip.min_ttl</strong> = 1: discard fragments with ttl below the minimum { 1:255 }
</p>
</li>
<li>
<p>
enum <strong>stream_ip.policy</strong> = linux: fragment reassembly policy { first | linux | bsd | bsd_right | last | windows | solaris }
</p>
</li>
<li>
<p>
int <strong>stream_ip.session_timeout</strong> = 30: session tracking timeout { 1:86400 }
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>123:1</strong> (stream_ip) inconsistent IP options on fragmented packets
</p>
</li>
<li>
<p>
<strong>123:2</strong> (stream_ip) teardrop attack
</p>
</li>
<li>
<p>
<strong>123:3</strong> (stream_ip) short fragment, possible DOS attempt
</p>
</li>
<li>
<p>
<strong>123:4</strong> (stream_ip) fragment packet ends after defragmented packet
</p>
</li>
<li>
<p>
<strong>123:5</strong> (stream_ip) zero-byte fragment packet
</p>
</li>
<li>
<p>
<strong>123:6</strong> (stream_ip) bad fragment size, packet size is negative
</p>
</li>
<li>
<p>
<strong>123:7</strong> (stream_ip) bad fragment size, packet size is greater than 65536
</p>
</li>
<li>
<p>
<strong>123:8</strong> (stream_ip) fragmentation overlap
</p>
</li>
<li>
<p>
<strong>123:11</strong> (stream_ip) TTL value less than configured minimum, not using for reassembly
</p>
</li>
<li>
<p>
<strong>123:12</strong> (stream_ip) excessive fragment overlap
</p>
</li>
<li>
<p>
<strong>123:13</strong> (stream_ip) tiny fragment
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>stream_ip.fragments</strong>: total fragments
</p>
</li>
<li>
<p>
<strong>stream_ip.reassembled</strong>: reassembled datagrams
</p>
</li>
<li>
<p>
<strong>stream_ip.discards</strong>: fragments discarded
</p>
</li>
<li>
<p>
<strong>stream_ip.memory faults</strong>: memory faults
</p>
</li>
<li>
<p>
<strong>stream_ip.frag timeouts</strong>: datagrams abandoned
</p>
</li>
<li>
<p>
<strong>stream_ip.overlaps</strong>: overlapping fragments
</p>
</li>
<li>
<p>
<strong>stream_ip.anomalies</strong>: anomalies detected
</p>
</li>
<li>
<p>
<strong>stream_ip.alerts</strong>: alerts generated
</p>
</li>
<li>
<p>
<strong>stream_ip.drops</strong>: fragments dropped
</p>
</li>
<li>
<p>
<strong>stream_ip.trackers added</strong>: datagram trackers created
</p>
</li>
<li>
<p>
<strong>stream_ip.trackers freed</strong>: datagram trackers released
</p>
</li>
<li>
<p>
<strong>stream_ip.nodes inserted</strong>: fragments added to tracker
</p>
</li>
<li>
<p>
<strong>stream_ip.nodes deleted</strong>: fragments deleted from tracker
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_stream_tcp">stream_tcp</h3>
<div class="paragraph"><p>What: stream inspector for TCP flow tracking and stream normalization and reassembly</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>stream_tcp.flush_factor</strong> = 0: flush upon seeing a drop in segment size after given number of non-decreasing segments { 0: }
</p>
</li>
<li>
<p>
bool <strong>stream_tcp.ignore_any_rules</strong> = false: process tcp content rules w/o ports only if rules with ports are present
</p>
</li>
<li>
<p>
int <strong>stream_tcp.max_window</strong> = 0: maximum allowed tcp window { 0:1073725440 }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.overlap_limit</strong> = 0: maximum number of allowed overlapping segments per session { 0:255 }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.max_pdu</strong> = 16384: maximum reassembled PDU size { 1460:63780 }
</p>
</li>
<li>
<p>
enum <strong>stream_tcp.policy</strong> = linux: determines operating system characteristics like reassembly { first | last | linux | old-linux | bsd | macos | solaris | irix | hpux | hpux10 | windows | win-2003 | vista }
</p>
</li>
<li>
<p>
bool <strong>stream_tcp.reassemble_async</strong> = true: queue data for reassembly before traffic is seen in both directions
</p>
</li>
<li>
<p>
int <strong>stream_tcp.require_3whs</strong> = -1: don&#8217;t track midstream sessions after given seconds from start up; -1 tracks all { -1:86400 }
</p>
</li>
<li>
<p>
bool <strong>stream_tcp.show_rebuilt_packets</strong> = false: enable cmg like output of reassembled packets
</p>
</li>
<li>
<p>
int <strong>stream_tcp.queue_limit.max_bytes</strong> = 1048576: don&#8217;t queue more than given bytes per session and direction { 0: }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.queue_limit.max_segments</strong> = 2621: don&#8217;t queue more than given segments per session and direction { 0: }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.small_segments.count</strong> = 0: limit number of small segments queued { 0:2048 }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.small_segments.maximum_size</strong> = 0: limit number of small segments queued { 0:2048 }
</p>
</li>
<li>
<p>
bit_list <strong>stream_tcp.small_segments.ignore_ports</strong>: limit number of small segments queued { 65535 }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.session_timeout</strong> = 30: session tracking timeout { 1:86400 }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.footprint</strong> = 0: use zero for production, non-zero for testing at given size { 0: }
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>129:1</strong> (stream_tcp) SYN on established session
</p>
</li>
<li>
<p>
<strong>129:2</strong> (stream_tcp) data on SYN packet
</p>
</li>
<li>
<p>
<strong>129:3</strong> (stream_tcp) data sent on stream not accepting data
</p>
</li>
<li>
<p>
<strong>129:4</strong> (stream_tcp) TCP timestamp is outside of PAWS window
</p>
</li>
<li>
<p>
<strong>129:5</strong> (stream_tcp) bad segment, adjusted size &#8656; 0
</p>
</li>
<li>
<p>
<strong>129:6</strong> (stream_tcp) window size (after scaling) larger than policy allows
</p>
</li>
<li>
<p>
<strong>129:7</strong> (stream_tcp) limit on number of overlapping TCP packets reached
</p>
</li>
<li>
<p>
<strong>129:8</strong> (stream_tcp) data sent on stream after TCP Reset sent
</p>
</li>
<li>
<p>
<strong>129:9</strong> (stream_tcp) TCP client possibly hijacked, different ethernet address
</p>
</li>
<li>
<p>
<strong>129:10</strong> (stream_tcp) TCP Server possibly hijacked, different ethernet address
</p>
</li>
<li>
<p>
<strong>129:11</strong> (stream_tcp) TCP data with no TCP flags set
</p>
</li>
<li>
<p>
<strong>129:12</strong> (stream_tcp) consecutive TCP small segments exceeding threshold
</p>
</li>
<li>
<p>
<strong>129:13</strong> (stream_tcp) 4-way handshake detected
</p>
</li>
<li>
<p>
<strong>129:14</strong> (stream_tcp) TCP timestamp is missing
</p>
</li>
<li>
<p>
<strong>129:15</strong> (stream_tcp) reset outside window
</p>
</li>
<li>
<p>
<strong>129:16</strong> (stream_tcp) FIN number is greater than prior FIN
</p>
</li>
<li>
<p>
<strong>129:17</strong> (stream_tcp) ACK number is greater than prior FIN
</p>
</li>
<li>
<p>
<strong>129:18</strong> (stream_tcp) data sent on stream after TCP Reset received
</p>
</li>
<li>
<p>
<strong>129:19</strong> (stream_tcp) TCP window closed before receiving data
</p>
</li>
<li>
<p>
<strong>129:20</strong> (stream_tcp) TCP session without 3-way handshake
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>stream_tcp.sessions</strong>: total sessions
</p>
</li>
<li>
<p>
<strong>stream_tcp.timeouts</strong>: sessions timed out
</p>
</li>
<li>
<p>
<strong>stream_tcp.resyns</strong>: SYN received on established session
</p>
</li>
<li>
<p>
<strong>stream_tcp.discards</strong>: tcp packets discarded
</p>
</li>
<li>
<p>
<strong>stream_tcp.events</strong>: events generated
</p>
</li>
<li>
<p>
<strong>stream_tcp.ignored</strong>: tcp packets ignored
</p>
</li>
<li>
<p>
<strong>stream_tcp.untracked</strong>: tcp packets not tracked
</p>
</li>
<li>
<p>
<strong>stream_tcp.syn trackers</strong>: tcp session tracking started on syn
</p>
</li>
<li>
<p>
<strong>stream_tcp.syn-ack trackers</strong>: tcp session tracking started on syn-ack
</p>
</li>
<li>
<p>
<strong>stream_tcp.3way trackers</strong>: tcp session tracking started on ack
</p>
</li>
<li>
<p>
<strong>stream_tcp.data trackers</strong>: tcp session tracking started on data
</p>
</li>
<li>
<p>
<strong>stream_tcp.trackers created</strong>: tcp session trackers created
</p>
</li>
<li>
<p>
<strong>stream_tcp.trackers released</strong>: tcp session trackers released
</p>
</li>
<li>
<p>
<strong>stream_tcp.segs queued</strong>: total segments queued
</p>
</li>
<li>
<p>
<strong>stream_tcp.segs released</strong>: total segments released
</p>
</li>
<li>
<p>
<strong>stream_tcp.segs split</strong>: tcp segments split when reassembling PDUs
</p>
</li>
<li>
<p>
<strong>stream_tcp.segs used</strong>: queued tcp segments applied to reassembled PDUs
</p>
</li>
<li>
<p>
<strong>stream_tcp.rebuilt packets</strong>: total reassembled PDUs
</p>
</li>
<li>
<p>
<strong>stream_tcp.rebuilt buffers</strong>: rebuilt PDU sections
</p>
</li>
<li>
<p>
<strong>stream_tcp.overlaps</strong>: overlapping segments queued
</p>
</li>
<li>
<p>
<strong>stream_tcp.gaps</strong>: missing data between PDUs
</p>
</li>
<li>
<p>
<strong>stream_tcp.max segs</strong>: number of times the maximum queued segment limit was reached
</p>
</li>
<li>
<p>
<strong>stream_tcp.max bytes</strong>: number of times the maximum queued byte limit was reached
</p>
</li>
<li>
<p>
<strong>stream_tcp.internal events</strong>: 135:X events generated
</p>
</li>
<li>
<p>
<strong>stream_tcp.client cleanups</strong>: number of times data from server was flushed when session released
</p>
</li>
<li>
<p>
<strong>stream_tcp.server cleanups</strong>: number of times data from client was flushed when session released
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_stream_udp">stream_udp</h3>
<div class="paragraph"><p>What: stream inspector for UDP flow tracking</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>stream_udp.session_timeout</strong> = 30: session tracking timeout { 1:86400 }
</p>
</li>
<li>
<p>
bool <strong>stream_udp.ignore_any_rules</strong> = false: process udp content rules w/o ports only if rules with ports are present
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>stream_udp.sessions</strong>: total udp sessions
</p>
</li>
<li>
<p>
<strong>stream_udp.created</strong>: udp session trackers created
</p>
</li>
<li>
<p>
<strong>stream_udp.released</strong>: udp session trackers released
</p>
</li>
<li>
<p>
<strong>stream_udp.timeouts</strong>: udp session timeouts
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_telnet">telnet</h3>
<div class="paragraph"><p>What: telnet inspection and normalization</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>telnet.ayt_attack_thresh</strong> = -1: alert on this number of consecutive telnet AYT commands { -1: }
</p>
</li>
<li>
<p>
bool <strong>telnet.check_encrypted</strong> = false: check for end of encryption
</p>
</li>
<li>
<p>
bool <strong>telnet.encrypted_traffic</strong> = false: check for encrypted telnet and ftp
</p>
</li>
<li>
<p>
bool <strong>telnet.normalize</strong> = false: eliminate escape sequences
</p>
</li>
</ul></div>
<div class="paragraph"><p>Rules:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>126:1</strong> (telnet) consecutive telnet AYT commands beyond threshold
</p>
</li>
<li>
<p>
<strong>126:2</strong> (telnet) telnet traffic encrypted
</p>
</li>
<li>
<p>
<strong>126:3</strong> (telnet) telnet subnegotiation begin command without subnegotiation end
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>telnet.packets</strong>: total packets
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_wizard_2">wizard</h3>
<div class="paragraph"><p>What: inspector that implements port-independent protocol identification</p></div>
<div class="paragraph"><p>Type: inspector</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>wizard.hexes[].service</strong>: name of service
</p>
</li>
<li>
<p>
select <strong>wizard.hexes[].proto</strong> = tcp: protocol to scan { tcp | udp }
</p>
</li>
<li>
<p>
bool <strong>wizard.hexes[].client_first</strong> = true: which end initiates data transfer
</p>
</li>
<li>
<p>
string <strong>wizard.hexes[].to_server[].hex</strong>: sequence of data with wild chars (?)
</p>
</li>
<li>
<p>
string <strong>wizard.hexes[].to_client[].hex</strong>: sequence of data with wild chars (?)
</p>
</li>
<li>
<p>
string <strong>wizard.spells[].service</strong>: name of service
</p>
</li>
<li>
<p>
select <strong>wizard.spells[].proto</strong> = tcp: protocol to scan { tcp | udp }
</p>
</li>
<li>
<p>
bool <strong>wizard.spells[].client_first</strong> = true: which end initiates data transfer
</p>
</li>
<li>
<p>
string <strong>wizard.spells[].to_server[].spell</strong>: sequence of data with wild cards (*)
</p>
</li>
<li>
<p>
string <strong>wizard.spells[].to_client[].spell</strong>: sequence of data with wild cards (*)
</p>
</li>
</ul></div>
<div class="paragraph"><p>Peg counts:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>wizard.tcp scans</strong>: tcp payload scans
</p>
</li>
<li>
<p>
<strong>wizard.tcp hits</strong>: tcp identifications
</p>
</li>
<li>
<p>
<strong>wizard.udp scans</strong>: udp payload scans
</p>
</li>
<li>
<p>
<strong>wizard.udp hits</strong>: udp identifications
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ips_action_modules">IPS Action Modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>IPS actions allow you to perform custom actions when events are generated.
Unlike loggers, these are invoked before thresholding and can be used to
control external agents.</p></div>
<div class="sect2">
<h3 id="_react">react</h3>
<div class="paragraph"><p>What: send response to client and terminate session</p></div>
<div class="paragraph"><p>Type: ips_action</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
implied <strong>react.msg</strong>:  use rule message in response page
</p>
</li>
<li>
<p>
string <strong>react.page</strong>: file containing HTTP response (headers and body)
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_reject">reject</h3>
<div class="paragraph"><p>What: terminate session with TCP reset or ICMP unreachable</p></div>
<div class="paragraph"><p>Type: ips_action</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
enum <strong>reject.reset</strong>: send tcp reset to one or both ends { source|dest|both }
</p>
</li>
<li>
<p>
enum <strong>reject.control</strong>: send icmp unreachable(s) { network|host|port|all }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_rewrite">rewrite</h3>
<div class="paragraph"><p>What: overwrite packet contents</p></div>
<div class="paragraph"><p>Type: ips_action</p></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_ips_option_modules">IPS Option Modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>IPS options are the building blocks of IPS rules.</p></div>
<div class="sect2">
<h3 id="_ack">ack</h3>
<div class="paragraph"><p>What: rule option to match on TCP ack numbers</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>ack.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_asn1">asn1</h3>
<div class="paragraph"><p>What: rule option for asn1 detection</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
implied <strong>asn1.bitstring_overflow</strong>: Detects invalid bitstring encodings that are known to be remotely exploitable.
</p>
</li>
<li>
<p>
implied <strong>asn1.double_overflow</strong>: Detects a double ASCII encoding that is larger than a standard buffer.
</p>
</li>
<li>
<p>
implied <strong>asn1.print</strong>: &lt;&gt;max | &lt;max | &gt;min
</p>
</li>
<li>
<p>
int <strong>asn1.oversize_length</strong>: Compares ASN.1 type lengths with the supplied argument. { 0: }
</p>
</li>
<li>
<p>
int <strong>asn1.absolute_offset</strong>: Absolute offset from the beginning of the packet. { 0: }
</p>
</li>
<li>
<p>
int <strong>asn1.relative_offset</strong>: relative offset from the cursor.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_base64_decode">base64_decode</h3>
<div class="paragraph"><p>What: rule option to decode base64 data - must be used with base64_data option</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>base64_decode.bytes</strong>: Number of base64 encoded bytes to decode. { 1: }
</p>
</li>
<li>
<p>
int <strong>base64_decode.offset</strong>: Bytes past start of buffer to start decoding. { 0: }
</p>
</li>
<li>
<p>
implied <strong>base64_decode.relative</strong>: Apply offset to cursor instead of start of buffer.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_bufferlen">bufferlen</h3>
<div class="paragraph"><p>What: rule option to check length of current buffer</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>bufferlen.~range</strong>: len | min&lt;&gt;max | &lt;max | &gt;min
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_byte_extract">byte_extract</h3>
<div class="paragraph"><p>What: rule option to convert data to an integer variable</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>byte_extract.~count</strong>: number of bytes to pick up from the buffer { 1:10 }
</p>
</li>
<li>
<p>
int <strong>byte_extract.~offset</strong>: number of bytes into the buffer to start processing { -65535:65535 }
</p>
</li>
<li>
<p>
string <strong>byte_extract.~name</strong>: name of the variable that will be used in other rule options
</p>
</li>
<li>
<p>
implied <strong>byte_extract.relative</strong>: offset from cursor instead of start of buffer
</p>
</li>
<li>
<p>
int <strong>byte_extract.multiplier</strong>: scale extracted value by given amount { 1:65535 }
</p>
</li>
<li>
<p>
int <strong>byte_extract.align</strong>: round the number of converted bytes up to the next 2- or 4-byte boundary { 0:4 }
</p>
</li>
<li>
<p>
implied <strong>byte_extract.big</strong>: big endian
</p>
</li>
<li>
<p>
implied <strong>byte_extract.little</strong>: little endian
</p>
</li>
<li>
<p>
implied <strong>byte_extract.dce</strong>: dcerpc2 determines endianness
</p>
</li>
<li>
<p>
implied <strong>byte_extract.string</strong>: convert from string
</p>
</li>
<li>
<p>
implied <strong>byte_extract.hex</strong>: convert from hex string
</p>
</li>
<li>
<p>
implied <strong>byte_extract.oct</strong>: convert from octal string
</p>
</li>
<li>
<p>
implied <strong>byte_extract.dec</strong>: convert from decimal string
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_byte_jump">byte_jump</h3>
<div class="paragraph"><p>What: rule option to move the detection cursor</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>byte_jump.~count</strong>: number of bytes to pick up from the buffer { 1:10 }
</p>
</li>
<li>
<p>
string <strong>byte_jump.~offset</strong>: variable name or number of bytes into the buffer to start processing
</p>
</li>
<li>
<p>
implied <strong>byte_jump.relative</strong>: offset from cursor instead of start of buffer
</p>
</li>
<li>
<p>
implied <strong>byte_jump.from_beginning</strong>: jump from start of buffer instead of cursor
</p>
</li>
<li>
<p>
int <strong>byte_jump.multiplier</strong>: scale extracted value by given amount { 1:65535 }
</p>
</li>
<li>
<p>
int <strong>byte_jump.align</strong>: round the number of converted bytes up to the next 2- or 4-byte boundary { 0:4 }
</p>
</li>
<li>
<p>
int <strong>byte_jump.post_offset</strong>: also skip forward or backwards (positive of negative value) this number of bytes { -65535:65535 }
</p>
</li>
<li>
<p>
implied <strong>byte_jump.big</strong>: big endian
</p>
</li>
<li>
<p>
implied <strong>byte_jump.little</strong>: little endian
</p>
</li>
<li>
<p>
implied <strong>byte_jump.dce</strong>: dcerpc2 determines endianness
</p>
</li>
<li>
<p>
implied <strong>byte_jump.string</strong>: convert from string
</p>
</li>
<li>
<p>
implied <strong>byte_jump.hex</strong>: convert from hex string
</p>
</li>
<li>
<p>
implied <strong>byte_jump.oct</strong>: convert from octal string
</p>
</li>
<li>
<p>
implied <strong>byte_jump.dec</strong>: convert from decimal string
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_byte_test">byte_test</h3>
<div class="paragraph"><p>What: rule option to convert data to integer and compare</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>byte_test.~count</strong>: number of bytes to pick up from the buffer { 1:10 }
</p>
</li>
<li>
<p>
string <strong>byte_test.~operator</strong>: variable name or number of bytes into the buffer to start processing
</p>
</li>
<li>
<p>
string <strong>byte_test.~compare</strong>: variable name or value to test the converted result against
</p>
</li>
<li>
<p>
string <strong>byte_test.~offset</strong>: variable name or number of bytes into the payload to start processing
</p>
</li>
<li>
<p>
implied <strong>byte_test.relative</strong>: offset from cursor instead of start of buffer
</p>
</li>
<li>
<p>
implied <strong>byte_test.big</strong>: big endian
</p>
</li>
<li>
<p>
implied <strong>byte_test.little</strong>: little endian
</p>
</li>
<li>
<p>
implied <strong>byte_test.dce</strong>: dcerpc2 determines endianness
</p>
</li>
<li>
<p>
implied <strong>byte_test.string</strong>: convert from string
</p>
</li>
<li>
<p>
implied <strong>byte_test.hex</strong>: convert from hex string
</p>
</li>
<li>
<p>
implied <strong>byte_test.oct</strong>: convert from octal string
</p>
</li>
<li>
<p>
implied <strong>byte_test.dec</strong>: convert from decimal string
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_classtype">classtype</h3>
<div class="paragraph"><p>What: general rule option for rule classification</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>classtype.~</strong>: classification for this rule
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_content">content</h3>
<div class="paragraph"><p>What: payload rule option for basic pattern matching</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>content.~data</strong>: data to match
</p>
</li>
<li>
<p>
implied <strong>content.nocase</strong>: case insensitive match
</p>
</li>
<li>
<p>
implied <strong>content.fast_pattern</strong>: use this content in the fast pattern matcher instead of the content selected by default
</p>
</li>
<li>
<p>
int <strong>content.fast_pattern_offset</strong>: number of leading characters of this content the fast pattern matcher should exclude
</p>
</li>
<li>
<p>
int <strong>content.fast_pattern_length</strong>: maximum number of characters from this content the fast pattern matcher should use
</p>
</li>
<li>
<p>
string <strong>content.offset</strong>: var or number of bytes from start of buffer to start search
</p>
</li>
<li>
<p>
string <strong>content.depth</strong>: var or maximum number of bytes to search from beginning of buffer
</p>
</li>
<li>
<p>
string <strong>content.distance</strong>: var or number of bytes from cursor to start search
</p>
</li>
<li>
<p>
string <strong>content.within</strong>: var or maximum number of bytes to search from cursor
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_cvs">cvs</h3>
<div class="paragraph"><p>What: payload rule option for detecting specific attacks</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
implied <strong>cvs.invalid-entry</strong>: looks for an invalid Entry string
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_detection_filter">detection_filter</h3>
<div class="paragraph"><p>What: rule option to require multiple hits before a rule generates an event</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
enum <strong>detection_filter.track</strong>: track hits by source or destination IP address { by_src | by_dst }
</p>
</li>
<li>
<p>
int <strong>detection_filter.count</strong>: hits in interval before allowing the rule to fire { 1: }
</p>
</li>
<li>
<p>
int <strong>detection_filter.seconds</strong>: length of interval to count hits { 1: }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_dsize">dsize</h3>
<div class="paragraph"><p>What: rule option to test payload size</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>dsize.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_file_data">file_data</h3>
<div class="paragraph"><p>What: rule option to set detection cursor to file data</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_flags">flags</h3>
<div class="paragraph"><p>What: rule option to test TCP control flags</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>flags.~test_flags</strong>: these flags are tested
</p>
</li>
<li>
<p>
string <strong>flags.~mask_flags</strong>: these flags are don&#8217;t cares
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_flow">flow</h3>
<div class="paragraph"><p>What: rule option to check session properties</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
implied <strong>flow.to_client</strong>: match on server responses
</p>
</li>
<li>
<p>
implied <strong>flow.to_server</strong>: match on client requests
</p>
</li>
<li>
<p>
implied <strong>flow.from_client</strong>: same as to_server
</p>
</li>
<li>
<p>
implied <strong>flow.from_server</strong>: same as to_client
</p>
</li>
<li>
<p>
implied <strong>flow.established</strong>: match only during data transfer phase
</p>
</li>
<li>
<p>
implied <strong>flow.not_established</strong>: match only outside data transfer phase
</p>
</li>
<li>
<p>
implied <strong>flow.stateless</strong>: match regardless of stream state
</p>
</li>
<li>
<p>
implied <strong>flow.no_stream</strong>: match on raw packets only
</p>
</li>
<li>
<p>
implied <strong>flow.only_stream</strong>: match on reassembled packets only
</p>
</li>
<li>
<p>
implied <strong>flow.no_frag</strong>: match on raw packets only
</p>
</li>
<li>
<p>
implied <strong>flow.only_frag</strong>: match on defragmented packets only
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_flowbits">flowbits</h3>
<div class="paragraph"><p>What: rule option to set and test arbitrary boolean flags</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>flowbits.~command</strong>: set|reset|isset|etc.
</p>
</li>
<li>
<p>
string <strong>flowbits.~arg1</strong>: bits or group
</p>
</li>
<li>
<p>
string <strong>flowbits.~arg2</strong>: group if arg1 is bits
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_fragbits">fragbits</h3>
<div class="paragraph"><p>What: rule option to test IP frag flags</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>fragbits.~flags</strong>: these flags are tested
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_fragoffset">fragoffset</h3>
<div class="paragraph"><p>What: rule option to test IP frag offset</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>fragoffset.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_gid">gid</h3>
<div class="paragraph"><p>What: rule option specifying rule generator</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>gid.~</strong>: generator id { 1: }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_http_client_body">http_client_body</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the request body</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_http_cookie">http_cookie</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the HTTP cookie</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_http_header">http_header</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the normalized header(s)</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>http_header.~name</strong>: restrict to given header
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_http_method">http_method</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the HTTP request method</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_http_raw_cookie">http_raw_cookie</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the unnormalized cookie</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_http_raw_header">http_raw_header</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the unnormalized headers</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_http_raw_uri">http_raw_uri</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the unnormalized URI</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_http_stat_code">http_stat_code</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the HTTP status code</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_http_stat_msg">http_stat_msg</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the HTTP status message</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_http_uri">http_uri</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the normalized URI buffer</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_icmp_id">icmp_id</h3>
<div class="paragraph"><p>What: rule option to check ICMP ID</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>icmp_id.~range</strong>: check if icmp id is <em>id | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_icmp_seq">icmp_seq</h3>
<div class="paragraph"><p>What: rule option to check ICMP sequence number</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>icmp_seq.~range</strong>: check if icmp sequence number is <em>seq | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_icode">icode</h3>
<div class="paragraph"><p>What: rule option to check ICMP code</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>icode.~range</strong>: check if ICMP code is <em>code | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_id">id</h3>
<div class="paragraph"><p>What: rule option to check the IP ID field</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>id.~range</strong>: check if the IP ID is <em>id | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_ip_proto">ip_proto</h3>
<div class="paragraph"><p>What: rule option to check the IP protocol number</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>ip_proto.~proto</strong>: [!|&gt;|&lt;] name or number
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_ipopts">ipopts</h3>
<div class="paragraph"><p>What: rule option to check for IP options</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
select <strong>ipopts.~opt</strong>: output format { rr|eol|nop|ts|sec|esec|lsrr|lsrre|ssrr|satid|any }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_isdataat">isdataat</h3>
<div class="paragraph"><p>What: rule option to check for the presence of payload data</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>isdataat.~length</strong>: num | !num
</p>
</li>
<li>
<p>
implied <strong>isdataat.relative</strong>: offset from cursor instead of start of buffer
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_itype">itype</h3>
<div class="paragraph"><p>What: rule option to check ICMP type</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>itype.~range</strong>: check if icmp type is <em>type | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_metadata">metadata</h3>
<div class="paragraph"><p>What: rule option for conveying arbitrary name, value data within the rule text</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>metadata.service</strong>: service name
</p>
</li>
<li>
<p>
string <strong>metadata.</strong>*: additional parameters not used by snort
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_msg">msg</h3>
<div class="paragraph"><p>What: rule option summarizing rule purpose output with events</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>msg.~</strong>: message describing rule
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_pcre">pcre</h3>
<div class="paragraph"><p>What: rule option for matching payload data with regex</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>pcre.~regex</strong>: Snort regular expression
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_pkt_data">pkt_data</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the normalized packet data</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_priority">priority</h3>
<div class="paragraph"><p>What: rule option for prioritizing events</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>priority.~</strong>: relative severity level; 1 is highest priority { 1: }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_raw_data">raw_data</h3>
<div class="paragraph"><p>What: rule option to set the detection cursor to the raw packet data</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
</div>
<div class="sect2">
<h3 id="_reference">reference</h3>
<div class="paragraph"><p>What: rule option to indicate relevant attack identification system</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>reference.~scheme</strong>: reference scheme
</p>
</li>
<li>
<p>
string <strong>reference.~id</strong>: reference id
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_rem">rem</h3>
<div class="paragraph"><p>What: rule option to convey an arbitrary comment in the rule body</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>rem.~</strong>: comment
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_replace">replace</h3>
<div class="paragraph"><p>What: rule option to overwrite payload data; use with rewrite action</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>replace.~</strong>: byte code to replace with
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_rev">rev</h3>
<div class="paragraph"><p>What: rule option to indicate current revision of signature</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>rev.~</strong>: revision { 1: }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_rpc">rpc</h3>
<div class="paragraph"><p>What: rule option to check SUNRPC CALL parameters</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>rpc.~app</strong>: application number
</p>
</li>
<li>
<p>
string <strong>rpc.~ver</strong>: version number or * for any
</p>
</li>
<li>
<p>
string <strong>rpc.~proc</strong>: procedure number or * for any
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_seq">seq</h3>
<div class="paragraph"><p>What: rule option to check TCP sequence number</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>seq.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_session">session</h3>
<div class="paragraph"><p>What: rule option to check user data from TCP sessions</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
enum <strong>session.~mode</strong>: output format { printable|binary|all }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_sid">sid</h3>
<div class="paragraph"><p>What: rule option to indicate signature number</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>sid.~</strong>: signature id { 1: }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_so">so</h3>
<div class="paragraph"><p>What: rule option to call custom eval function</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>so.~func</strong>: name of eval function
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_soid">soid</h3>
<div class="paragraph"><p>What: rule option to specify a shared object rule ID</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>soid.~</strong>: SO rule ID has &lt;gid&gt;|&lt;sid&gt; format, like 3|12345
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_stream_reassemble">stream_reassemble</h3>
<div class="paragraph"><p>What: detection option for stream reassembly control</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
enum <strong>stream_reassemble.action</strong>: stop or start stream reassembly { disable|enable }
</p>
</li>
<li>
<p>
enum <strong>stream_reassemble.direction</strong>: action applies to the given direction(s) { client|server|both }
</p>
</li>
<li>
<p>
implied <strong>stream_reassemble.noalert</strong>: don&#8217;t alert when rule matches
</p>
</li>
<li>
<p>
implied <strong>stream_reassemble.fastpath</strong>: optionally whitelist the remainder of the session
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_stream_size">stream_size</h3>
<div class="paragraph"><p>What: detection option for stream size checking</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
enum <strong>stream_size.direction</strong>: compare applies to the given direction(s) { either|client|server|both }
</p>
</li>
<li>
<p>
enum <strong>stream_size.operator</strong>: how to compare { = | != | &lt; | &gt; | &#8656; | &gt;= }
</p>
</li>
<li>
<p>
int <strong>stream_size.size</strong>: size for comparison
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_tag">tag</h3>
<div class="paragraph"><p>What: rule option to log additional packets</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
enum <strong>tag.~</strong>: log all packets in session or all packets to or from host { session|host_src|host_dst }
</p>
</li>
<li>
<p>
int <strong>tag.packets</strong>: tag this many packets { 1: }
</p>
</li>
<li>
<p>
int <strong>tag.seconds</strong>: tag for this many seconds { 1: }
</p>
</li>
<li>
<p>
int <strong>tag.bytes</strong>: tag for this many bytes { 1: }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_tos">tos</h3>
<div class="paragraph"><p>What: rule option to check type of service field</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>tos.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_ttl">ttl</h3>
<div class="paragraph"><p>What: rule option to check time to live field</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>ttl.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_window">window</h3>
<div class="paragraph"><p>What: rule option to check TCP window field</p></div>
<div class="paragraph"><p>Type: ips_option</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
string <strong>window.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_search_engine_modules">Search Engine Modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>Search engines perform multipattern searching of packets and payload to find
rules that should be evaluated.  There are currently no specific modules,
although there are several search engine plugins.  Related configuration
is done with the basic detection module.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_so_rule_modules">SO Rule Modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>SO rules are dynamic rules that require custom coding to perform detection
not possible with the existing rule options.  These rules typically do not
have associated modules.</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_logger_modules">Logger Modules</h2>
<div class="sectionbody">
<div class="paragraph"><p>All output of events and packets is done by Loggers.</p></div>
<div class="sect2">
<h3 id="_alert_csv">alert_csv</h3>
<div class="paragraph"><p>What: output event in csv format</p></div>
<div class="paragraph"><p>Type: logger</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>alert_csv.file</strong> = false: output to alert_csv.txt instead of stdout
</p>
</li>
<li>
<p>
multi <strong>alert_csv.csv</strong> = timestamp gid sid rev src_addr src_port dst_addr dst_port: selected fields will be output in given order left to right { timestamp | gid | sid | rev | msg | proto | src_addr | dst_addr | src_port | dst_port | eth_src | eth_dst | eth_type | eth_len | ttl | tos | id | ip_len | dgm_len | icmp_type | icmp_code | icmp_id | icmp_seq | tcp_flags | tcp_seq | tcp_ack | tcp_len | tcp_win | udp_len }
</p>
</li>
<li>
<p>
int <strong>alert_csv.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
enum <strong>alert_csv.units</strong> = B: bytes | KB | MB | GB { B | K | M | G }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_alert_fast">alert_fast</h3>
<div class="paragraph"><p>What: output event with brief text format</p></div>
<div class="paragraph"><p>Type: logger</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>alert_fast.file</strong> = false: output to alert_fast.txt instead of stdout
</p>
</li>
<li>
<p>
bool <strong>alert_fast.packet</strong> = false: output packet dump with alert
</p>
</li>
<li>
<p>
int <strong>alert_fast.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
enum <strong>alert_fast.units</strong> = B: bytes | KB | MB | GB { B | K | M | G }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_alert_full">alert_full</h3>
<div class="paragraph"><p>What: output event with full packet dump</p></div>
<div class="paragraph"><p>Type: logger</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>alert_full.file</strong> = false: output to alert_full.txt instead of stdout
</p>
</li>
<li>
<p>
int <strong>alert_full.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
enum <strong>alert_full.units</strong> = B: limit is in bytes | KB | MB | GB { B | K | M | G }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_alert_syslog">alert_syslog</h3>
<div class="paragraph"><p>What: output event to syslog</p></div>
<div class="paragraph"><p>Type: logger</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
enum <strong>alert_syslog.facility</strong> = auth: part of priority applied to each message { auth | authpriv | daemon | user | local0 | local1 | local2 | local3 | local4 | local5 | local6 | local7 }
</p>
</li>
<li>
<p>
enum <strong>alert_syslog.level</strong> = info: part of priority applied to each message { emerg | alert | crit | err | warning | notice | info | debug }
</p>
</li>
<li>
<p>
multi <strong>alert_syslog.options</strong>: used to open the syslog connection { cons | ndelay | perror | pid }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_alert_test">alert_test</h3>
<div class="paragraph"><p>What: output event in custom tsv format</p></div>
<div class="paragraph"><p>Type: logger</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>alert_test.file</strong> = false: output to alert_test.txt instead of stdout
</p>
</li>
<li>
<p>
bool <strong>alert_test.rebuilt</strong> = false: include type:count where type is S for stream and F for frag
</p>
</li>
<li>
<p>
bool <strong>alert_test.session</strong> = false: include src-dst each of form -addr:port
</p>
</li>
<li>
<p>
bool <strong>alert_test.msg</strong> = false: include alert msg
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_alert_unixsock">alert_unixsock</h3>
<div class="paragraph"><p>What: output event over unix socket</p></div>
<div class="paragraph"><p>Type: logger</p></div>
</div>
<div class="sect2">
<h3 id="_log_codecs">log_codecs</h3>
<div class="paragraph"><p>What: log protocols in packet by layer</p></div>
<div class="paragraph"><p>Type: logger</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
bool <strong>log_codecs.file</strong> = stdout: output to log_codecs.txt instead of stdout
</p>
</li>
<li>
<p>
bool <strong>log_codecs.msg</strong> = false: include alert msg
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_log_pcap">log_pcap</h3>
<div class="paragraph"><p>What: log packet in pcap format</p></div>
<div class="paragraph"><p>Type: logger</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>log_pcap.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
enum <strong>log_pcap.units</strong> = B: bytes | KB | MB | GB { B | K | M | G }
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_unified2">unified2</h3>
<div class="paragraph"><p>What: output event and packet in unified2 format file</p></div>
<div class="paragraph"><p>Type: logger</p></div>
<div class="paragraph"><p>Configuration:</p></div>
<div class="ulist"><ul>
<li>
<p>
int <strong>unified2.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
enum <strong>unified2.units</strong> = B: limit multiplier { B | K | M | G }
</p>
</li>
<li>
<p>
bool <strong>unified2.nostamp</strong> = true: append file creation time to name (in Unix Epoch format)
</p>
</li>
<li>
<p>
bool <strong>unified2.mpls_event_types</strong> = false: include mpls labels in events
</p>
</li>
<li>
<p>
bool <strong>unified2.vlan_event_types</strong> = false: include vlan IDs in events
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_snort_vs_snort">Snort++ vs Snort</h2>
<div class="sectionbody">
<div class="paragraph"><p>Snort++ differs from Snort in the following ways:</p></div>
<div class="ulist"><ul>
<li>
<p>
command line and conf file syntax made more uniform
</p>
</li>
<li>
<p>
removed unused and deprecated features
</p>
</li>
<li>
<p>
remove as many barriers to successful run as possible
  (e.g.: no upper bounds on memcaps)
</p>
</li>
<li>
<p>
assume the simplest mode of operation
  (e.g.: never assume input from or output to some hardcoded filename)
</p>
</li>
<li>
<p>
all Snort config options are grouped into Snort++ modules
</p>
</li>
</ul></div>
<div class="sect2">
<h3 id="_build_options">Build Options</h3>
<div class="ulist"><ul>
<li>
<p>
configure --with-lib{pcap,pcre}-* &#8594; --with-{pcap,pcre}-*
</p>
</li>
<li>
<p>
control socket, cs_dir, and users were deleted
</p>
</li>
<li>
<p>
POLICY_BY_ID_ONLY code was deleted
</p>
</li>
<li>
<p>
hardened --enable-inline-init-failopen / INLINE_FAILOPEN
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_command_line">Command Line</h3>
<div class="ulist"><ul>
<li>
<p>
--pause loads config and waits for resume before processing packets
</p>
</li>
<li>
<p>
--require-rule-sid is hardened
</p>
</li>
<li>
<p>
--shell enables interactive Lua shell
</p>
</li>
<li>
<p>
-T is assumed if no input given
</p>
</li>
<li>
<p>
added --help-config prefix to dump all matching settings
</p>
</li>
<li>
<p>
added --script-path
</p>
</li>
<li>
<p>
added -K text; -K text/pcap is old dump/log mode
</p>
</li>
<li>
<p>
added -z &lt;#&gt; and --max-packet-threads &lt;#&gt;
</p>
</li>
<li>
<p>
delete --enable-mpls-multicast, --enable-mpls-overlapping-ip,
  --max-mpls-labelchain-len, --mpls-payload-type
</p>
</li>
<li>
<p>
deleted --pid-path and --no-interface-pidfile
</p>
</li>
<li>
<p>
deleting command line options which will be available with --lua or some such including:
  -I, -h, -F, -p, --disable-inline-init-failopen
</p>
</li>
<li>
<p>
hardened -n &lt; 0
</p>
</li>
<li>
<p>
removed --search-method
</p>
</li>
<li>
<p>
replaced "unknown args are bpf" with --bpf
</p>
</li>
<li>
<p>
replaced --dynamic-*-lib[-dir] with --plugin-path (with : separators)
</p>
</li>
<li>
<p>
removed -b, -N, -Z and, --perfmon-file options
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_conf_file">Conf File</h3>
<div class="ulist"><ul>
<li>
<p>
Snort++ has a default unicode.map
</p>
</li>
<li>
<p>
Snort++ will not enforce an upper bound on memcaps and the like within 64 bits
</p>
</li>
<li>
<p>
Snort++ will supply a default *_global config if not specified
  (Snort would fatal; e.g. http_inspect_server w/o http_inspect_global)
</p>
</li>
<li>
<p>
address list syntax changes: [[ and ]] must be [ [ and ] ] to avoid Lua string
  parsing errors (unless in quoted string)
</p>
</li>
<li>
<p>
because the Lua conf is live code, we lose file:line locations in app error messages
  (syntax errors from Lua have file:line)
</p>
</li>
<li>
<p>
changed search-method names for consistency
</p>
</li>
<li>
<p>
delete config include_vlan_in_alerts (not used in code)
</p>
</li>
<li>
<p>
delete config so_rule_memcap (not used in code)
</p>
</li>
<li>
<p>
deleted --disable-attribute-table-reload-thread
</p>
</li>
<li>
<p>
deleted config decode_*_{alerts,drops} (use rules only)
</p>
</li>
<li>
<p>
deleted config dump-dynamic-rules-path
</p>
</li>
<li>
<p>
deleted config ipv6_frag (not actually used)
</p>
</li>
<li>
<p>
deleted config threshold and ips rule threshold (&#8594; event_filter)
</p>
</li>
<li>
<p>
eliminated ac-split; must use ac-full-q split-any-any
</p>
</li>
<li>
<p>
frag3 &#8594; defrag, arpspoof &#8594; arp_spoof, sfportscan &#8594; port_scan,
  perfmonitor &#8594; perf_monitor, bo &#8594; back_orifice
</p>
</li>
<li>
<p>
limits like "1234K" are now "limit = 1234, units = <em>K</em>"
</p>
</li>
<li>
<p>
lua field names are (lower) case sensitive; snort.conf largely wasn&#8217;t
</p>
</li>
<li>
<p>
module filenames are not configurable: always &lt;log-dir&gt;/&lt;module-name&gt;&lt;suffix&gt;
  (suffix is determined by module)
</p>
</li>
<li>
<p>
no positional parameters; all name = value
</p>
</li>
<li>
<p>
perf_monitor configuration was simplified
</p>
</li>
<li>
<p>
portscan.detect_ack_scans deleted (exact same as include_midstream)
</p>
</li>
<li>
<p>
removed various run modes - now just one
</p>
</li>
<li>
<p>
frag3 default policy is Linux not bsd
</p>
</li>
<li>
<p>
lowmem* search methods are now in snort_examples
</p>
</li>
<li>
<p>
deleted unused http_inspect stateful mode
</p>
</li>
<li>
<p>
deleted stateless inspection from ftp and telnet
</p>
</li>
<li>
<p>
deleted http and ftp alert options (now strictly rule based)
</p>
</li>
<li>
<p>
preprocessor disabled settings deleted since no longer relevant
</p>
</li>
<li>
<p>
sessions are always created; snort config stateful checks eliminated
</p>
</li>
<li>
<p>
stream5_tcp: prune_log_max deleted; to be replaced with histogram
</p>
</li>
<li>
<p>
stream5_tcp: max_active_responses, min_response_seconds moved to
  active.max_responses, min_interval
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_rules">Rules</h3>
<div class="ulist"><ul>
<li>
<p>
all rules must have a sid
</p>
</li>
<li>
<p>
deleted activate / dynamic rules
</p>
</li>
<li>
<p>
deleted metadata engine shared
</p>
</li>
<li>
<p>
deleted metadata: rule-flushing (with PDU flushing rule flushing can cause
  missed attacks, the opposite of its intent)
</p>
</li>
<li>
<p>
deleted unused rule_state.action
</p>
</li>
<li>
<p>
fastpattern_offset, fast_pattern_length
</p>
</li>
<li>
<p>
no ; separated content suboptions
</p>
</li>
<li>
<p>
offset, depth, distance, and within must use a space separator not colon
  (e.g. offset:5; becomes offset 5;)
</p>
</li>
<li>
<p>
rule option sequence: &lt;stub&gt; soid &lt;hidden&gt;
</p>
</li>
<li>
<p>
sid == 0 not allowed
</p>
</li>
<li>
<p>
soid is now a non-metadata option
</p>
</li>
<li>
<p>
content suboptions http_* are now full options and should be place before content
</p>
</li>
<li>
<p>
the following pcre options have been deleted: use sticky buffers instead
    B, U, P, H, M, C, I, D, K, S, Y
</p>
</li>
<li>
<p>
deleted uricontent ips rule option.
  uricontent:"foo" -&#8594;  http_uri; content:"foo"
</p>
</li>
<li>
<p>
deleted urilen raw and norm; must use http_raw_uri and http_uri instead
</p>
</li>
<li>
<p>
deleted unused http_encode option
</p>
</li>
<li>
<p>
urilen replaced with generic bufferlen which applies to current sticky
  buffer
</p>
</li>
<li>
<p>
added optional selector to http_header, e.g. http_header:User-Agent;
</p>
</li>
<li>
<p>
multiline rules w/o \n
</p>
</li>
<li>
<p>
#begin &#8230; #end comments
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_output_2">Output</h3>
<div class="ulist"><ul>
<li>
<p>
alert_fast includes packet data by default
</p>
</li>
<li>
<p>
all text mode outputs default to stdout
</p>
</li>
<li>
<p>
changed default logging mode to -K none
</p>
</li>
<li>
<p>
deleted layer2resets and flexresp2_*
</p>
</li>
<li>
<p>
deleted log_ascii
</p>
</li>
<li>
<p>
general output guideline: don&#8217;t print zero counts
</p>
</li>
<li>
<p>
Snort++ queues decoder and inspector events to the main event queue before ips policy
  is selected; since some events may not be enabled, the queue needs to be sized larger
  than with Snort which used an intermediate queue for decoder events.
</p>
</li>
<li>
<p>
deleted the intermediate http and ftp_telnet event queues
</p>
</li>
<li>
<p>
alert_unified2 and log_unified2 have been deleted
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_snort2lua">Snort2Lua</h2>
<div class="sectionbody">
<div class="paragraph"><p>Snort2Lua reads your legacy Snort conf file(s) and generates Snort++ Lua
and rules files.  When running this program, the only mandatory option is
to provide Snort2Lua with a Snort configuration file. The default output
file file is snort.lua, the default error file will be snort.rej, and the
default rule file is the output file (default is snort.lua).  When
Snort2Lua finishes running, the resulting configuration file can be
successfully run as the Snort++ configuration file.  The sole exception to
this rule is when Snort2Lua cannot find an included file.  If that occurs,
the file will still be included in the output file and you will need to
manually adjust or comment the file name. Additionally, if the exit code is
not zero, some of the information may not be successfully converted.  Check
the error file for all of the conversion problems.</p></div>
<div class="paragraph"><p>Those errors can occur for a multitude of reasons and are not necessarily
bad.  For instance, Snort2Lua will only convert preprocessors that are
currently supported. Therefore, any unsupported preprocessors or
configuration options including DCERP, SIP, and SMTP, will cause an error
in Snort2Lua since Snort++ does not support those preprocessors.
Additionally, any rule options associated with those preprocessors are also
not supported.  Finally, Snort2Lua expects a valid Snort configuration.
Therefore, if the configuration is invalid or has questionable syntax,
Snort2Lua may find those errors and fail to parse the configuration file.</p></div>
<div class="paragraph"><p>There are a also few peculiarities of Snort2Lua that may be confusing to a
first time user. Specifically, aside from an initial configuration file
(which is specified from the command line or as the file in config
binding), every file that is included into Snort++ must be either a Lua
file or a rule file; the file cannot contain both rules and Lua syntax.
Therefore, when parsing a file specified with the include command,
Snort2Lua will output both a Lua file and a rule file.  Additionally, any
line that is a comment in a configuration file will be added in to a
comments section at the bottom of the main configuration file.  Finally,
rules that contain unsupported options will be converted to the best of
Snort2Luas capability and then printed as a comment in the rule file.</p></div>
<div class="sect2">
<h3 id="_snort2lua_command_line">Snort2Lua Command Line</h3>
<div class="paragraph"><p>By default, Snort2Lua will attempt to parse every include file and every
binding file.  There is an option to change this functionality.</p></div>
<div class="paragraph"><p>When specifying a rule file with one of the command line options, Snort2Lua
will output all of the converted rules to that specified rule file.
This is especially useful when you are only interesting in
converting rules since there is no Lua syntax in rule files.  There is also
an option that tells Snort2Lua to output every rule for a given
configuration into a single rule file.  Similarly, there is an option
pull all of the Lua syntax from every include file into the output file.</p></div>
<div class="paragraph"><p>There are currently three output modes: default, quiet, and differences.
As expected, quiet mode produces a Snort++ configuration.  All errors
(aside from Fatal Snort2Lua errors), differences, and comments will omitted
from the final output file.  Default mode will print everything. That mean
you will be able to see exactly what changes have occurred between Snort and
Snort++ in addition to the new syntax, the original file&#8217;s comments, and
all errors that have occurred.  Finally, differences mode will not actually
output a valid Snort++ configuration.  Instead, you can see the exact
options from the input configuration that have changed.</p></div>
<div class="sect3">
<h4 id="_usage_snort2lua_options_8230_c_lt_snort_conf_gt_8230">Usage: snort2lua [OPTIONS]&#8230; -c &lt;snort_conf&gt; &#8230;</h4>
<div class="paragraph"><p>Converts the Snort configuration file specified by the -c or --conf-file
options into a Snort++ configuration file</p></div>
<div class="sect4">
<h5 id="_options">Options:</h5>
<div class="ulist"><ul>
<li>
<p>
<strong>-?</strong>                show usage
</p>
</li>
<li>
<p>
<strong>-h</strong>                this overview of snort2lua
</p>
</li>
<li>
<p>
<strong>-a</strong>                print all data, including errors and Snort - Snort++
                    configuration differences.
</p>
</li>
<li>
<p>
<strong>-c &lt;snort_conf&gt;</strong>   The Snort &lt;snort_conf&gt; file to convert
</p>
</li>
<li>
<p>
<strong>-d</strong>                print the differences, and only the differences, between the
                    Snort and Snort++ configurations
</p>
</li>
<li>
<p>
<strong>-e &lt;error_file&gt;</strong>   output all errors to &lt;error_file&gt;
</p>
</li>
<li>
<p>
<strong>-i</strong>                if &lt;snort_conf&gt; file contains any &lt;include_file&gt; or
                    &lt;policy_file&gt; (i.e. <em>include path/to/conf/other_conf</em>), do
                    NOT parse those files
</p>
</li>
<li>
<p>
<strong>-m</strong>                add a remark to the end of every converted rule
</p>
</li>
<li>
<p>
<strong>-o &lt;out_file&gt;</strong>     output the new Snort++ lua configuration to &lt;out_file&gt;
</p>
</li>
<li>
<p>
<strong>-q</strong>                quiet mode. Only output valid confiration information
</p>
</li>
<li>
<p>
<strong>-r &lt;rule_file&gt;</strong>    output any converted rule to &lt;rule_file&gt;
</p>
</li>
<li>
<p>
<strong>-s</strong>                when parsing &lt;include_file&gt;, write &lt;include_file&gt;'s rules to
                    &lt;rule_file&gt;. Meaningles if <em>-i</em> provided
</p>
</li>
<li>
<p>
<strong>-t</strong>                when parsing &lt;include_file&gt;, write &lt;include_file&gt;'s
                    information, excluding rules, to &lt;out_file&gt;. Meaningles if
                    <em>-i</em> provided
</p>
</li>
<li>
<p>
<strong>-V</strong>                Print the current Snort2Lua version
</p>
</li>
<li>
<p>
<strong>--conf-file</strong>       Same as <em>-c</em>. A Snort &lt;snort_conf&gt; file which will be
                    converted
</p>
</li>
<li>
<p>
<strong>--dont-parse-includes</strong>
                    Same as <em>-p</em>. if &lt;snort_conf&gt; file contains any
                    &lt;include_file&gt; or &lt;policy_file&gt; (i.e. <em>include
                    path/to/conf/other_conf</em>), do NOT parse those files
</p>
</li>
<li>
<p>
<strong>--error-file=&lt;error_file&gt;</strong>
                    Same as <em>-e</em>. output all errors to &lt;error_file&gt;
</p>
</li>
<li>
<p>
<strong>--help</strong>            Same as <em>-h</em>. this overview of snort2lua
</p>
</li>
<li>
<p>
<strong>--markup</strong>          print help in asciidoc compatible format
</p>
</li>
<li>
<p>
<strong>--output-file=&lt;out_file&gt;</strong>
                    Same as <em>-o</em>. output the new Snort++ lua configuration to
                    &lt;out_file&gt;
</p>
</li>
<li>
<p>
<strong>--print-all</strong>       Same as <em>-a</em>. print all data, including errors, Snort -
                    Snort++ configuration differences, and developer warnings.
</p>
</li>
<li>
<p>
<strong>--print-differences</strong>  Same as <em>-d</em>. print the differences, and only the
                    differences, between the Snort and Snort++ configurations
</p>
</li>
<li>
<p>
<strong>--quiet</strong>           Same as <em>-q</em>. quiet mode. Only output valid confiration
                    information
</p>
</li>
<li>
<p>
<strong>--remark</strong>          same as <em>-m</em>.  add a remark to the end of every converted
                    rule
</p>
</li>
<li>
<p>
<strong>--rule-file=&lt;rule_file&gt;</strong>
                    Same as <em>-r</em>. output any converted rule to &lt;rule_file&gt;
</p>
</li>
<li>
<p>
<strong>--single-conf-file</strong>  Same as <em>-t</em>. when parsing &lt;include_file&gt;, write
                    &lt;include_file&gt;'s information, excluding rules, to
                    &lt;out_file&gt;
</p>
</li>
<li>
<p>
<strong>--single-rule-file</strong>  Same as <em>-s</em>. when parsing &lt;include_file&gt;, write
                    &lt;include_file&gt;'s rules to &lt;rule_file&gt;.
</p>
</li>
<li>
<p>
<strong>--version</strong>         Same as <em>-V</em>. Print the current Snort2Lua version
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_required_option">Required option:</h5>
<div class="ulist"><ul>
<li>
<p>
A Snort configuration file to convert. Set with either <em>-c</em> or <em>--conf-file</em>
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_default_values">Default values:</h5>
<div class="ulist"><ul>
<li>
<p>
&lt;out_file&gt;   =  snort.lua
</p>
</li>
<li>
<p>
&lt;rule_file&gt;  =  &lt;out_file&gt; = snort.lua.  Rules are written to the <em>local_rules</em> variable in the &lt;out_file&gt;
</p>
</li>
<li>
<p>
&lt;error_file&gt; =  snort.rej.  This file will not be created in quiet mode.
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_known_problems">Known Problems</h3>
<div class="ulist"><ul>
<li>
<p>
Any Snort string which is dependent on a variable will no longer have
that variable in the Lua string.
</p>
</li>
<li>
<p>
Snort2Lua currently does not handle variables well. First, that means
variables will not always be parsed correctly.  Second, sometimes a
variables value will be outoput in the lua file rather than a variable
For instance, if Snort2Lua attempted to convert the line
<em>include $RULE_PATH/example.rule</em>, the output may ouput
<em>include /etc/rules/example.rule</em> instead.
</p>
</li>
<li>
<p>
When Snort2Lua parses a binding configuration file, the rules and
configuration will automatically be combined into the same file.  Also, the
new files name will automatically become the old files name with a .lua
extension.  There is currently no way to specify or change that files name.
</p>
</li>
<li>
<p>
If a rule&#8217;s action is a custom ruletype, that rule action will be silently
converted to the rultype&#8217;s <em>type</em>. No warnings or errors are currently
emmitted. Additionally, the custom ruletypes outputs will be silently
discarded.
</p>
</li>
</ul></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reference_2">Reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_terminology">Terminology</h3>
<div class="ulist"><ul>
<li>
<p>
<strong>basic module</strong>: a module integrated into Snort that does not come from a
  plugin.
</p>
</li>
<li>
<p>
<strong>binder</strong>: inspector that maps configuration to traffic
</p>
</li>
<li>
<p>
<strong>builtin rules</strong>: codec and inspector rules for anomalies detected
  internally.
</p>
</li>
<li>
<p>
<strong>codec</strong>: short for coder / decoder.  These plugins are used for basic
   protocol decoding, anomaly detection, and construction of active responses.
</p>
</li>
<li>
<p>
<strong>data module</strong>: an adjunct configuration plugin for use with certain inspectors.
</p>
</li>
<li>
<p>
<strong>dynamic rules</strong>: plugin rules loaded at runtime.  See SO rules.
</p>
</li>
<li>
<p>
<strong>fast pattern</strong>: the content in an IPS rule that must be found by the
  search engine in order for a rule to be evaluated.
</p>
</li>
<li>
<p>
<strong>fast pattern matcher</strong>: see search engine.
</p>
</li>
<li>
<p>
<strong>hex</strong>: a type of protocol magic that the wizard uses to identify binary
  protocols.
</p>
</li>
<li>
<p>
<strong>inspector</strong>: plugin that processes packets (similar to the legacy Snort
  preprocessor)
</p>
</li>
<li>
<p>
<strong>IPS</strong>:  intrusion prevention system, like Snort.
</p>
</li>
<li>
<p>
<strong>IPS action</strong>: plugin that allows you to perform custom actions when
  events are generated.  Unlike loggers, these are invoked before
  thresholding and can be used to control external agents or send active
  responses.
</p>
</li>
<li>
<p>
<strong>IPS option</strong>: this plugin is the building blocks of IPS rules.
</p>
</li>
<li>
<p>
<strong>logger</strong>: a plugin that performs output of events and packets.  Events
  are thresholded before reaching loggers.
</p>
</li>
<li>
<p>
<strong>module</strong>: the user facing portion of a Snort component.  Modules chiefly
  provide configuration parameters, but may also provide commands, builtin
  rules, profiling statistics, peg counts, etc.  Note that not all modules
  are plugins and not all plugins have modules.
</p>
</li>
<li>
<p>
<strong>peg count</strong>: the number of times a given event or condition occurs.
</p>
</li>
<li>
<p>
<strong>plugin</strong>: one of several types of software components that can be loaded
  from a dynamic library when Snort starts up.  Some plugins are coupled
  with the main engine in such a way that they must be built statically,
  but a newer version can be loaded dynamically.
</p>
</li>
<li>
<p>
<strong>search engine</strong>: a plugin that performs multipattern searching of packets
  and payload to find rules that should be evaluated.  There are currently
  no specific modules, although there are several search engine plugins.
  Related configuration is done with the basic detection module.  Aka fast
  pattern matcher.
</p>
</li>
<li>
<p>
<strong>SO rule</strong>: a IPS rule plugin that performs custom detection that can&#8217;t
  be done by a text rule.  These rules typically do not have associated
  modules.  SO comes from shared object, meaning dynamic library.
</p>
</li>
<li>
<p>
<strong>spell</strong>: a type of protocol magic that the wizard uses to identify ASCII
  protocols.
</p>
</li>
<li>
<p>
<strong>text rule</strong>: a rule loaded from the configuration that has a header and
  body.  The header specifies action, protocol, source and destination IP
  addresses and ports, and direction.  The body specifies detection and
  non-detection options.
</p>
</li>
<li>
<p>
<strong>wizard</strong>: inspector that applies protocol magic to determine which
  inspectors should be bound to traffic absent a port specific binding.
  See hex and spell.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_optional_features">Optional Features</h3>
<div class="paragraph"><p>Listed below are the features that must be explicitly enabled so they are built
into the Snort binary.  For a full list of build features, run ./configure
--help.</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>--enable-ppm</strong>: enable packet and rule performance monitoring and coarse
   latency enforcement.
</p>
</li>
<li>
<p>
<strong>--enable-perf-profiling</strong>: enable module and rule performance profiling.
</p>
</li>
<li>
<p>
<strong>--enable-shell</strong>: enable local and remote command line shell support.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_environment_variables">Environment Variables</h3>
<div class="ulist"><ul>
<li>
<p>
<strong>HOSTTYPE</strong>: optional string that is output with the version at end of
  line.
</p>
</li>
<li>
<p>
<strong>LUA_PATH</strong>: you must export as follows so LuaJIT can find required
  files.
</p>
<div class="literalblock">
<div class="content">
<pre><code>LUA_PATH=$install_dir/include/snort/lua/\?.lua\;\;</code></pre>
</div></div>
</li>
<li>
<p>
<strong>SNORT_IGNORE</strong>: the list of symbols Snort should ignore when parsing the
  Lua conf.  Unknown symbols not in SNORT_IGNORE will cause warnings with
  --warn-unknown or fatals with --warn-unknown --pedantic.
</p>
</li>
<li>
<p>
<strong>SNORT_LUA_PATH</strong>: an optional path where Snort can find supplemental conf
  files such as classification.lua.
</p>
</li>
<li>
<p>
<strong>SNORT_PROMPT</strong>: the character sequence that is printed at startup,
  shutdown, and in the shell.  The default is the mini-pig: o")~ .
</p>
</li>
<li>
<p>
<strong>SNORT_PLUGIN_PATH</strong>: an optional path where Snort can find supplemental
  shared libraries.  This is only used when Snort is building manuals.
  Modules in supplemental shared libraries will be added to the manuals.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_command_line_options">Command Line Options</h3>
<div class="ulist"><ul>
<li>
<p>
<strong>--alert-before-pass</strong> process alert, drop, sdrop, or reject before pass; default is pass before alert, drop,&#8230;
</p>
</li>
<li>
<p>
<strong>--bpf</strong> &lt;filter options&gt; are standard BPF options, as seen in TCPDump
</p>
</li>
<li>
<p>
<strong>--c2x</strong> output hex for given char
</p>
</li>
<li>
<p>
<strong>--create-pidfile</strong> create PID file, even when not in Daemon mode
</p>
</li>
<li>
<p>
<strong>--daq</strong> &lt;type&gt; select packet acquisition module (default is pcap)
</p>
</li>
<li>
<p>
<strong>--daq-dir</strong> &lt;dir&gt; tell snort where to find desired DAQ
</p>
</li>
<li>
<p>
<strong>--daq-list</strong> list packet acquisition modules available in optional dir, default is static modules only
</p>
</li>
<li>
<p>
<strong>--daq-mode</strong> &lt;mode&gt; select the DAQ operating mode
</p>
</li>
<li>
<p>
<strong>--daq-var</strong> &lt;name=value&gt; specify extra DAQ configuration variable
</p>
</li>
<li>
<p>
<strong>--dirty-pig</strong> don&#8217;t flush packets on shutdown
</p>
</li>
<li>
<p>
<strong>--dump-builtin-rules</strong> [&lt;module prefix&gt;] output stub rules for selected modules
</p>
</li>
<li>
<p>
<strong>--dump-defaults</strong> [&lt;module prefix&gt;] output module defaults in Lua format
</p>
</li>
<li>
<p>
<strong>--dump-dynamic-rules</strong> output stub rules for all loaded rules libraries
</p>
</li>
<li>
<p>
<strong>--dump-version</strong> output the version, the whole version, and only the version
</p>
</li>
<li>
<p>
<strong>--enable-inline-test</strong> enable Inline-Test Mode Operation
</p>
</li>
<li>
<p>
<strong>--help</strong> list command line options
</p>
</li>
<li>
<p>
<strong>--help-commands</strong> [&lt;module prefix&gt;] output matching commands
</p>
</li>
<li>
<p>
<strong>--help-config</strong> [&lt;module prefix&gt;] output matching config options
</p>
</li>
<li>
<p>
<strong>--help-counts</strong> [&lt;module prefix&gt;] output matching peg counts
</p>
</li>
<li>
<p>
<strong>--help-module</strong> &lt;module&gt; output description of given module
</p>
</li>
<li>
<p>
<strong>--help-modules</strong> list all available modules with brief help
</p>
</li>
<li>
<p>
<strong>--help-options</strong> &lt;option prefix&gt; output matching command line option quick help (same as -?)
</p>
</li>
<li>
<p>
<strong>--help-plugins</strong> list all available plugins with brief help
</p>
</li>
<li>
<p>
<strong>--help-signals</strong> dump available control signals
</p>
</li>
<li>
<p>
<strong>--id-subdir</strong> create/use instance subdirectories in logdir instead of instance filename prefix
</p>
</li>
<li>
<p>
<strong>--id-zero</strong> use id prefix / subdirectory even with one packet thread
</p>
</li>
<li>
<p>
<strong>--list-buffers</strong> output available inspection buffers
</p>
</li>
<li>
<p>
<strong>--list-builtin</strong> &lt;module prefix&gt; output matching builtin rules
</p>
</li>
<li>
<p>
<strong>--list-gids</strong> [&lt;module prefix&gt;] output matching generators
</p>
</li>
<li>
<p>
<strong>--list-modules</strong> [&lt;module type&gt;] list all known modules of given type
</p>
</li>
<li>
<p>
<strong>--list-plugins</strong> list all known plugins
</p>
</li>
<li>
<p>
<strong>--logid</strong> &lt;0xid&gt; log Identifier to uniquely id events for multiple snorts (same as -G)
</p>
</li>
<li>
<p>
<strong>--lua</strong> &lt;chunk&gt; extend/override conf with chunk; may be repeated
</p>
</li>
<li>
<p>
<strong>--markup</strong> output help in asciidoc compatible format
</p>
</li>
<li>
<p>
<strong>--max-packet-threads</strong> &lt;count&gt; configure maximum number of packet threads (same as -z)
</p>
</li>
<li>
<p>
<strong>--nolock-pidfile</strong> do not try to lock Snort PID file
</p>
</li>
<li>
<p>
<strong>--nostamps</strong> don&#8217;t include timestamps in log file names
</p>
</li>
<li>
<p>
<strong>--pause</strong> wait for resume/quit command before processing packets/terminating
</p>
</li>
<li>
<p>
<strong>--pcap-dir</strong> &lt;dir&gt; a directory to recurse to look for pcaps - read mode is implied
</p>
</li>
<li>
<p>
<strong>--pcap-file</strong> &lt;file&gt; file that contains a list of pcaps to read - read mode is implied
</p>
</li>
<li>
<p>
<strong>--pcap-filter</strong> &lt;filter&gt; filter to apply when getting pcaps from file or directory
</p>
</li>
<li>
<p>
<strong>--pcap-list</strong> &lt;list&gt; a space separated list of pcaps to read - read mode is implied
</p>
</li>
<li>
<p>
<strong>--pcap-loop</strong> &lt;count&gt; read all pcaps &lt;count&gt; times;  0 will read until Snort is terminated
</p>
</li>
<li>
<p>
<strong>--pcap-no-filter</strong> reset to use no filter when getting pcaps from file or directory
</p>
</li>
<li>
<p>
<strong>--pcap-reload</strong> if reading multiple pcaps, reload snort config between pcaps
</p>
</li>
<li>
<p>
<strong>--pcap-reset</strong> ignored - for REG_TEST only
</p>
</li>
<li>
<p>
<strong>--pcap-show</strong> print a line saying what pcap is currently being read
</p>
</li>
<li>
<p>
<strong>--pedantic</strong> warnings are fatal
</p>
</li>
<li>
<p>
<strong>--plugin-path</strong> &lt;path&gt; where to find plugins
</p>
</li>
<li>
<p>
<strong>--process-all-events</strong> process all action groups
</p>
</li>
<li>
<p>
<strong>--rule</strong> &lt;rules&gt; to be added to configuration; may be repeated
</p>
</li>
<li>
<p>
<strong>--rule-to-hex</strong> output so rule header to stdout for text rule on stdin
</p>
</li>
<li>
<p>
<strong>--rule-to-text</strong> output plain so rule header to stdout for text rule on stdin
</p>
</li>
<li>
<p>
<strong>--run-prefix</strong> &lt;pfx&gt; prepend this to each output file
</p>
</li>
<li>
<p>
<strong>--script-path</strong> &lt;path&gt; where to find luajit scripts
</p>
</li>
<li>
<p>
<strong>--shell</strong> enable the interactive command line
</p>
</li>
<li>
<p>
<strong>--show-plugins</strong> list module and plugin versions
</p>
</li>
<li>
<p>
<strong>--skip</strong> &lt;n&gt; skip 1st n packets
</p>
</li>
<li>
<p>
<strong>--snaplen</strong> &lt;snap&gt; set snaplen of packet (same as -s)
</p>
</li>
<li>
<p>
<strong>--stdin-rules</strong> read rules from stdin until EOF or a line starting with END is read
</p>
</li>
<li>
<p>
<strong>--treat-drop-as-alert</strong> converts drop, sdrop, and reject rules into alert rules during startup
</p>
</li>
<li>
<p>
<strong>--treat-drop-as-ignore</strong> use drop, sdrop, and reject rules to ignore session traffic when not inline
</p>
</li>
<li>
<p>
<strong>--version</strong> show version number (same as -V)
</p>
</li>
<li>
<p>
<strong>--warn-all</strong> enable all warnings
</p>
</li>
<li>
<p>
<strong>--warn-flowbits</strong> warn about flowbits that are checked but not set and vice-versa
</p>
</li>
<li>
<p>
<strong>--warn-unknown</strong> warn about unknown symbols in your config
</p>
</li>
<li>
<p>
<strong>--x2c</strong> output ASCII char for given hex
</p>
</li>
<li>
<p>
<strong>-?</strong> &lt;option prefix&gt; output matching command line option quick help (same as --help-options)
</p>
</li>
<li>
<p>
<strong>-A</strong> &lt;mode&gt; set alert mode: none, cmg, or alert_*
</p>
</li>
<li>
<p>
<strong>-B</strong> &lt;mask&gt; obfuscated IP addresses in alerts and packet dumps using CIDR mask
</p>
</li>
<li>
<p>
<strong>-C</strong> print out payloads with character data only (no hex)
</p>
</li>
<li>
<p>
<strong>-D</strong> run Snort in background (daemon) mode
</p>
</li>
<li>
<p>
<strong>-E</strong> enable daemon restart
</p>
</li>
<li>
<p>
<strong>-G</strong> &lt;0xid&gt; (same as --logid)
</p>
</li>
<li>
<p>
<strong>-H</strong> make hash tables deterministic
</p>
</li>
<li>
<p>
<strong>-K</strong> &lt;mode&gt; logging mode
</p>
</li>
<li>
<p>
<strong>-M</strong> log messages to syslog (not alerts)
</p>
</li>
<li>
<p>
<strong>-N</strong> ignored - for REG_TEST only
</p>
</li>
<li>
<p>
<strong>-O</strong> obfuscate the logged IP addresses
</p>
</li>
<li>
<p>
<strong>-Q</strong> enable inline mode operation
</p>
</li>
<li>
<p>
<strong>-R</strong> &lt;rules&gt; include this rules file in the default policy
</p>
</li>
<li>
<p>
<strong>-S</strong> &lt;n=v&gt; set rules file variable n equal to value v
</p>
</li>
<li>
<p>
<strong>-T</strong> test and report on the current Snort configuration
</p>
</li>
<li>
<p>
<strong>-U</strong> use UTC for timestamps
</p>
</li>
<li>
<p>
<strong>-V</strong> (same as --version)
</p>
</li>
<li>
<p>
<strong>-W</strong> lists available interfaces
</p>
</li>
<li>
<p>
<strong>-X</strong> dump the raw packet data starting at the link layer
</p>
</li>
<li>
<p>
<strong>-c</strong> &lt;conf&gt; use this configuration
</p>
</li>
<li>
<p>
<strong>-d</strong> dump the Application Layer
</p>
</li>
<li>
<p>
<strong>-e</strong> display the second layer header info
</p>
</li>
<li>
<p>
<strong>-f</strong> turn off fflush() calls after binary log writes
</p>
</li>
<li>
<p>
<strong>-g</strong> &lt;gname&gt; run snort gid as &lt;gname&gt; group (or gid) after initialization
</p>
</li>
<li>
<p>
<strong>-i</strong> &lt;iface&gt;&#8230; list of interfaces
</p>
</li>
<li>
<p>
<strong>-j</strong> &lt;port&gt; to listen for telnet connections
</p>
</li>
<li>
<p>
<strong>-k</strong> &lt;mode&gt; checksum mode (all,noip,notcp,noudp,noicmp,none)
</p>
</li>
<li>
<p>
<strong>-l</strong> &lt;logdir&gt; log to this directory instead of current directory
</p>
</li>
<li>
<p>
<strong>-m</strong> &lt;umask&gt; set umask = &lt;umask&gt;
</p>
</li>
<li>
<p>
<strong>-n</strong> &lt;count&gt; stop after count packets
</p>
</li>
<li>
<p>
<strong>-q</strong> quiet mode - Don&#8217;t show banner and status report
</p>
</li>
<li>
<p>
<strong>-r</strong> &lt;pcap&gt;&#8230; (same as --pcap-list)
</p>
</li>
<li>
<p>
<strong>-s</strong> &lt;snap&gt; (same as --snaplen)
</p>
</li>
<li>
<p>
<strong>-t</strong> &lt;dir&gt; chroots process to &lt;dir&gt; after initialization
</p>
</li>
<li>
<p>
<strong>-u</strong> &lt;uname&gt; run snort as &lt;uname&gt; or &lt;uid&gt; after initialization
</p>
</li>
<li>
<p>
<strong>-v</strong> be verbose
</p>
</li>
<li>
<p>
<strong>-w</strong> dump 802.11 management and control frames
</p>
</li>
<li>
<p>
<strong>-x</strong> same as --pedantic
</p>
</li>
<li>
<p>
<strong>-y</strong> include year in timestamp in the alert and log files
</p>
</li>
<li>
<p>
<strong>-z</strong> &lt;count&gt; maximum number of packet threads (same as --max-packet-threads)
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_parameters">Parameters</h3>
<div class="paragraph"><p>Parameters are given with this format:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>type name = default: help { range }</code></pre>
</div></div>
<div class="paragraph"><p>The following types are used:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>addr</strong>: any valid IP4 or IP6 address or CIDR
</p>
</li>
<li>
<p>
<strong>addr_list</strong>: a space separated list of addr values
</p>
</li>
<li>
<p>
<strong>bit_list</strong>: a list of consecutive integer values from 1 to the range
  maximum
</p>
</li>
<li>
<p>
<strong>bool</strong>: true or false
</p>
</li>
<li>
<p>
<strong>enum</strong>: a string selected from the given range
</p>
</li>
<li>
<p>
<strong>implied</strong>: a IPS rule option that takes no value but means true
</p>
</li>
<li>
<p>
<strong>int</strong>: a whole number in the given range
</p>
</li>
<li>
<p>
<strong>ip4</strong>: an IP4 address or CIDR
</p>
</li>
<li>
<p>
<strong>mac</strong>: an ethernet address with the form 01:02:03:04:05:06
</p>
</li>
<li>
<p>
<strong>multi</strong>: one or more space separated strings from the given range
</p>
</li>
<li>
<p>
<strong>port</strong>: an int in the range 0:65535 indicating a TCP or UDP port number
</p>
</li>
<li>
<p>
<strong>real</strong>: a real number in the given range
</p>
</li>
<li>
<p>
<strong>select</strong>: a string selected from the given range
</p>
</li>
</ul></div>
<div class="paragraph"><p>The parameter name may be adorned in various ways to indicate additional
information about the type and use of the parameter:</p></div>
<div class="ulist"><ul>
<li>
<p>
For Lua configuration (not IPS rules), if the name ends with [] it is
  a list item and can be repeated.
</p>
</li>
<li>
<p>
For IPS rules only, names starting with ~ indicate positional
  parameters.  The names of such parameters do not appear in the rule.
</p>
</li>
<li>
<p>
IPS rules may also have a wild card parameter, which is indicated by a
  *.  Only used for metadata that Snort ignores.
</p>
</li>
<li>
<p>
The snort module has command line options starting with a -.
</p>
</li>
</ul></div>
<div class="paragraph"><p>Some additional details to note:</p></div>
<div class="ulist"><ul>
<li>
<p>
Table and variable names are case sensitive; use lower case only.
</p>
</li>
<li>
<p>
String values are case sensitive too; use lower case only.
</p>
</li>
<li>
<p>
Numeric ranges may be of the form low:high where low and high are
  bounds included in the range.  If either is omitted, there is no hard
  bound. E.g. 0: means any x where x &gt;= 0.
</p>
</li>
<li>
<p>
Strings may have a numeric range indicating a length limit; otherwise
  there is no hard limit.
</p>
</li>
<li>
<p>
bit_list is typically used to store a set of byte, port, or VLAN ID
  values.
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_configuration_2">Configuration</h3>
<div class="ulist"><ul>
<li>
<p>
string <strong>ack.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
int <strong>active.attempts</strong> = 0: number of TCP packets sent per response (with varying sequence numbers) { 0:20 }
</p>
</li>
<li>
<p>
string <strong>active.device</strong>: use <em>ip</em> for network layer responses or <em>eth0</em> etc for link layer
</p>
</li>
<li>
<p>
string <strong>active.dst_mac</strong>: use format <em>01:23:45:67:89:ab</em>
</p>
</li>
<li>
<p>
int <strong>active.max_responses</strong> = 0: maximum number of responses { 0: }
</p>
</li>
<li>
<p>
int <strong>active.min_interval</strong> = 255: minimum number of seconds between responses { 1: }
</p>
</li>
<li>
<p>
multi <strong>alert_csv.csv</strong> = timestamp gid sid rev src_addr src_port dst_addr dst_port: selected fields will be output in given order left to right { timestamp | gid | sid | rev | msg | proto | src_addr | dst_addr | src_port | dst_port | eth_src | eth_dst | eth_type | eth_len | ttl | tos | id | ip_len | dgm_len | icmp_type | icmp_code | icmp_id | icmp_seq | tcp_flags | tcp_seq | tcp_ack | tcp_len | tcp_win | udp_len }
</p>
</li>
<li>
<p>
bool <strong>alert_csv.file</strong> = false: output to alert_csv.txt instead of stdout
</p>
</li>
<li>
<p>
int <strong>alert_csv.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
enum <strong>alert_csv.units</strong> = B: bytes | KB | MB | GB { B | K | M | G }
</p>
</li>
<li>
<p>
bool <strong>alert_fast.file</strong> = false: output to alert_fast.txt instead of stdout
</p>
</li>
<li>
<p>
int <strong>alert_fast.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
bool <strong>alert_fast.packet</strong> = false: output packet dump with alert
</p>
</li>
<li>
<p>
enum <strong>alert_fast.units</strong> = B: bytes | KB | MB | GB { B | K | M | G }
</p>
</li>
<li>
<p>
bool <strong>alert_full.file</strong> = false: output to alert_full.txt instead of stdout
</p>
</li>
<li>
<p>
int <strong>alert_full.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
enum <strong>alert_full.units</strong> = B: limit is in bytes | KB | MB | GB { B | K | M | G }
</p>
</li>
<li>
<p>
enum <strong>alert_syslog.facility</strong> = auth: part of priority applied to each message { auth | authpriv | daemon | user | local0 | local1 | local2 | local3 | local4 | local5 | local6 | local7 }
</p>
</li>
<li>
<p>
enum <strong>alert_syslog.level</strong> = info: part of priority applied to each message { emerg | alert | crit | err | warning | notice | info | debug }
</p>
</li>
<li>
<p>
multi <strong>alert_syslog.options</strong>: used to open the syslog connection { cons | ndelay | perror | pid }
</p>
</li>
<li>
<p>
bool <strong>alert_test.file</strong> = false: output to alert_test.txt instead of stdout
</p>
</li>
<li>
<p>
bool <strong>alert_test.msg</strong> = false: include alert msg
</p>
</li>
<li>
<p>
bool <strong>alert_test.rebuilt</strong> = false: include type:count where type is S for stream and F for frag
</p>
</li>
<li>
<p>
bool <strong>alert_test.session</strong> = false: include src-dst each of form -addr:port
</p>
</li>
<li>
<p>
bool <strong>alerts.alert_with_interface_name</strong> = false: include interface in alert info (fast, full, or syslog only)
</p>
</li>
<li>
<p>
bool <strong>alerts.default_rule_state</strong> = true: enable or disable ips rules
</p>
</li>
<li>
<p>
int <strong>alerts.detection_filter_memcap</strong> = 1048576: set available memory for filters { 0: }
</p>
</li>
<li>
<p>
int <strong>alerts.event_filter_memcap</strong> = 1048576: set available memory for filters { 0: }
</p>
</li>
<li>
<p>
int <strong>alerts.flowbits_size</strong> = 1024: maximum number of allowed unique flowbits { 0:2048 }
</p>
</li>
<li>
<p>
string <strong>alerts.order</strong> = pass drop alert log: change the order of rule action application
</p>
</li>
<li>
<p>
int <strong>alerts.rate_filter_memcap</strong> = 1048576: set available memory for filters { 0: }
</p>
</li>
<li>
<p>
string <strong>alerts.reference_net</strong>: set the CIDR for homenet (for use with -l or -B, does NOT change $HOME_NET in IDS mode)
</p>
</li>
<li>
<p>
bool <strong>alerts.stateful</strong> = false: don&#8217;t alert w/o established session (note: rule action still taken)
</p>
</li>
<li>
<p>
string <strong>alerts.tunnel_verdicts</strong>: let DAQ handle non-allow verdicts for GTP|Teredo|6in4|4in6 traffic
</p>
</li>
<li>
<p>
ip4 <strong>arp_spoof.hosts[].ip</strong>: host ip address
</p>
</li>
<li>
<p>
mac <strong>arp_spoof.hosts[].mac</strong>: host mac address
</p>
</li>
<li>
<p>
int <strong>asn1.absolute_offset</strong>: Absolute offset from the beginning of the packet. { 0: }
</p>
</li>
<li>
<p>
implied <strong>asn1.bitstring_overflow</strong>: Detects invalid bitstring encodings that are known to be remotely exploitable.
</p>
</li>
<li>
<p>
implied <strong>asn1.double_overflow</strong>: Detects a double ASCII encoding that is larger than a standard buffer.
</p>
</li>
<li>
<p>
int <strong>asn1.oversize_length</strong>: Compares ASN.1 type lengths with the supplied argument. { 0: }
</p>
</li>
<li>
<p>
implied <strong>asn1.print</strong>: &lt;&gt;max | &lt;max | &gt;min
</p>
</li>
<li>
<p>
int <strong>asn1.relative_offset</strong>: relative offset from the cursor.
</p>
</li>
<li>
<p>
int <strong>attribute_table.max_hosts</strong> = 1024: maximum number of hosts in attribute table { 32:207551 }
</p>
</li>
<li>
<p>
int <strong>attribute_table.max_metadata_services</strong> = 8: maximum number of services in rule metadata { 1:256 }
</p>
</li>
<li>
<p>
int <strong>attribute_table.max_services_per_host</strong> = 8: maximum number of services per host entry in attribute table { 1:65535 }
</p>
</li>
<li>
<p>
int <strong>base64_decode.bytes</strong>: Number of base64 encoded bytes to decode. { 1: }
</p>
</li>
<li>
<p>
int <strong>base64_decode.offset</strong>: Bytes past start of buffer to start decoding. { 0: }
</p>
</li>
<li>
<p>
implied <strong>base64_decode.relative</strong>: Apply offset to cursor instead of start of buffer.
</p>
</li>
<li>
<p>
enum <strong>binder[].use.action</strong> = inspect: what to do with matching traffic { block | allow | inspect }
</p>
</li>
<li>
<p>
string <strong>binder[].use.file</strong>: use configuration in given file
</p>
</li>
<li>
<p>
string <strong>binder[].use.name</strong> = defaults to type: symbol name
</p>
</li>
<li>
<p>
string <strong>binder[].use.service</strong>: override automatic service identification
</p>
</li>
<li>
<p>
string <strong>binder[].use.type</strong>: select module for binding
</p>
</li>
<li>
<p>
bit_list <strong>binder[].when.ifaces</strong>: list of interface indices { 255 }
</p>
</li>
<li>
<p>
addr_list <strong>binder[].when.nets</strong>: list of networks
</p>
</li>
<li>
<p>
int <strong>binder[].when.policy_id</strong>: unique ID for selection of this config by external logic { 0: }
</p>
</li>
<li>
<p>
bit_list <strong>binder[].when.ports</strong>: list of ports { 65535 }
</p>
</li>
<li>
<p>
enum <strong>binder[].when.proto</strong>: protocol { any | ip | icmp | tcp | udp }
</p>
</li>
<li>
<p>
enum <strong>binder[].when.role</strong> = any: use the given configuration on one or any end of a session { client | server | any }
</p>
</li>
<li>
<p>
string <strong>binder[].when.service</strong>: override default configuration
</p>
</li>
<li>
<p>
bit_list <strong>binder[].when.vlans</strong>: list of VLAN IDs { 4095 }
</p>
</li>
<li>
<p>
string <strong>bufferlen.~range</strong>: len | min&lt;&gt;max | &lt;max | &gt;min
</p>
</li>
<li>
<p>
int <strong>byte_extract.align</strong>: round the number of converted bytes up to the next 2- or 4-byte boundary { 0:4 }
</p>
</li>
<li>
<p>
implied <strong>byte_extract.big</strong>: big endian
</p>
</li>
<li>
<p>
implied <strong>byte_extract.dce</strong>: dcerpc2 determines endianness
</p>
</li>
<li>
<p>
implied <strong>byte_extract.dec</strong>: convert from decimal string
</p>
</li>
<li>
<p>
implied <strong>byte_extract.hex</strong>: convert from hex string
</p>
</li>
<li>
<p>
implied <strong>byte_extract.little</strong>: little endian
</p>
</li>
<li>
<p>
int <strong>byte_extract.multiplier</strong>: scale extracted value by given amount { 1:65535 }
</p>
</li>
<li>
<p>
implied <strong>byte_extract.oct</strong>: convert from octal string
</p>
</li>
<li>
<p>
implied <strong>byte_extract.relative</strong>: offset from cursor instead of start of buffer
</p>
</li>
<li>
<p>
implied <strong>byte_extract.string</strong>: convert from string
</p>
</li>
<li>
<p>
int <strong>byte_extract.~count</strong>: number of bytes to pick up from the buffer { 1:10 }
</p>
</li>
<li>
<p>
string <strong>byte_extract.~name</strong>: name of the variable that will be used in other rule options
</p>
</li>
<li>
<p>
int <strong>byte_extract.~offset</strong>: number of bytes into the buffer to start processing { -65535:65535 }
</p>
</li>
<li>
<p>
int <strong>byte_jump.align</strong>: round the number of converted bytes up to the next 2- or 4-byte boundary { 0:4 }
</p>
</li>
<li>
<p>
implied <strong>byte_jump.big</strong>: big endian
</p>
</li>
<li>
<p>
implied <strong>byte_jump.dce</strong>: dcerpc2 determines endianness
</p>
</li>
<li>
<p>
implied <strong>byte_jump.dec</strong>: convert from decimal string
</p>
</li>
<li>
<p>
implied <strong>byte_jump.from_beginning</strong>: jump from start of buffer instead of cursor
</p>
</li>
<li>
<p>
implied <strong>byte_jump.hex</strong>: convert from hex string
</p>
</li>
<li>
<p>
implied <strong>byte_jump.little</strong>: little endian
</p>
</li>
<li>
<p>
int <strong>byte_jump.multiplier</strong>: scale extracted value by given amount { 1:65535 }
</p>
</li>
<li>
<p>
implied <strong>byte_jump.oct</strong>: convert from octal string
</p>
</li>
<li>
<p>
int <strong>byte_jump.post_offset</strong>: also skip forward or backwards (positive of negative value) this number of bytes { -65535:65535 }
</p>
</li>
<li>
<p>
implied <strong>byte_jump.relative</strong>: offset from cursor instead of start of buffer
</p>
</li>
<li>
<p>
implied <strong>byte_jump.string</strong>: convert from string
</p>
</li>
<li>
<p>
int <strong>byte_jump.~count</strong>: number of bytes to pick up from the buffer { 1:10 }
</p>
</li>
<li>
<p>
string <strong>byte_jump.~offset</strong>: variable name or number of bytes into the buffer to start processing
</p>
</li>
<li>
<p>
implied <strong>byte_test.big</strong>: big endian
</p>
</li>
<li>
<p>
implied <strong>byte_test.dce</strong>: dcerpc2 determines endianness
</p>
</li>
<li>
<p>
implied <strong>byte_test.dec</strong>: convert from decimal string
</p>
</li>
<li>
<p>
implied <strong>byte_test.hex</strong>: convert from hex string
</p>
</li>
<li>
<p>
implied <strong>byte_test.little</strong>: little endian
</p>
</li>
<li>
<p>
implied <strong>byte_test.oct</strong>: convert from octal string
</p>
</li>
<li>
<p>
implied <strong>byte_test.relative</strong>: offset from cursor instead of start of buffer
</p>
</li>
<li>
<p>
implied <strong>byte_test.string</strong>: convert from string
</p>
</li>
<li>
<p>
string <strong>byte_test.~compare</strong>: variable name or value to test the converted result against
</p>
</li>
<li>
<p>
int <strong>byte_test.~count</strong>: number of bytes to pick up from the buffer { 1:10 }
</p>
</li>
<li>
<p>
string <strong>byte_test.~offset</strong>: variable name or number of bytes into the payload to start processing
</p>
</li>
<li>
<p>
string <strong>byte_test.~operator</strong>: variable name or number of bytes into the buffer to start processing
</p>
</li>
<li>
<p>
string <strong>classifications[].name</strong>: name used with classtype rule option
</p>
</li>
<li>
<p>
int <strong>classifications[].priority</strong> = 1: default priority for class { 0: }
</p>
</li>
<li>
<p>
string <strong>classifications[].text</strong>: description of class
</p>
</li>
<li>
<p>
string <strong>classtype.~</strong>: classification for this rule
</p>
</li>
<li>
<p>
string <strong>content.depth</strong>: var or maximum number of bytes to search from beginning of buffer
</p>
</li>
<li>
<p>
string <strong>content.distance</strong>: var or number of bytes from cursor to start search
</p>
</li>
<li>
<p>
implied <strong>content.fast_pattern</strong>: use this content in the fast pattern matcher instead of the content selected by default
</p>
</li>
<li>
<p>
int <strong>content.fast_pattern_length</strong>: maximum number of characters from this content the fast pattern matcher should use
</p>
</li>
<li>
<p>
int <strong>content.fast_pattern_offset</strong>: number of leading characters of this content the fast pattern matcher should exclude
</p>
</li>
<li>
<p>
implied <strong>content.nocase</strong>: case insensitive match
</p>
</li>
<li>
<p>
string <strong>content.offset</strong>: var or number of bytes from start of buffer to start search
</p>
</li>
<li>
<p>
string <strong>content.within</strong>: var or maximum number of bytes to search from cursor
</p>
</li>
<li>
<p>
string <strong>content.~data</strong>: data to match
</p>
</li>
<li>
<p>
implied <strong>cvs.invalid-entry</strong>: looks for an invalid Entry string
</p>
</li>
<li>
<p>
bool <strong>daq.decode_data_link</strong> = false: display the second layer header info
</p>
</li>
<li>
<p>
string <strong>daq.dir</strong>: directory where to search for DAQ plugins
</p>
</li>
<li>
<p>
select <strong>daq.mode</strong>: set mode of operation { passive | inline | read-file }
</p>
</li>
<li>
<p>
bool <strong>daq.no_promisc</strong> = false: whether to put DAQ device into promiscuous mode
</p>
</li>
<li>
<p>
int <strong>daq.snaplen</strong> = deflt: set snap length (same as -P) { 0:65535 }
</p>
</li>
<li>
<p>
string <strong>daq.type</strong> = pcap: select type of DAQ
</p>
</li>
<li>
<p>
string <strong>daq.var</strong>: list of name=value DAQ-specific parameters
</p>
</li>
<li>
<p>
int <strong>detection.asn1</strong> = 256: maximum decode nodes { 1: }
</p>
</li>
<li>
<p>
bool <strong>detection.pcre_enable</strong> = true: disable pcre pattern matching
</p>
</li>
<li>
<p>
int <strong>detection.pcre_match_limit</strong> = 1500: limit pcre backtracking, -1 = max, 0 = off { -1:1000000 }
</p>
</li>
<li>
<p>
int <strong>detection.pcre_match_limit_recursion</strong> = 1500: limit pcre stack consumption, -1 = max, 0 = off { -1:10000 }
</p>
</li>
<li>
<p>
int <strong>detection_filter.count</strong>: hits in interval before allowing the rule to fire { 1: }
</p>
</li>
<li>
<p>
int <strong>detection_filter.seconds</strong>: length of interval to count hits { 1: }
</p>
</li>
<li>
<p>
enum <strong>detection_filter.track</strong>: track hits by source or destination IP address { by_src | by_dst }
</p>
</li>
<li>
<p>
string <strong>dsize.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
bool <strong>esp.decode_esp</strong> = false: enable for inspection of esp traffic that has authentication but not encryption
</p>
</li>
<li>
<p>
int <strong>event_filter[].count</strong> = 0: number of events in interval before tripping; -1 to disable { -1: }
</p>
</li>
<li>
<p>
int <strong>event_filter[].gid</strong> = 1: rule generator ID { 0: }
</p>
</li>
<li>
<p>
string <strong>event_filter[].ip</strong>: restrict filter to these addresses according to track
</p>
</li>
<li>
<p>
int <strong>event_filter[].seconds</strong> = 0: count interval { 0: }
</p>
</li>
<li>
<p>
int <strong>event_filter[].sid</strong> = 1: rule signature ID { 0: }
</p>
</li>
<li>
<p>
enum <strong>event_filter[].track</strong>: filter only matching source or destination addresses { by_src | by_dst }
</p>
</li>
<li>
<p>
enum <strong>event_filter[].type</strong>: 1st count events | every count events | once after count events { limit | threshold | both }
</p>
</li>
<li>
<p>
int <strong>event_queue.log</strong> = 3: maximum events to log { 1: }
</p>
</li>
<li>
<p>
int <strong>event_queue.max_queue</strong> = 8: maximum events to queue { 1: }
</p>
</li>
<li>
<p>
enum <strong>event_queue.order_events</strong> = content_length: criteria for ordering incoming events { priority|content_length }
</p>
</li>
<li>
<p>
bool <strong>event_queue.process_all_events</strong> = false: process just first action group or all action groups
</p>
</li>
<li>
<p>
int <strong>file_id.block_timeout</strong> = 86400: stop blocking after this many seconds { 0: }
</p>
</li>
<li>
<p>
bool <strong>file_id.block_timeout_lookup</strong> = false: block if lookup times out
</p>
</li>
<li>
<p>
bool <strong>file_id.enable_signature</strong> = false: enable signature calculation
</p>
</li>
<li>
<p>
bool <strong>file_id.enable_type</strong> = false: enable type ID
</p>
</li>
<li>
<p>
int <strong>file_id.lookup_timeout</strong> = 2: give up on lookup after this many seconds { 0: }
</p>
</li>
<li>
<p>
int <strong>file_id.show_data_depth</strong> = 100: print this many octets { 0: }
</p>
</li>
<li>
<p>
int <strong>file_id.signature_depth</strong> = 10485760: stop signature at this point { 0: }
</p>
</li>
<li>
<p>
int <strong>file_id.type_depth</strong> = 1460: stop type ID at this point { 0: }
</p>
</li>
<li>
<p>
string <strong>flags.~mask_flags</strong>: these flags are don&#8217;t cares
</p>
</li>
<li>
<p>
string <strong>flags.~test_flags</strong>: these flags are tested
</p>
</li>
<li>
<p>
implied <strong>flow.established</strong>: match only during data transfer phase
</p>
</li>
<li>
<p>
implied <strong>flow.from_client</strong>: same as to_server
</p>
</li>
<li>
<p>
implied <strong>flow.from_server</strong>: same as to_client
</p>
</li>
<li>
<p>
implied <strong>flow.no_frag</strong>: match on raw packets only
</p>
</li>
<li>
<p>
implied <strong>flow.no_stream</strong>: match on raw packets only
</p>
</li>
<li>
<p>
implied <strong>flow.not_established</strong>: match only outside data transfer phase
</p>
</li>
<li>
<p>
implied <strong>flow.only_frag</strong>: match on defragmented packets only
</p>
</li>
<li>
<p>
implied <strong>flow.only_stream</strong>: match on reassembled packets only
</p>
</li>
<li>
<p>
implied <strong>flow.stateless</strong>: match regardless of stream state
</p>
</li>
<li>
<p>
implied <strong>flow.to_client</strong>: match on server responses
</p>
</li>
<li>
<p>
implied <strong>flow.to_server</strong>: match on client requests
</p>
</li>
<li>
<p>
string <strong>flowbits.~arg1</strong>: bits or group
</p>
</li>
<li>
<p>
string <strong>flowbits.~arg2</strong>: group if arg1 is bits
</p>
</li>
<li>
<p>
string <strong>flowbits.~command</strong>: set|reset|isset|etc.
</p>
</li>
<li>
<p>
string <strong>fragbits.~flags</strong>: these flags are tested
</p>
</li>
<li>
<p>
string <strong>fragoffset.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
bool <strong>ftp_client.bounce</strong> = false: check for bounces
</p>
</li>
<li>
<p>
addr <strong>ftp_client.bounce_to[].address</strong> = 1.0.0.0/32: allowed ip address in CIDR format
</p>
</li>
<li>
<p>
port <strong>ftp_client.bounce_to[].last_port</strong>: optional allowed range from port to last_port inclusive { 0: }
</p>
</li>
<li>
<p>
port <strong>ftp_client.bounce_to[].port</strong> = 20: allowed port { 1: }
</p>
</li>
<li>
<p>
bool <strong>ftp_client.ignore_telnet_erase_cmds</strong> = false: ignore erase character and erase line commands when normalizing
</p>
</li>
<li>
<p>
int <strong>ftp_client.max_resp_len</strong> = -1: maximum ftp response accepted by client { -1: }
</p>
</li>
<li>
<p>
bool <strong>ftp_client.telnet_cmds</strong> = false: detect telnet escape sequences on ftp control channel
</p>
</li>
<li>
<p>
bool <strong>ftp_server.check_encrypted</strong> = false: check for end of encryption
</p>
</li>
<li>
<p>
string <strong>ftp_server.chk_str_fmt</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.cmd_validity[].command</strong>: command string
</p>
</li>
<li>
<p>
string <strong>ftp_server.cmd_validity[].format</strong>: format specification
</p>
</li>
<li>
<p>
int <strong>ftp_server.cmd_validity[].length</strong> = 0: specify non-default maximum for command { 0: }
</p>
</li>
<li>
<p>
string <strong>ftp_server.data_chan_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.data_xfer_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
int <strong>ftp_server.def_max_param_len</strong> = 100: default maximum length of commands handled by server; 0 is unlimited { 1: }
</p>
</li>
<li>
<p>
string <strong>ftp_server.directory_cmds[].dir_cmd</strong>: directory command
</p>
</li>
<li>
<p>
int <strong>ftp_server.directory_cmds[].rsp_code</strong> = 200: expected successful response code for command { 200: }
</p>
</li>
<li>
<p>
string <strong>ftp_server.encr_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
bool <strong>ftp_server.encrypted_traffic</strong> = false: check for encrypted telnet and ftp
</p>
</li>
<li>
<p>
string <strong>ftp_server.file_get_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.file_put_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
string <strong>ftp_server.ftp_cmds</strong>: specify additional commands supported by server beyond RFC 959
</p>
</li>
<li>
<p>
bool <strong>ftp_server.ignore_data_chan</strong> = false: do not inspect ftp data channels
</p>
</li>
<li>
<p>
bool <strong>ftp_server.ignore_telnet_erase_cmds</strong> = false: ignore erase character and erase line commands when normalizing
</p>
</li>
<li>
<p>
string <strong>ftp_server.login_cmds</strong>: check the formatting of the given commands
</p>
</li>
<li>
<p>
bool <strong>ftp_server.print_cmds</strong> = false: print command configurations on start up
</p>
</li>
<li>
<p>
bool <strong>ftp_server.telnet_cmds</strong> = false: detect telnet escape sequences of ftp control channel
</p>
</li>
<li>
<p>
int <strong>gid.~</strong>: generator id { 1: }
</p>
</li>
<li>
<p>
enum <strong>hosts[].frag_policy</strong> = linux: defragmentation policy { unknown | first | linux | bsd | bsd_right |last | windows | solaris }
</p>
</li>
<li>
<p>
addr <strong>hosts[].ip</strong> = 0.0.0.0/32: hosts address / cidr
</p>
</li>
<li>
<p>
string <strong>hosts[].services[].name</strong>: service identifier
</p>
</li>
<li>
<p>
port <strong>hosts[].services[].port</strong>: port number
</p>
</li>
<li>
<p>
enum <strong>hosts[].services[].proto</strong> = tcp: ip protocol { tcp | udp }
</p>
</li>
<li>
<p>
enum <strong>hosts[].tcp_policy</strong> = linux: tcp reassembly policy { unknown | first | last | bsd | linux | old-linux | windows | win-2003 | vista | solaris | hpux | hpux10 | irix | macos }
</p>
</li>
<li>
<p>
int <strong>http_global.compress_depth</strong> = 65535: maximum amount of packet payload to decompress { 1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.b64_decode_depth</strong> = 0: single packet decode depth { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.bitenc_decode_depth</strong> = 0: single packet decode depth { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.max_mime_mem</strong> = 838860: single packet decode depth { 3276: }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.qp_decode_depth</strong> = 0: single packet decode depth { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decode.uu_decode_depth</strong> = 0: single packet decode depth { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_global.decompress_depth</strong> = 65535: maximum amount of decompressed data to process { 1:65535 }
</p>
</li>
<li>
<p>
bool <strong>http_global.detect_anomalous_servers</strong> = false: inspect non-configured ports for HTTP - bad idea
</p>
</li>
<li>
<p>
int <strong>http_global.max_gzip_mem</strong> = 838860: total memory used for decompression across all active sessions { 3276: }
</p>
</li>
<li>
<p>
int <strong>http_global.memcap</strong> = 150994944: limit of memory used for logging extra data { 2304: }
</p>
</li>
<li>
<p>
bool <strong>http_global.proxy_alert</strong> = false: alert on proxy usage for servers without allow_proxy_use
</p>
</li>
<li>
<p>
int <strong>http_global.unicode_map.code_page</strong> = 1252: select code page in map file { 0: }
</p>
</li>
<li>
<p>
string <strong>http_global.unicode_map.map_file</strong>: unicode map file
</p>
</li>
<li>
<p>
string <strong>http_header.~name</strong>: restrict to given header
</p>
</li>
<li>
<p>
bool <strong>http_inspect.allow_proxy_use</strong> = false: don&#8217;t alert on proxy use for this server
</p>
</li>
<li>
<p>
bool <strong>http_inspect.apache_whitespace</strong> = false: don&#8217;t alert if tab is used in lieu of space characters
</p>
</li>
<li>
<p>
bool <strong>http_inspect.ascii</strong> = false: enable decoding ASCII like %2f to /
</p>
</li>
<li>
<p>
bool <strong>http_inspect.bare_byte</strong> = false: decode non-standard, non-ASCII character encodings
</p>
</li>
<li>
<p>
int <strong>http_inspect.chunk_length</strong> = 500000: alert on chunk lengths greater than specified { 1: }
</p>
</li>
<li>
<p>
int <strong>http_inspect.client_flow_depth</strong> = 0: raw request payload to inspect { -1:1460 }
</p>
</li>
<li>
<p>
bool <strong>http_inspect.directory</strong> = false: normalize . and .. sequences out of URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.double_decode</strong> = false: iis specific extra decoding
</p>
</li>
<li>
<p>
bool <strong>http_inspect.enable_cookies</strong> = true: extract cookies
</p>
</li>
<li>
<p>
bool <strong>http_inspect.enable_xff</strong> = false: log True-Client-IP and X-Forwarded-For headers with unified2 alerts as extra data
</p>
</li>
<li>
<p>
bool <strong>http_inspect.extended_ascii_uri</strong> = false: allow extended ASCII codes in the request URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.extended_response_inspection</strong> = true: extract response headers
</p>
</li>
<li>
<p>
string <strong>http_inspect.http_methods</strong> = GET POST PUT SEARCH MKCOL COPY MOVE LOCK UNLOCK NOTIFY POLL BCOPY BDELETE BMOVE LINK UNLINK OPTIONS HEAD DELETE TRACE TRACK CONNECT SOURCE SUBSCRIBE UNSUBSCRIBE PROPFIND PROPPATCH BPROPFIND BPROPPATCH RPC_CONNECT PROXY_SUCCESS BITS_POST CCM_POST SMS_POST RPC_IN_DATA RPC_OUT_DATA RPC_ECHO_DATA: request methods allowed in addition to GET and POST
</p>
</li>
<li>
<p>
bool <strong>http_inspect.iis_backslash</strong> = false: normalize directory slashes
</p>
</li>
<li>
<p>
bool <strong>http_inspect.iis_delimiter</strong> = false: allow use of non-standard delimiter
</p>
</li>
<li>
<p>
bool <strong>http_inspect.iis_unicode</strong> = false: enable unicode code point mapping using unicode_map settings
</p>
</li>
<li>
<p>
int <strong>http_inspect.iis_unicode_map.code_page</strong> = 1252: select code page in map file { 0: }
</p>
</li>
<li>
<p>
string <strong>http_inspect.iis_unicode_map.map_file</strong>: unicode map file
</p>
</li>
<li>
<p>
bool <strong>http_inspect.inspect_gzip</strong> = true: enable gzip decompression of compressed bodies
</p>
</li>
<li>
<p>
bool <strong>http_inspect.inspect_uri_only</strong> = false: disable all detection except for uricontent
</p>
</li>
<li>
<p>
bool <strong>http_inspect.log_hostname</strong> = false: enable logging of Hostname with unified2 alerts as extra data
</p>
</li>
<li>
<p>
bool <strong>http_inspect.log_uri</strong> = false: enable logging of URI with unified2 alerts as extra data
</p>
</li>
<li>
<p>
int <strong>http_inspect.max_header_length</strong> = 750: maximum allowed client request header field { 0:65535 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.max_headers</strong> = 100: maximum allowed client request headers { 0:1024 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.max_javascript_whitespaces</strong> = 200: maximum number of consecutive whitespaces { 0: }
</p>
</li>
<li>
<p>
int <strong>http_inspect.max_spaces</strong> = 200: maximum allowed whitespaces when folding { 0:65535 }
</p>
</li>
<li>
<p>
bool <strong>http_inspect.multi_slash</strong> = false: normalize out consecutive slashes in URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.no_pipeline_req</strong> = false: don&#8217;t inspect pipelined requests after first (still does general detection)
</p>
</li>
<li>
<p>
bit_list <strong>http_inspect.non_rfc_chars</strong> = 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07: alert on given non-RFC chars being present in the URI { 255 }
</p>
</li>
<li>
<p>
bool <strong>http_inspect.non_strict</strong> = true: allows HTTP 0.9 processing
</p>
</li>
<li>
<p>
bool <strong>http_inspect.normalize_cookies</strong> = false: normalize cookies similar to URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.normalize_headers</strong> = false: normalize headers other than cookie similar to URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.normalize_javascript</strong> = true: normalize javascript between &lt;script&gt; tags
</p>
</li>
<li>
<p>
bool <strong>http_inspect.normalize_utf</strong> = true: normalize response bodies with UTF content-types
</p>
</li>
<li>
<p>
int <strong>http_inspect.oversize_dir_length</strong> = 500: alert if a URL has a directory longer than this limit { 0: }
</p>
</li>
<li>
<p>
int <strong>http_inspect.post_depth</strong> = 65495: amount of POST data to inspect { -1:65535 }
</p>
</li>
<li>
<p>
enum <strong>http_inspect.profile</strong> = none: set defaults appropriate for selected server { none | all | apache | iis | iis_40 | iis_50 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.server_flow_depth</strong> = 0: response payload to inspect; includes headers with extended_response_inspection { -1:65535 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.small_chunk_count</strong> = 5: alert if more than this limit of consecutive chunks are below small_chunk_length { 0:255 }
</p>
</li>
<li>
<p>
int <strong>http_inspect.small_chunk_length</strong> = 10: alert if more than small_chunk_count consecutive chunks below this limit { 0:255 }
</p>
</li>
<li>
<p>
bool <strong>http_inspect.tab_uri_delimiter</strong> = false: whether a tab not preceded by a space is considered a delimiter or part of URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.u_encode</strong> = true: decode %uXXXX character sequences
</p>
</li>
<li>
<p>
bool <strong>http_inspect.unlimited_decompress</strong> = true: decompress across multiple packets
</p>
</li>
<li>
<p>
bool <strong>http_inspect.utf_8</strong> = false: decode UTF-8 unicode sequences in URI
</p>
</li>
<li>
<p>
bool <strong>http_inspect.webroot</strong> = false: alert on directory traversals past the top level (web server root)
</p>
</li>
<li>
<p>
bit_list <strong>http_inspect.whitespace_chars</strong>: allowed white space characters { 255 }
</p>
</li>
<li>
<p>
string <strong>icmp_id.~range</strong>: check if icmp id is <em>id | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
string <strong>icmp_seq.~range</strong>: check if icmp sequence number is <em>seq | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
string <strong>icode.~range</strong>: check if ICMP code is <em>code | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
string <strong>id.~range</strong>: check if the IP ID is <em>id | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
string <strong>ip_proto.~proto</strong>: [!|&gt;|&lt;] name or number
</p>
</li>
<li>
<p>
select <strong>ipopts.~opt</strong>: output format { rr|eol|nop|ts|sec|esec|lsrr|lsrre|ssrr|satid|any }
</p>
</li>
<li>
<p>
bool <strong>ips.enable_builtin_rules</strong> = false: enable events from builtin rules w/o stubs
</p>
</li>
<li>
<p>
int <strong>ips.id</strong> = 0: correlate unified2 events with configuration { 0:65535 }
</p>
</li>
<li>
<p>
string <strong>ips.include</strong>: legacy snort rules and includes
</p>
</li>
<li>
<p>
enum <strong>ips.mode</strong> = tap: set policy mode { tap | inline | inline-test }
</p>
</li>
<li>
<p>
string <strong>ips.rules</strong>: snort rules and includes
</p>
</li>
<li>
<p>
implied <strong>isdataat.relative</strong>: offset from cursor instead of start of buffer
</p>
</li>
<li>
<p>
string <strong>isdataat.~length</strong>: num | !num
</p>
</li>
<li>
<p>
string <strong>itype.~range</strong>: check if icmp type is <em>type | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
bool <strong>log_codecs.file</strong> = stdout: output to log_codecs.txt instead of stdout
</p>
</li>
<li>
<p>
bool <strong>log_codecs.msg</strong> = false: include alert msg
</p>
</li>
<li>
<p>
int <strong>log_pcap.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
enum <strong>log_pcap.units</strong> = B: bytes | KB | MB | GB { B | K | M | G }
</p>
</li>
<li>
<p>
string <strong>metadata.</strong>*: additional parameters not used by snort
</p>
</li>
<li>
<p>
string <strong>metadata.service</strong>: service name
</p>
</li>
<li>
<p>
bool <strong>mpls.enable_mpls_multicast</strong> = false: enables support for MPLS multicast
</p>
</li>
<li>
<p>
bool <strong>mpls.enable_mpls_overlapping_ip</strong> = false: enable if private network addresses overlap and must be differentiated by MPLS label(s)
</p>
</li>
<li>
<p>
int <strong>mpls.max_mpls_stack_depth</strong> = -1: set MPLS stack depth { -1: }
</p>
</li>
<li>
<p>
enum <strong>mpls.mpls_payload_type</strong> = ip4: set encapsulated payload type { eth | ip4 | ip6 }
</p>
</li>
<li>
<p>
string <strong>msg.~</strong>: message describing rule
</p>
</li>
<li>
<p>
multi <strong>network.checksum_drop</strong> = none: drop if checksum is bad { all | ip | noip | tcp | notcp | udp | noudp | icmp | noicmp | none }
</p>
</li>
<li>
<p>
multi <strong>network.checksum_eval</strong> = none: checksums to verify { all | ip | noip | tcp | notcp | udp | noudp | icmp | noicmp | none }
</p>
</li>
<li>
<p>
bool <strong>network.decode_drops</strong> = false: enable dropping of packets by the decoder
</p>
</li>
<li>
<p>
int <strong>network.id</strong> = 0: correlate unified2 events with configuration { 0:65535 }
</p>
</li>
<li>
<p>
int <strong>network.layers</strong> = 40: The maximum number of protocols that Snort can correctly decode { 3:255 }
</p>
</li>
<li>
<p>
int <strong>network.max_ip6_extensions</strong> = 0: The number of IP6 options Snort will process for a given IPv6 layer. If this limit is hit, rule 116:456 may fire.  0 = unlimited { 0:255 }
</p>
</li>
<li>
<p>
int <strong>network.max_ip_layers</strong> = 0: The maximum number of IP layers Snort will process for a given packet If this limit is hit, rule 116:293 may fire.  0 = unlimited { 0:255 }
</p>
</li>
<li>
<p>
int <strong>network.min_ttl</strong> = 1: alert / normalize packets with lower ttl / hop limit (you must enable rules and / or normalization also) { 1:255 }
</p>
</li>
<li>
<p>
int <strong>network.new_ttl</strong> = 1: use this value for responses and when normalizing { 1:255 }
</p>
</li>
<li>
<p>
bool <strong>new_http_inspect.test_input</strong> = false: read HTTP messages from text file
</p>
</li>
<li>
<p>
bool <strong>new_http_inspect.test_output</strong> = false: print out HTTP section data
</p>
</li>
<li>
<p>
bool <strong>normalizer.icmp4</strong> = false: clear reserved flag
</p>
</li>
<li>
<p>
bool <strong>normalizer.icmp6</strong> = false: clear reserved flag
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip4.base</strong> = true: clear options
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip4.df</strong> = false: clear don&#8217;t frag flag
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip4.rf</strong> = false: clear reserved flag
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip4.tos</strong> = false: clear tos / differentiated services byte
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip4.trim</strong> = false: truncate excess payload beyond datagram length
</p>
</li>
<li>
<p>
bool <strong>normalizer.ip6</strong> = false: clear reserved flag
</p>
</li>
<li>
<p>
string <strong>normalizer.tcp.allow_codes</strong>: don&#8217;t clear given option codes
</p>
</li>
<li>
<p>
multi <strong>normalizer.tcp.allow_names</strong>: don&#8217;t clear given option names { sack | echo | partial_order | conn_count | alt_checksum | md5 }
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.base</strong> = true: clear reserved bits and option padding and fix urgent pointer / flags issues
</p>
</li>
<li>
<p>
select <strong>normalizer.tcp.ecn</strong> = off: clear ecn for all packets | sessions w/o ecn setup { off | packet | stream }
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.ips</strong> = false: ensure consistency in retransmitted data
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.opts</strong> = false: clear all options except mss, wscale, timestamp, and any explicitly allowed
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.trim</strong> = false: trim data on syn and reset and any outside window or past mss,
</p>
</li>
<li>
<p>
bool <strong>normalizer.tcp.urp</strong> = true: adjust urgent pointer if beyond segment length
</p>
</li>
<li>
<p>
bool <strong>output.dump_chars_only</strong> = false: turns on character dumps (same as -C)
</p>
</li>
<li>
<p>
bool <strong>output.dump_payload</strong> = false: dumps application layer (same as -d)
</p>
</li>
<li>
<p>
bool <strong>output.dump_payload_verbose</strong> = false: dumps raw packet starting at link layer (same as -X)
</p>
</li>
<li>
<p>
string <strong>output.event_trace.file</strong>: where to write event trace logs
</p>
</li>
<li>
<p>
int <strong>output.event_trace.max_data</strong> = 0: maximum amount of packet data to capture { 0:65535 }
</p>
</li>
<li>
<p>
bool <strong>output.log_ipv6_extra_data</strong> = false: log IPv6 source and destination addresses as unified2 extra data records
</p>
</li>
<li>
<p>
string <strong>output.logdir</strong> = .: where to put log files (same as -l)
</p>
</li>
<li>
<p>
bool <strong>output.nolog</strong> = false: turn off logging (alerts still work, same as -N)
</p>
</li>
<li>
<p>
bool <strong>output.obfuscate</strong> = false: obfuscate the logged IP addresses (same as -O)
</p>
</li>
<li>
<p>
bool <strong>output.quiet</strong> = false: suppress non-fatal information (still show alerts, same as -q)
</p>
</li>
<li>
<p>
bool <strong>output.show_year</strong> = false: include year in timestamp in the alert and log files (same as -y)
</p>
</li>
<li>
<p>
int <strong>output.tagged_packet_limit</strong> = 256: maximum number of packets tagged for non-packet metrics { 0: }
</p>
</li>
<li>
<p>
bool <strong>output.verbose</strong> = false: be verbose (same as -v)
</p>
</li>
<li>
<p>
bool <strong>packets.address_space_agnostic</strong> = false: determines whether DAQ address space info is used to track fragments and connections
</p>
</li>
<li>
<p>
string <strong>packets.bpf_file</strong>: file with BPF to select traffic for Snort
</p>
</li>
<li>
<p>
bool <strong>packets.enable_inline_init_failopen</strong> = true: whether to pass traffic during later stage of initialization to avoid drops
</p>
</li>
<li>
<p>
int <strong>packets.limit</strong> = 0: maximum number of packets to process before stopping (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
int <strong>packets.skip</strong> = 0: number of packets to skip before before processing { 0: }
</p>
</li>
<li>
<p>
bool <strong>packets.vlan_agnostic</strong> = false: determines whether VLAN info is used to track fragments and connections
</p>
</li>
<li>
<p>
string <strong>pcre.~regex</strong>: Snort regular expression
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.console</strong> = false: output to console
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.events</strong> = false: report on qualified vs non-qualified events
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.file</strong> = false: output base stats to perf_monitor.csv instead of stdout
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.flow</strong> = false: enable traffic statistics
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.flow_file</strong> = false: output traffic statistics to a perf_monitor_flow.csv instead of stdout
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.flow_ip</strong> = false: enable statistics on host pairs
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.flow_ip_file</strong> = false: output host pair statistics to perf_monitor_flow_ip.csv instead of stdout
</p>
</li>
<li>
<p>
int <strong>perf_monitor.flow_ip_memcap</strong> = 52428800: maximum memory for flow tracking { 0: }
</p>
</li>
<li>
<p>
int <strong>perf_monitor.flow_ports</strong> = 1023: maximum ports to track { 0: }
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.max</strong> = false: calculate theoretical maximum performance
</p>
</li>
<li>
<p>
int <strong>perf_monitor.max_file_size</strong> = 4096: files will be rolled over if they exceed this size { 4096: }
</p>
</li>
<li>
<p>
int <strong>perf_monitor.packets</strong> = 10000: minim packets to report { 0: }
</p>
</li>
<li>
<p>
bool <strong>perf_monitor.reset</strong> = true: reset (clear) statistics after each reporting interval
</p>
</li>
<li>
<p>
int <strong>perf_monitor.seconds</strong> = 60: report interval; 0 means report at exit only { 0: }
</p>
</li>
<li>
<p>
string <strong>port_scan.ignore_scanned</strong>: list of CIDRs with optional ports to ignore if the destination of scan alerts
</p>
</li>
<li>
<p>
string <strong>port_scan.ignore_scanners</strong>: list of CIDRs with optional ports to ignore if the source of scan alerts
</p>
</li>
<li>
<p>
bool <strong>port_scan.include_midstream</strong> = false: list of CIDRs with optional ports
</p>
</li>
<li>
<p>
bool <strong>port_scan.logfile</strong> = false: write scan events to file
</p>
</li>
<li>
<p>
multi <strong>port_scan.protos</strong> = all: choose the protocols to monitor { tcp | udp | icmp | ip | all }
</p>
</li>
<li>
<p>
multi <strong>port_scan.scan_types</strong> = all: choose type of scans to look for { portscan | portsweep | decoy_portscan | distributed_portscan | all }
</p>
</li>
<li>
<p>
enum <strong>port_scan.sense_level</strong> = medium: choose the level of detection { low | medium | high }
</p>
</li>
<li>
<p>
string <strong>port_scan.watch_ip</strong>: list of CIDRs with optional ports to watch
</p>
</li>
<li>
<p>
int <strong>port_scan_global.memcap</strong> = 1048576: maximum tracker memory { 1: }
</p>
</li>
<li>
<p>
bool <strong>ppm.debug_pkts</strong> = false: enable packet debug
</p>
</li>
<li>
<p>
bool <strong>ppm.debug_rules</strong> = false: enable rule debug
</p>
</li>
<li>
<p>
bool <strong>ppm.fastpath_expensive_packets</strong> = false: stop inspection if the max_pkt_time is exceeded
</p>
</li>
<li>
<p>
int <strong>ppm.max_pkt_time</strong> = 0: enable packet latency thresholding (usec), 0 = off { 0: }
</p>
</li>
<li>
<p>
int <strong>ppm.max_rule_time</strong> = 0: enable rule latency thresholding (usec), 0 = off { 0: }
</p>
</li>
<li>
<p>
enum <strong>ppm.pkt_log</strong> = none: log event if max_pkt_time is exceeded { none | log | alert | both }
</p>
</li>
<li>
<p>
enum <strong>ppm.rule_log</strong> = none: enable event logging for suspended rules { none|log|alert|both }
</p>
</li>
<li>
<p>
bool <strong>ppm.suspend_expensive_rules</strong> = false: temporarily disable rule if threshold is reached
</p>
</li>
<li>
<p>
int <strong>ppm.suspend_timeout</strong> = 60: seconds to suspend rule, 0 = permanent { 0: }
</p>
</li>
<li>
<p>
int <strong>ppm.threshold</strong> = 5: number of times to exceed limit before disabling rule { 1: }
</p>
</li>
<li>
<p>
int <strong>priority.~</strong>: relative severity level; 1 is highest priority { 1: }
</p>
</li>
<li>
<p>
string <strong>process.chroot</strong>: set chroot directory (same as -t)
</p>
</li>
<li>
<p>
bool <strong>process.daemon</strong> = false: fork as a daemon (same as -D)
</p>
</li>
<li>
<p>
bool <strong>process.dirty_pig</strong> = false: shutdown without internal cleanup
</p>
</li>
<li>
<p>
string <strong>process.set_gid</strong>: set group ID (same as -g)
</p>
</li>
<li>
<p>
string <strong>process.set_uid</strong>: set user ID (same as -u)
</p>
</li>
<li>
<p>
int <strong>process.threads[].cpu</strong> = 0: pin the associated source/thread to this cpu { 0:127 }
</p>
</li>
<li>
<p>
string <strong>process.threads[].source</strong>: set cpu affinity for this source (either pcap or &lt;iface&gt;
</p>
</li>
<li>
<p>
int <strong>process.threads[].thread</strong> = 0: set cpu affinity for the &lt;cur_thread_num&gt; thread that runs { 0: }
</p>
</li>
<li>
<p>
string <strong>process.umask</strong>: set process umask (same as -m)
</p>
</li>
<li>
<p>
bool <strong>process.utc</strong> = false: use UTC instead of local time for timestamps
</p>
</li>
<li>
<p>
int <strong>profile.modules.count</strong> = -1: print results to given level (-1 = all, 0 = off?) { -1: }
</p>
</li>
<li>
<p>
enum <strong>profile.modules.sort</strong> = avg_ticks: sort by given field { checks | avg_ticks | total_ticks }
</p>
</li>
<li>
<p>
int <strong>profile.rules.count</strong> = -1: print results to given level (-1 = all, 0 = off?) { -1: }
</p>
</li>
<li>
<p>
enum <strong>profile.rules.sort</strong> = avg_ticks: sort by given field { checks | avg_ticks | total_ticks | matches | no_matches | avg_ticks_per_match | avg_ticks_per_no_match }
</p>
</li>
<li>
<p>
string <strong>rate_filter[].apply_to</strong>: restrict filter to these addresses according to track
</p>
</li>
<li>
<p>
int <strong>rate_filter[].count</strong> = 1: number of events in interval before tripping { 0: }
</p>
</li>
<li>
<p>
int <strong>rate_filter[].gid</strong> = 1: rule generator ID { 0: }
</p>
</li>
<li>
<p>
select <strong>rate_filter[].new_action</strong> = alert: take this action on future hits until timeout { alert | drop | log | pass | | reject | sdrop }
</p>
</li>
<li>
<p>
int <strong>rate_filter[].seconds</strong> = 1: count interval { 0: }
</p>
</li>
<li>
<p>
int <strong>rate_filter[].sid</strong> = 1: rule signature ID { 0: }
</p>
</li>
<li>
<p>
int <strong>rate_filter[].timeout</strong> = 1: count interval { 0: }
</p>
</li>
<li>
<p>
enum <strong>rate_filter[].track</strong> = by_src: filter only matching source or destination addresses { by_src | by_dst | by_rule }
</p>
</li>
<li>
<p>
implied <strong>react.msg</strong>:  use rule message in response page
</p>
</li>
<li>
<p>
string <strong>react.page</strong>: file containing HTTP response (headers and body)
</p>
</li>
<li>
<p>
string <strong>reference.~id</strong>: reference id
</p>
</li>
<li>
<p>
string <strong>reference.~scheme</strong>: reference scheme
</p>
</li>
<li>
<p>
string <strong>references[].name</strong>: name used with reference rule option
</p>
</li>
<li>
<p>
string <strong>references[].url</strong>: where this reference is defined
</p>
</li>
<li>
<p>
enum <strong>reject.control</strong>: send icmp unreachable(s) { network|host|port|all }
</p>
</li>
<li>
<p>
enum <strong>reject.reset</strong>: send tcp reset to one or both ends { source|dest|both }
</p>
</li>
<li>
<p>
string <strong>rem.~</strong>: comment
</p>
</li>
<li>
<p>
string <strong>replace.~</strong>: byte code to replace with
</p>
</li>
<li>
<p>
int <strong>rev.~</strong>: revision { 1: }
</p>
</li>
<li>
<p>
string <strong>rpc.~app</strong>: application number
</p>
</li>
<li>
<p>
string <strong>rpc.~proc</strong>: procedure number or * for any
</p>
</li>
<li>
<p>
string <strong>rpc.~ver</strong>: version number or * for any
</p>
</li>
<li>
<p>
bool <strong>rule_state.enable</strong> = true: enable or disable rule in all policies
</p>
</li>
<li>
<p>
int <strong>rule_state.gid</strong> = 0: rule generator ID { 0: }
</p>
</li>
<li>
<p>
int <strong>rule_state.sid</strong> = 0: rule signature ID { 0: }
</p>
</li>
<li>
<p>
int <strong>search_engine.bleedover_port_limit</strong> = 1024: maximum ports in rule before demotion to any-any port group { 1: }
</p>
</li>
<li>
<p>
bool <strong>search_engine.bleedover_warnings_enabled</strong> = false: print warning if a rule is demoted to any-any port group
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug</strong> = false: print verbose fast pattern info
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_fast_pattern</strong> = false: print fast pattern info for each rule
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_nocontent_rule_tests</strong> = false: print rule group info during packet evaluation
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_rule_group_build_details</strong> = false: print rule group info during compilation
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_rule_groups_compiled</strong> = false: prints compiled rule group information
</p>
</li>
<li>
<p>
bool <strong>search_engine.debug_print_rule_groups_uncompiled</strong> = false: prints uncompiled rule group information
</p>
</li>
<li>
<p>
bool <strong>search_engine.enable_single_rule_group</strong> = false: put all rules into one group
</p>
</li>
<li>
<p>
int <strong>search_engine.max_pattern_len</strong> = 0: truncate patterns when compiling into state machine (0 means no maximum) { 0: }
</p>
</li>
<li>
<p>
int <strong>search_engine.max_queue_events</strong> = 5: maximum number of matching fast pattern states to queue per packet
</p>
</li>
<li>
<p>
bool <strong>search_engine.no_stream_inserts</strong> = false: don&#8217;t inspect reassembled payload - good for performance, bad for detection
</p>
</li>
<li>
<p>
string <strong>search_engine.search_method</strong> = ac_bnfa_q: set fast pattern algorithm - choose available search engine
</p>
</li>
<li>
<p>
bool <strong>search_engine.search_optimize</strong> = false: tweak state machine construction for better performance
</p>
</li>
<li>
<p>
bool <strong>search_engine.split_any_any</strong> = false: evaluate any-any rules separately to save memory
</p>
</li>
<li>
<p>
string <strong>seq.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
enum <strong>session.~mode</strong>: output format { printable|binary|all }
</p>
</li>
<li>
<p>
int <strong>sid.~</strong>: signature id { 1: }
</p>
</li>
<li>
<p>
implied <strong>snort.--alert-before-pass</strong>: process alert, drop, sdrop, or reject before pass; default is pass before alert, drop,&#8230;
</p>
</li>
<li>
<p>
string <strong>snort.--bpf</strong>: &lt;filter options&gt; are standard BPF options, as seen in TCPDump
</p>
</li>
<li>
<p>
string <strong>snort.--c2x</strong>: output hex for given char
</p>
</li>
<li>
<p>
implied <strong>snort.--create-pidfile</strong>: create PID file, even when not in Daemon mode
</p>
</li>
<li>
<p>
string <strong>snort.--daq</strong>: &lt;type&gt; select packet acquisition module (default is pcap)
</p>
</li>
<li>
<p>
string <strong>snort.--daq-dir</strong>: &lt;dir&gt; tell snort where to find desired DAQ
</p>
</li>
<li>
<p>
implied <strong>snort.--daq-list</strong>: list packet acquisition modules available in optional dir, default is static modules only
</p>
</li>
<li>
<p>
string <strong>snort.--daq-mode</strong>: &lt;mode&gt; select the DAQ operating mode
</p>
</li>
<li>
<p>
string <strong>snort.--daq-var</strong>: &lt;name=value&gt; specify extra DAQ configuration variable
</p>
</li>
<li>
<p>
implied <strong>snort.--dirty-pig</strong>: don&#8217;t flush packets on shutdown
</p>
</li>
<li>
<p>
implied <strong>snort.--dump-builtin-rules</strong>: [&lt;module prefix&gt;] output stub rules for selected modules
</p>
</li>
<li>
<p>
string <strong>snort.--dump-defaults</strong>: [&lt;module prefix&gt;] output module defaults in Lua format { (optional) }
</p>
</li>
<li>
<p>
implied <strong>snort.--dump-dynamic-rules</strong>: output stub rules for all loaded rules libraries
</p>
</li>
<li>
<p>
string <strong>snort.--dump-version</strong>: output the version, the whole version, and only the version { (optional) }
</p>
</li>
<li>
<p>
implied <strong>snort.--enable-inline-test</strong>: enable Inline-Test Mode Operation
</p>
</li>
<li>
<p>
implied <strong>snort.--help</strong>: list command line options
</p>
</li>
<li>
<p>
string <strong>snort.--help-commands</strong>: [&lt;module prefix&gt;] output matching commands { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--help-config</strong>: [&lt;module prefix&gt;] output matching config options { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--help-counts</strong>: [&lt;module prefix&gt;] output matching peg counts { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--help-module</strong>: &lt;module&gt; output description of given module
</p>
</li>
<li>
<p>
implied <strong>snort.--help-modules</strong>: list all available modules with brief help
</p>
</li>
<li>
<p>
string <strong>snort.--help-options</strong>: &lt;option prefix&gt; output matching command line option quick help (same as -?) { (optional) }
</p>
</li>
<li>
<p>
implied <strong>snort.--help-plugins</strong>: list all available plugins with brief help
</p>
</li>
<li>
<p>
implied <strong>snort.--help-signals</strong>: dump available control signals
</p>
</li>
<li>
<p>
implied <strong>snort.--id-subdir</strong>: create/use instance subdirectories in logdir instead of instance filename prefix
</p>
</li>
<li>
<p>
implied <strong>snort.--id-zero</strong>: use id prefix / subdirectory even with one packet thread
</p>
</li>
<li>
<p>
implied <strong>snort.--list-buffers</strong>: output available inspection buffers
</p>
</li>
<li>
<p>
string <strong>snort.--list-builtin</strong>: &lt;module prefix&gt; output matching builtin rules { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--list-gids</strong>: [&lt;module prefix&gt;] output matching generators { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.--list-modules</strong>: [&lt;module type&gt;] list all known modules of given type { (optional) }
</p>
</li>
<li>
<p>
implied <strong>snort.--list-plugins</strong>: list all known plugins
</p>
</li>
<li>
<p>
int <strong>snort.--logid</strong>: &lt;0xid&gt; log Identifier to uniquely id events for multiple snorts (same as -G) { 0:65535 }
</p>
</li>
<li>
<p>
string <strong>snort.--lua</strong>: &lt;chunk&gt; extend/override conf with chunk; may be repeated
</p>
</li>
<li>
<p>
implied <strong>snort.--markup</strong>: output help in asciidoc compatible format
</p>
</li>
<li>
<p>
int <strong>snort.--max-packet-threads</strong>: &lt;count&gt; configure maximum number of packet threads (same as -z) { 0: }
</p>
</li>
<li>
<p>
implied <strong>snort.--nolock-pidfile</strong>: do not try to lock Snort PID file
</p>
</li>
<li>
<p>
implied <strong>snort.--nostamps</strong>: don&#8217;t include timestamps in log file names
</p>
</li>
<li>
<p>
implied <strong>snort.--pause</strong>: wait for resume/quit command before processing packets/terminating
</p>
</li>
<li>
<p>
string <strong>snort.--pcap-dir</strong>: &lt;dir&gt; a directory to recurse to look for pcaps - read mode is implied
</p>
</li>
<li>
<p>
string <strong>snort.--pcap-file</strong>: &lt;file&gt; file that contains a list of pcaps to read - read mode is implied
</p>
</li>
<li>
<p>
string <strong>snort.--pcap-filter</strong>: &lt;filter&gt; filter to apply when getting pcaps from file or directory
</p>
</li>
<li>
<p>
string <strong>snort.--pcap-list</strong>: &lt;list&gt; a space separated list of pcaps to read - read mode is implied
</p>
</li>
<li>
<p>
int <strong>snort.--pcap-loop</strong>: &lt;count&gt; read all pcaps &lt;count&gt; times;  0 will read until Snort is terminated { -1: }
</p>
</li>
<li>
<p>
implied <strong>snort.--pcap-no-filter</strong>: reset to use no filter when getting pcaps from file or directory
</p>
</li>
<li>
<p>
implied <strong>snort.--pcap-reload</strong>: if reading multiple pcaps, reload snort config between pcaps
</p>
</li>
<li>
<p>
implied <strong>snort.--pcap-reset</strong>: ignored - for REG_TEST only
</p>
</li>
<li>
<p>
implied <strong>snort.--pcap-show</strong>: print a line saying what pcap is currently being read
</p>
</li>
<li>
<p>
implied <strong>snort.--pedantic</strong>: warnings are fatal
</p>
</li>
<li>
<p>
string <strong>snort.--plugin-path</strong>: &lt;path&gt; where to find plugins
</p>
</li>
<li>
<p>
implied <strong>snort.--process-all-events</strong>: process all action groups
</p>
</li>
<li>
<p>
string <strong>snort.--rule</strong>: &lt;rules&gt; to be added to configuration; may be repeated
</p>
</li>
<li>
<p>
implied <strong>snort.--rule-to-hex</strong>: output so rule header to stdout for text rule on stdin
</p>
</li>
<li>
<p>
implied <strong>snort.--rule-to-text</strong>: output plain so rule header to stdout for text rule on stdin
</p>
</li>
<li>
<p>
string <strong>snort.--run-prefix</strong>: &lt;pfx&gt; prepend this to each output file
</p>
</li>
<li>
<p>
string <strong>snort.--script-path</strong>: &lt;path&gt; where to find luajit scripts
</p>
</li>
<li>
<p>
implied <strong>snort.--shell</strong>: enable the interactive command line
</p>
</li>
<li>
<p>
implied <strong>snort.--show-plugins</strong>: list module and plugin versions
</p>
</li>
<li>
<p>
int <strong>snort.--skip</strong>: &lt;n&gt; skip 1st n packets { 0: }
</p>
</li>
<li>
<p>
int <strong>snort.--snaplen</strong>: &lt;snap&gt; set snaplen of packet (same as -s) { 68:65535 }
</p>
</li>
<li>
<p>
implied <strong>snort.--stdin-rules</strong>: read rules from stdin until EOF or a line starting with END is read
</p>
</li>
<li>
<p>
implied <strong>snort.--treat-drop-as-alert</strong>: converts drop, sdrop, and reject rules into alert rules during startup
</p>
</li>
<li>
<p>
implied <strong>snort.--treat-drop-as-ignore</strong>: use drop, sdrop, and reject rules to ignore session traffic when not inline
</p>
</li>
<li>
<p>
implied <strong>snort.--version</strong>: show version number (same as -V)
</p>
</li>
<li>
<p>
implied <strong>snort.--warn-all</strong>: enable all warnings
</p>
</li>
<li>
<p>
implied <strong>snort.--warn-flowbits</strong>: warn about flowbits that are checked but not set and vice-versa
</p>
</li>
<li>
<p>
implied <strong>snort.--warn-unknown</strong>: warn about unknown symbols in your config
</p>
</li>
<li>
<p>
int <strong>snort.--x2c</strong>: output ASCII char for given hex
</p>
</li>
<li>
<p>
string <strong>snort.-?</strong>: &lt;option prefix&gt; output matching command line option quick help (same as --help-options) { (optional) }
</p>
</li>
<li>
<p>
string <strong>snort.-A</strong>: &lt;mode&gt; set alert mode: none, cmg, or alert_*
</p>
</li>
<li>
<p>
implied <strong>snort.-B</strong>: &lt;mask&gt; obfuscated IP addresses in alerts and packet dumps using CIDR mask
</p>
</li>
<li>
<p>
implied <strong>snort.-C</strong>: print out payloads with character data only (no hex)
</p>
</li>
<li>
<p>
implied <strong>snort.-D</strong>: run Snort in background (daemon) mode
</p>
</li>
<li>
<p>
implied <strong>snort.-E</strong>: enable daemon restart
</p>
</li>
<li>
<p>
int <strong>snort.-G</strong>: &lt;0xid&gt; (same as --logid) { 0:65535 }
</p>
</li>
<li>
<p>
implied <strong>snort.-H</strong>: make hash tables deterministic
</p>
</li>
<li>
<p>
select <strong>snort.-K</strong> = none: &lt;mode&gt; logging mode { none|text|pcap }
</p>
</li>
<li>
<p>
implied <strong>snort.-M</strong>: log messages to syslog (not alerts)
</p>
</li>
<li>
<p>
implied <strong>snort.-N</strong>: ignored - for REG_TEST only
</p>
</li>
<li>
<p>
implied <strong>snort.-O</strong>: obfuscate the logged IP addresses
</p>
</li>
<li>
<p>
implied <strong>snort.-Q</strong>: enable inline mode operation
</p>
</li>
<li>
<p>
string <strong>snort.-R</strong>: &lt;rules&gt; include this rules file in the default policy
</p>
</li>
<li>
<p>
string <strong>snort.-S</strong>: &lt;n=v&gt; set rules file variable n equal to value v
</p>
</li>
<li>
<p>
implied <strong>snort.-T</strong>: test and report on the current Snort configuration
</p>
</li>
<li>
<p>
implied <strong>snort.-U</strong>: use UTC for timestamps
</p>
</li>
<li>
<p>
implied <strong>snort.-V</strong>: (same as --version)
</p>
</li>
<li>
<p>
implied <strong>snort.-W</strong>: lists available interfaces
</p>
</li>
<li>
<p>
implied <strong>snort.-X</strong>: dump the raw packet data starting at the link layer
</p>
</li>
<li>
<p>
string <strong>snort.-c</strong>: &lt;conf&gt; use this configuration
</p>
</li>
<li>
<p>
implied <strong>snort.-d</strong>: dump the Application Layer
</p>
</li>
<li>
<p>
implied <strong>snort.-e</strong>: display the second layer header info
</p>
</li>
<li>
<p>
implied <strong>snort.-f</strong>: turn off fflush() calls after binary log writes
</p>
</li>
<li>
<p>
string <strong>snort.-g</strong>: &lt;gname&gt; run snort gid as &lt;gname&gt; group (or gid) after initialization
</p>
</li>
<li>
<p>
string <strong>snort.-i</strong>: &lt;iface&gt;&#8230; list of interfaces
</p>
</li>
<li>
<p>
port <strong>snort.-j</strong>: &lt;port&gt; to listen for telnet connections
</p>
</li>
<li>
<p>
enum <strong>snort.-k</strong> = all: &lt;mode&gt; checksum mode (all,noip,notcp,noudp,noicmp,none) { all|noip|notcp|noudp|noicmp|none }
</p>
</li>
<li>
<p>
string <strong>snort.-l</strong>: &lt;logdir&gt; log to this directory instead of current directory
</p>
</li>
<li>
<p>
int <strong>snort.-m</strong>: &lt;umask&gt; set umask = &lt;umask&gt; { 0: }
</p>
</li>
<li>
<p>
int <strong>snort.-n</strong>: &lt;count&gt; stop after count packets { 0: }
</p>
</li>
<li>
<p>
implied <strong>snort.-q</strong>: quiet mode - Don&#8217;t show banner and status report
</p>
</li>
<li>
<p>
string <strong>snort.-r</strong>: &lt;pcap&gt;&#8230; (same as --pcap-list)
</p>
</li>
<li>
<p>
int <strong>snort.-s</strong>: &lt;snap&gt; (same as --snaplen) { 68:65535 }
</p>
</li>
<li>
<p>
string <strong>snort.-t</strong>: &lt;dir&gt; chroots process to &lt;dir&gt; after initialization
</p>
</li>
<li>
<p>
string <strong>snort.-u</strong>: &lt;uname&gt; run snort as &lt;uname&gt; or &lt;uid&gt; after initialization
</p>
</li>
<li>
<p>
implied <strong>snort.-v</strong>: be verbose
</p>
</li>
<li>
<p>
implied <strong>snort.-w</strong>: dump 802.11 management and control frames
</p>
</li>
<li>
<p>
implied <strong>snort.-x</strong>: same as --pedantic
</p>
</li>
<li>
<p>
implied <strong>snort.-y</strong>: include year in timestamp in the alert and log files
</p>
</li>
<li>
<p>
int <strong>snort.-z</strong>: &lt;count&gt; maximum number of packet threads (same as --max-packet-threads) { 1: }
</p>
</li>
<li>
<p>
string <strong>so.~func</strong>: name of eval function
</p>
</li>
<li>
<p>
string <strong>soid.~</strong>: SO rule ID has &lt;gid&gt;|&lt;sid&gt; format, like 3|12345
</p>
</li>
<li>
<p>
int <strong>stream.icmp_cache.idle_timeout</strong> = 60: maximum inactive time before retiring session tracker { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.icmp_cache.max_sessions</strong> = 262144: maximum simultaneous tcp sessions tracked before pruning { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.icmp_cache.memcap</strong>: maximum cache memory { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.icmp_cache.pruning_timeout</strong> = 30: minimum inactive time before being eligible for pruning { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.ip_cache.idle_timeout</strong> = 60: maximum inactive time before retiring session tracker { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.ip_cache.max_sessions</strong> = 262144: maximum simultaneous tcp sessions tracked before pruning { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.ip_cache.memcap</strong>: maximum cache memory { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.ip_cache.pruning_timeout</strong> = 30: minimum inactive time before being eligible for pruning { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.tcp_cache.idle_timeout</strong> = 60: maximum inactive time before retiring session tracker { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.tcp_cache.max_sessions</strong> = 262144: maximum simultaneous tcp sessions tracked before pruning { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.tcp_cache.memcap</strong>: maximum cache memory { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.tcp_cache.pruning_timeout</strong> = 30: minimum inactive time before being eligible for pruning { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.udp_cache.idle_timeout</strong> = 60: maximum inactive time before retiring session tracker { 1: }
</p>
</li>
<li>
<p>
int <strong>stream.udp_cache.max_sessions</strong> = 262144: maximum simultaneous tcp sessions tracked before pruning { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.udp_cache.memcap</strong>: maximum cache memory { 0: }
</p>
</li>
<li>
<p>
int <strong>stream.udp_cache.pruning_timeout</strong> = 30: minimum inactive time before being eligible for pruning { 1: }
</p>
</li>
<li>
<p>
int <strong>stream_icmp.session_timeout</strong> = 30: session tracking timeout { 1:86400 }
</p>
</li>
<li>
<p>
int <strong>stream_ip.max_frags</strong> = 8192: maximum number of simultaneous fragments being tracked { 1: }
</p>
</li>
<li>
<p>
int <strong>stream_ip.max_overlaps</strong> = 0: maximum allowed overlaps per datagram; 0 is unlimited { 0: }
</p>
</li>
<li>
<p>
int <strong>stream_ip.min_frag_length</strong> = 0: alert if fragment length is below this limit before or after trimming { 0: }
</p>
</li>
<li>
<p>
int <strong>stream_ip.min_ttl</strong> = 1: discard fragments with ttl below the minimum { 1:255 }
</p>
</li>
<li>
<p>
enum <strong>stream_ip.policy</strong> = linux: fragment reassembly policy { first | linux | bsd | bsd_right | last | windows | solaris }
</p>
</li>
<li>
<p>
int <strong>stream_ip.session_timeout</strong> = 30: session tracking timeout { 1:86400 }
</p>
</li>
<li>
<p>
enum <strong>stream_reassemble.action</strong>: stop or start stream reassembly { disable|enable }
</p>
</li>
<li>
<p>
enum <strong>stream_reassemble.direction</strong>: action applies to the given direction(s) { client|server|both }
</p>
</li>
<li>
<p>
implied <strong>stream_reassemble.fastpath</strong>: optionally whitelist the remainder of the session
</p>
</li>
<li>
<p>
implied <strong>stream_reassemble.noalert</strong>: don&#8217;t alert when rule matches
</p>
</li>
<li>
<p>
enum <strong>stream_size.direction</strong>: compare applies to the given direction(s) { either|client|server|both }
</p>
</li>
<li>
<p>
enum <strong>stream_size.operator</strong>: how to compare { = | != | &lt; | &gt; | &#8656; | &gt;= }
</p>
</li>
<li>
<p>
int <strong>stream_size.size</strong>: size for comparison
</p>
</li>
<li>
<p>
int <strong>stream_tcp.flush_factor</strong> = 0: flush upon seeing a drop in segment size after given number of non-decreasing segments { 0: }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.footprint</strong> = 0: use zero for production, non-zero for testing at given size { 0: }
</p>
</li>
<li>
<p>
bool <strong>stream_tcp.ignore_any_rules</strong> = false: process tcp content rules w/o ports only if rules with ports are present
</p>
</li>
<li>
<p>
int <strong>stream_tcp.max_pdu</strong> = 16384: maximum reassembled PDU size { 1460:63780 }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.max_window</strong> = 0: maximum allowed tcp window { 0:1073725440 }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.overlap_limit</strong> = 0: maximum number of allowed overlapping segments per session { 0:255 }
</p>
</li>
<li>
<p>
enum <strong>stream_tcp.policy</strong> = linux: determines operating system characteristics like reassembly { first | last | linux | old-linux | bsd | macos | solaris | irix | hpux | hpux10 | windows | win-2003 | vista }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.queue_limit.max_bytes</strong> = 1048576: don&#8217;t queue more than given bytes per session and direction { 0: }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.queue_limit.max_segments</strong> = 2621: don&#8217;t queue more than given segments per session and direction { 0: }
</p>
</li>
<li>
<p>
bool <strong>stream_tcp.reassemble_async</strong> = true: queue data for reassembly before traffic is seen in both directions
</p>
</li>
<li>
<p>
int <strong>stream_tcp.require_3whs</strong> = -1: don&#8217;t track midstream sessions after given seconds from start up; -1 tracks all { -1:86400 }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.session_timeout</strong> = 30: session tracking timeout { 1:86400 }
</p>
</li>
<li>
<p>
bool <strong>stream_tcp.show_rebuilt_packets</strong> = false: enable cmg like output of reassembled packets
</p>
</li>
<li>
<p>
int <strong>stream_tcp.small_segments.count</strong> = 0: limit number of small segments queued { 0:2048 }
</p>
</li>
<li>
<p>
bit_list <strong>stream_tcp.small_segments.ignore_ports</strong>: limit number of small segments queued { 65535 }
</p>
</li>
<li>
<p>
int <strong>stream_tcp.small_segments.maximum_size</strong> = 0: limit number of small segments queued { 0:2048 }
</p>
</li>
<li>
<p>
bool <strong>stream_udp.ignore_any_rules</strong> = false: process udp content rules w/o ports only if rules with ports are present
</p>
</li>
<li>
<p>
int <strong>stream_udp.session_timeout</strong> = 30: session tracking timeout { 1:86400 }
</p>
</li>
<li>
<p>
int <strong>suppress[].gid</strong> = 0: rule generator ID { 0: }
</p>
</li>
<li>
<p>
string <strong>suppress[].ip</strong>: restrict suppression to these addresses according to track
</p>
</li>
<li>
<p>
int <strong>suppress[].sid</strong> = 0: rule signature ID { 0: }
</p>
</li>
<li>
<p>
enum <strong>suppress[].track</strong>: suppress only matching source or destination addresses { by_src | by_dst }
</p>
</li>
<li>
<p>
int <strong>tag.bytes</strong>: tag for this many bytes { 1: }
</p>
</li>
<li>
<p>
int <strong>tag.packets</strong>: tag this many packets { 1: }
</p>
</li>
<li>
<p>
int <strong>tag.seconds</strong>: tag for this many seconds { 1: }
</p>
</li>
<li>
<p>
enum <strong>tag.~</strong>: log all packets in session or all packets to or from host { session|host_src|host_dst }
</p>
</li>
<li>
<p>
int <strong>telnet.ayt_attack_thresh</strong> = -1: alert on this number of consecutive telnet AYT commands { -1: }
</p>
</li>
<li>
<p>
bool <strong>telnet.check_encrypted</strong> = false: check for end of encryption
</p>
</li>
<li>
<p>
bool <strong>telnet.encrypted_traffic</strong> = false: check for encrypted telnet and ftp
</p>
</li>
<li>
<p>
bool <strong>telnet.normalize</strong> = false: eliminate escape sequences
</p>
</li>
<li>
<p>
string <strong>tos.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
string <strong>ttl.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
bool <strong>udp.deep_teredo_inspection</strong> = false: look for Teredo on all UDP ports (default is only 3544)
</p>
</li>
<li>
<p>
bool <strong>udp.enable_gtp</strong> = false: decode GTP encapsulations
</p>
</li>
<li>
<p>
bit_list <strong>udp.gtp_ports</strong> = 2152 3386: set GTP ports { 65535 }
</p>
</li>
<li>
<p>
int <strong>unified2.limit</strong> = 0: set limit (0 is unlimited) { 0: }
</p>
</li>
<li>
<p>
bool <strong>unified2.mpls_event_types</strong> = false: include mpls labels in events
</p>
</li>
<li>
<p>
bool <strong>unified2.nostamp</strong> = true: append file creation time to name (in Unix Epoch format)
</p>
</li>
<li>
<p>
enum <strong>unified2.units</strong> = B: limit multiplier { B | K | M | G }
</p>
</li>
<li>
<p>
bool <strong>unified2.vlan_event_types</strong> = false: include vlan IDs in events
</p>
</li>
<li>
<p>
string <strong>window.~range</strong>: check if packet payload size is <em>size | min&lt;&gt;max | &lt;max | &gt;min</em>
</p>
</li>
<li>
<p>
bool <strong>wizard.hexes[].client_first</strong> = true: which end initiates data transfer
</p>
</li>
<li>
<p>
select <strong>wizard.hexes[].proto</strong> = tcp: protocol to scan { tcp | udp }
</p>
</li>
<li>
<p>
string <strong>wizard.hexes[].service</strong>: name of service
</p>
</li>
<li>
<p>
string <strong>wizard.hexes[].to_client[].hex</strong>: sequence of data with wild chars (?)
</p>
</li>
<li>
<p>
string <strong>wizard.hexes[].to_server[].hex</strong>: sequence of data with wild chars (?)
</p>
</li>
<li>
<p>
bool <strong>wizard.spells[].client_first</strong> = true: which end initiates data transfer
</p>
</li>
<li>
<p>
select <strong>wizard.spells[].proto</strong> = tcp: protocol to scan { tcp | udp }
</p>
</li>
<li>
<p>
string <strong>wizard.spells[].service</strong>: name of service
</p>
</li>
<li>
<p>
string <strong>wizard.spells[].to_client[].spell</strong>: sequence of data with wild cards (*)
</p>
</li>
<li>
<p>
string <strong>wizard.spells[].to_server[].spell</strong>: sequence of data with wild cards (*)
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_counts">Counts</h3>
<div class="ulist"><ul>
<li>
<p>
<strong>arp_spoof.packets</strong>: total packets
</p>
</li>
<li>
<p>
<strong>back_orifice.packets</strong>: total packets
</p>
</li>
<li>
<p>
<strong>binder.allows</strong>: allow bindings
</p>
</li>
<li>
<p>
<strong>binder.blocks</strong>: block bindings
</p>
</li>
<li>
<p>
<strong>binder.inspects</strong>: inspect bindings
</p>
</li>
<li>
<p>
<strong>binder.packets</strong>: initial bindings
</p>
</li>
<li>
<p>
<strong>daq.allow</strong>: total allow verdicts
</p>
</li>
<li>
<p>
<strong>daq.analyzed</strong>: total packets analyzed from DAQ
</p>
</li>
<li>
<p>
<strong>daq.blacklist</strong>: total blacklist verdicts
</p>
</li>
<li>
<p>
<strong>daq.block</strong>: total block verdicts
</p>
</li>
<li>
<p>
<strong>daq.dropped</strong>: packets dropped
</p>
</li>
<li>
<p>
<strong>daq.fail open</strong>: packets passed during initialization
</p>
</li>
<li>
<p>
<strong>daq.filtered</strong>: packets filtered out
</p>
</li>
<li>
<p>
<strong>daq.idle</strong>: attempts to acquire from DAQ without available packets
</p>
</li>
<li>
<p>
<strong>daq.ignore</strong>: total ignore verdicts
</p>
</li>
<li>
<p>
<strong>daq.injected</strong>: active responses or replacements
</p>
</li>
<li>
<p>
<strong>daq.internal blacklist</strong>: packets blacklisted internally due to lack of DAQ support
</p>
</li>
<li>
<p>
<strong>daq.internal whitelist</strong>: packets whitelisted internally due to lack of DAQ support
</p>
</li>
<li>
<p>
<strong>daq.outstanding</strong>: packets unprocessed
</p>
</li>
<li>
<p>
<strong>daq.pcaps</strong>: total files processed
</p>
</li>
<li>
<p>
<strong>daq.received</strong>: total packets received from DAQ
</p>
</li>
<li>
<p>
<strong>daq.replace</strong>: total replace verdicts
</p>
</li>
<li>
<p>
<strong>daq.skipped</strong>: packets skipped at startup
</p>
</li>
<li>
<p>
<strong>daq.whitelist</strong>: total whitelist verdicts
</p>
</li>
<li>
<p>
<strong>detection.alert limit</strong>: events previously triggered on same PDU
</p>
</li>
<li>
<p>
<strong>detection.alerts</strong>: alerts not including IP reputation
</p>
</li>
<li>
<p>
<strong>detection.analyzed</strong>: packets sent to detection
</p>
</li>
<li>
<p>
<strong>detection.event limit</strong>: events filtered
</p>
</li>
<li>
<p>
<strong>detection.log limit</strong>: events queued but not logged
</p>
</li>
<li>
<p>
<strong>detection.logged</strong>: logged packets
</p>
</li>
<li>
<p>
<strong>detection.match limit</strong>: fast pattern matches not processed
</p>
</li>
<li>
<p>
<strong>detection.passed</strong>: passed packets
</p>
</li>
<li>
<p>
<strong>detection.queue limit</strong>: events not queued because queue full
</p>
</li>
<li>
<p>
<strong>detection.total alerts</strong>: alerts including IP reputation
</p>
</li>
<li>
<p>
<strong>ftp_data.packets</strong>: total packets
</p>
</li>
<li>
<p>
<strong>ftp_server.packets</strong>: total packets
</p>
</li>
<li>
<p>
<strong>http_global.compressed bytes</strong>: total comparessed bytes processed
</p>
</li>
<li>
<p>
<strong>http_global.decompressed bytes</strong>: total bytes decompressed
</p>
</li>
<li>
<p>
<strong>http_global.double unicode</strong>: double unicode normalizations
</p>
</li>
<li>
<p>
<strong>http_global.gets</strong>: GET requests
</p>
</li>
<li>
<p>
<strong>http_global.gzip packets</strong>: packets with gzip compression
</p>
</li>
<li>
<p>
<strong>http_global.non-ascii</strong>: non-ascii normalizations
</p>
</li>
<li>
<p>
<strong>http_global.packets</strong>: total packets processed
</p>
</li>
<li>
<p>
<strong>http_global.paths with ../</strong>: directory traversal normalizations
</p>
</li>
<li>
<p>
<strong>http_global.paths with ./</strong>: relative directory normalizations
</p>
</li>
<li>
<p>
<strong>http_global.paths with //</strong>: double slash normalizations
</p>
</li>
<li>
<p>
<strong>http_global.post params</strong>: POST parameters extracted
</p>
</li>
<li>
<p>
<strong>http_global.posts</strong>: POST requests
</p>
</li>
<li>
<p>
<strong>http_global.request cookies</strong>: requests with Cookie
</p>
</li>
<li>
<p>
<strong>http_global.request headers</strong>: total requests
</p>
</li>
<li>
<p>
<strong>http_global.response cookies</strong>: responses with Set-Cookie
</p>
</li>
<li>
<p>
<strong>http_global.response headers</strong>: total responses
</p>
</li>
<li>
<p>
<strong>http_global.unicode</strong>: unicode normalizations
</p>
</li>
<li>
<p>
<strong>icmp4.bad checksum</strong>: non-zero icmp checksums
</p>
</li>
<li>
<p>
<strong>icmp6.bad checksum (ip4)</strong>: nonzero ipcm4 checksums
</p>
</li>
<li>
<p>
<strong>icmp6.bad checksum (ip6)</strong>: nonzero ipcm6 checksums
</p>
</li>
<li>
<p>
<strong>ipv4.bad checksum</strong>: nonzero ip checksums
</p>
</li>
<li>
<p>
<strong>normalizer.icmp4 echo</strong>: icmp4 ping normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.icmp6 echo</strong>: icmp6 echo normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 df</strong>: don&#8217;t frag bit normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 opts</strong>: ip4 options cleared
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 rf</strong>: reserved flag bit clears
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 tos</strong>: type of service normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 trim</strong>: eth packets trimmed to datagram size
</p>
</li>
<li>
<p>
<strong>normalizer.ip4 ttl</strong>: time-to-live normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip6 hops</strong>: ip6 hop limit normalizations
</p>
</li>
<li>
<p>
<strong>normalizer.ip6 options</strong>: ip6 options cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp block</strong>: blocked segments
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ecn pkt</strong>: packets with ECN bits cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ecn session</strong>: ECN bits cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ips data</strong>: normalized segments
</p>
</li>
<li>
<p>
<strong>normalizer.tcp nonce</strong>: packets with nonce bit cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp options</strong>: packets with options cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp paddding</strong>: packets with padding cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp reserved</strong>: packets with reserved bits cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp syn options</strong>: SYN only options cleared from non-SYN packets
</p>
</li>
<li>
<p>
<strong>normalizer.tcp trim</strong>: tcp segments trimmed to correct size
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ts ecr</strong>: timestamp cleared on non-ACKs
</p>
</li>
<li>
<p>
<strong>normalizer.tcp ts nop</strong>: timestamp options cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp urgent flag</strong>: packets without urgent flag with urgent pointer cleared
</p>
</li>
<li>
<p>
<strong>normalizer.tcp urgent ptr</strong>: packets without data with urgent poniter cleared
</p>
</li>
<li>
<p>
<strong>perf_monitor.packets</strong>: total packets
</p>
</li>
<li>
<p>
<strong>port_scan_global.packets</strong>: total packets
</p>
</li>
<li>
<p>
<strong>rpc_decode.packets</strong>: total packets
</p>
</li>
<li>
<p>
<strong>snort.attribute table hosts</strong>: total number of hosts in table
</p>
</li>
<li>
<p>
<strong>snort.attribute table reloads</strong>: number of times hosts table was reloaded
</p>
</li>
<li>
<p>
<strong>snort.conf reloads</strong>: number of times configuration was reloaded
</p>
</li>
<li>
<p>
<strong>snort.local commands</strong>: total local commands processed
</p>
</li>
<li>
<p>
<strong>snort.remote commands</strong>: total remote commands processed
</p>
</li>
<li>
<p>
<strong>snort.signals</strong>: total signals processed
</p>
</li>
<li>
<p>
<strong>stream.icmp flows</strong>: total icmp sessions
</p>
</li>
<li>
<p>
<strong>stream.icmp prunes</strong>: icmp sessions pruned
</p>
</li>
<li>
<p>
<strong>stream.ip flows</strong>: total ip sessions
</p>
</li>
<li>
<p>
<strong>stream.ip prunes</strong>: ip sessions pruned
</p>
</li>
<li>
<p>
<strong>stream.tcp flows</strong>: total tcp sessions
</p>
</li>
<li>
<p>
<strong>stream.tcp prunes</strong>: tcp sessions pruned
</p>
</li>
<li>
<p>
<strong>stream.udp flows</strong>: total udp sessions
</p>
</li>
<li>
<p>
<strong>stream.udp prunes</strong>: udp sessions pruned
</p>
</li>
<li>
<p>
<strong>stream_icmp.created</strong>: icmp session trackers created
</p>
</li>
<li>
<p>
<strong>stream_icmp.released</strong>: icmp session trackers released
</p>
</li>
<li>
<p>
<strong>stream_ip.alerts</strong>: alerts generated
</p>
</li>
<li>
<p>
<strong>stream_ip.anomalies</strong>: anomalies detected
</p>
</li>
<li>
<p>
<strong>stream_ip.discards</strong>: fragments discarded
</p>
</li>
<li>
<p>
<strong>stream_ip.drops</strong>: fragments dropped
</p>
</li>
<li>
<p>
<strong>stream_ip.frag timeouts</strong>: datagrams abandoned
</p>
</li>
<li>
<p>
<strong>stream_ip.fragments</strong>: total fragments
</p>
</li>
<li>
<p>
<strong>stream_ip.memory faults</strong>: memory faults
</p>
</li>
<li>
<p>
<strong>stream_ip.nodes deleted</strong>: fragments deleted from tracker
</p>
</li>
<li>
<p>
<strong>stream_ip.nodes inserted</strong>: fragments added to tracker
</p>
</li>
<li>
<p>
<strong>stream_ip.overlaps</strong>: overlapping fragments
</p>
</li>
<li>
<p>
<strong>stream_ip.reassembled</strong>: reassembled datagrams
</p>
</li>
<li>
<p>
<strong>stream_ip.trackers added</strong>: datagram trackers created
</p>
</li>
<li>
<p>
<strong>stream_ip.trackers freed</strong>: datagram trackers released
</p>
</li>
<li>
<p>
<strong>stream_tcp.3way trackers</strong>: tcp session tracking started on ack
</p>
</li>
<li>
<p>
<strong>stream_tcp.client cleanups</strong>: number of times data from server was flushed when session released
</p>
</li>
<li>
<p>
<strong>stream_tcp.data trackers</strong>: tcp session tracking started on data
</p>
</li>
<li>
<p>
<strong>stream_tcp.discards</strong>: tcp packets discarded
</p>
</li>
<li>
<p>
<strong>stream_tcp.events</strong>: events generated
</p>
</li>
<li>
<p>
<strong>stream_tcp.gaps</strong>: missing data between PDUs
</p>
</li>
<li>
<p>
<strong>stream_tcp.ignored</strong>: tcp packets ignored
</p>
</li>
<li>
<p>
<strong>stream_tcp.internal events</strong>: 135:X events generated
</p>
</li>
<li>
<p>
<strong>stream_tcp.max bytes</strong>: number of times the maximum queued byte limit was reached
</p>
</li>
<li>
<p>
<strong>stream_tcp.max segs</strong>: number of times the maximum queued segment limit was reached
</p>
</li>
<li>
<p>
<strong>stream_tcp.overlaps</strong>: overlapping segments queued
</p>
</li>
<li>
<p>
<strong>stream_tcp.rebuilt buffers</strong>: rebuilt PDU sections
</p>
</li>
<li>
<p>
<strong>stream_tcp.rebuilt packets</strong>: total reassembled PDUs
</p>
</li>
<li>
<p>
<strong>stream_tcp.resyns</strong>: SYN received on established session
</p>
</li>
<li>
<p>
<strong>stream_tcp.segs queued</strong>: total segments queued
</p>
</li>
<li>
<p>
<strong>stream_tcp.segs released</strong>: total segments released
</p>
</li>
<li>
<p>
<strong>stream_tcp.segs split</strong>: tcp segments split when reassembling PDUs
</p>
</li>
<li>
<p>
<strong>stream_tcp.segs used</strong>: queued tcp segments applied to reassembled PDUs
</p>
</li>
<li>
<p>
<strong>stream_tcp.server cleanups</strong>: number of times data from client was flushed when session released
</p>
</li>
<li>
<p>
<strong>stream_tcp.sessions</strong>: total sessions
</p>
</li>
<li>
<p>
<strong>stream_tcp.syn trackers</strong>: tcp session tracking started on syn
</p>
</li>
<li>
<p>
<strong>stream_tcp.syn-ack trackers</strong>: tcp session tracking started on syn-ack
</p>
</li>
<li>
<p>
<strong>stream_tcp.timeouts</strong>: sessions timed out
</p>
</li>
<li>
<p>
<strong>stream_tcp.trackers created</strong>: tcp session trackers created
</p>
</li>
<li>
<p>
<strong>stream_tcp.trackers released</strong>: tcp session trackers released
</p>
</li>
<li>
<p>
<strong>stream_tcp.untracked</strong>: tcp packets not tracked
</p>
</li>
<li>
<p>
<strong>stream_udp.created</strong>: udp session trackers created
</p>
</li>
<li>
<p>
<strong>stream_udp.released</strong>: udp session trackers released
</p>
</li>
<li>
<p>
<strong>stream_udp.sessions</strong>: total udp sessions
</p>
</li>
<li>
<p>
<strong>stream_udp.timeouts</strong>: udp session timeouts
</p>
</li>
<li>
<p>
<strong>tcp.bad checksum (ip4)</strong>: nonzero tcp over ip checksums
</p>
</li>
<li>
<p>
<strong>tcp.bad checksum (ip6)</strong>: nonzero tcp over ipv6 checksums
</p>
</li>
<li>
<p>
<strong>telnet.packets</strong>: total packets
</p>
</li>
<li>
<p>
<strong>udp.bad checksum (ip4)</strong>: nonzero udp over ipv4 checksums
</p>
</li>
<li>
<p>
<strong>udp.bad checksum (ip6)</strong>: nonzero udp over ipv6 checksums
</p>
</li>
<li>
<p>
<strong>wizard.tcp hits</strong>: tcp identifications
</p>
</li>
<li>
<p>
<strong>wizard.tcp scans</strong>: tcp payload scans
</p>
</li>
<li>
<p>
<strong>wizard.udp hits</strong>: udp identifications
</p>
</li>
<li>
<p>
<strong>wizard.udp scans</strong>: udp payload scans
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_generators">Generators</h3>
<div class="ulist"><ul>
<li>
<p>
<strong>105</strong>: back_orifice
</p>
</li>
<li>
<p>
<strong>106</strong>: rpc_decode
</p>
</li>
<li>
<p>
<strong>112</strong>: arp_spoof
</p>
</li>
<li>
<p>
<strong>116</strong>: arp
</p>
</li>
<li>
<p>
<strong>116</strong>: auth
</p>
</li>
<li>
<p>
<strong>116</strong>: decode
</p>
</li>
<li>
<p>
<strong>116</strong>: eapol
</p>
</li>
<li>
<p>
<strong>116</strong>: erspan2
</p>
</li>
<li>
<p>
<strong>116</strong>: erspan3
</p>
</li>
<li>
<p>
<strong>116</strong>: esp
</p>
</li>
<li>
<p>
<strong>116</strong>: eth
</p>
</li>
<li>
<p>
<strong>116</strong>: gre
</p>
</li>
<li>
<p>
<strong>116</strong>: gtp
</p>
</li>
<li>
<p>
<strong>116</strong>: icmp4
</p>
</li>
<li>
<p>
<strong>116</strong>: icmp6
</p>
</li>
<li>
<p>
<strong>116</strong>: igmp
</p>
</li>
<li>
<p>
<strong>116</strong>: ipv4
</p>
</li>
<li>
<p>
<strong>116</strong>: ipv6
</p>
</li>
<li>
<p>
<strong>116</strong>: mpls
</p>
</li>
<li>
<p>
<strong>116</strong>: pgm
</p>
</li>
<li>
<p>
<strong>116</strong>: pppoe
</p>
</li>
<li>
<p>
<strong>116</strong>: tcp
</p>
</li>
<li>
<p>
<strong>116</strong>: udp
</p>
</li>
<li>
<p>
<strong>116</strong>: vlan
</p>
</li>
<li>
<p>
<strong>116</strong>: wlan
</p>
</li>
<li>
<p>
<strong>119</strong>: http_global
</p>
</li>
<li>
<p>
<strong>120</strong>: http_inspect
</p>
</li>
<li>
<p>
<strong>122</strong>: port_scan
</p>
</li>
<li>
<p>
<strong>123</strong>: stream_ip
</p>
</li>
<li>
<p>
<strong>125</strong>: ftp_server
</p>
</li>
<li>
<p>
<strong>126</strong>: telnet
</p>
</li>
<li>
<p>
<strong>129</strong>: stream_tcp
</p>
</li>
<li>
<p>
<strong>134</strong>: ppm
</p>
</li>
<li>
<p>
<strong>219</strong>: new_http_inspect
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_builtin_rules">Builtin Rules</h3>
<div class="ulist"><ul>
<li>
<p>
<strong>105:1</strong> (back_orifice) BO traffic detected
</p>
</li>
<li>
<p>
<strong>105:2</strong> (back_orifice) BO client traffic detected
</p>
</li>
<li>
<p>
<strong>105:3</strong> (back_orifice) BO server traffic detected
</p>
</li>
<li>
<p>
<strong>105:4</strong> (back_orifice) BO Snort buffer attack
</p>
</li>
<li>
<p>
<strong>106:1</strong> (rpc_decode) fragmented RPC records
</p>
</li>
<li>
<p>
<strong>106:2</strong> (rpc_decode) multiple RPC records
</p>
</li>
<li>
<p>
<strong>106:3</strong> (rpc_decode) large RPC record fragment
</p>
</li>
<li>
<p>
<strong>106:4</strong> (rpc_decode) incomplete RPC segment
</p>
</li>
<li>
<p>
<strong>106:5</strong> (rpc_decode) zero-length RPC fragment
</p>
</li>
<li>
<p>
<strong>112:1</strong> (arp_spoof) unicast ARP request
</p>
</li>
<li>
<p>
<strong>112:2</strong> (arp_spoof) ethernet/ARP mismatch request for source
</p>
</li>
<li>
<p>
<strong>112:3</strong> (arp_spoof) ethernet/ARP mismatch request for destination
</p>
</li>
<li>
<p>
<strong>112:4</strong> (arp_spoof) attempted ARP cache overwrite attack
</p>
</li>
<li>
<p>
<strong>116:1</strong> (ipv4) Not IPv4 datagram
</p>
</li>
<li>
<p>
<strong>116:2</strong> (ipv4) hlen &lt; minimum
</p>
</li>
<li>
<p>
<strong>116:3</strong> (ipv4) IP dgm len &lt; IP Hdr len
</p>
</li>
<li>
<p>
<strong>116:4</strong> (ipv4) Ipv4 Options found with bad lengths
</p>
</li>
<li>
<p>
<strong>116:5</strong> (ipv4) Truncated Ipv4 Options
</p>
</li>
<li>
<p>
<strong>116:6</strong> (ipv4) IP dgm len &gt; captured len
</p>
</li>
<li>
<p>
<strong>116:45</strong> (tcp) TCP packet len is smaller than 20 bytes
</p>
</li>
<li>
<p>
<strong>116:46</strong> (tcp) TCP data offset is less than 5
</p>
</li>
<li>
<p>
<strong>116:47</strong> (tcp) TCP header length exceeds packet length
</p>
</li>
<li>
<p>
<strong>116:54</strong> (tcp) TCP options found with bad lengths
</p>
</li>
<li>
<p>
<strong>116:55</strong> (tcp) truncated TCP options
</p>
</li>
<li>
<p>
<strong>116:56</strong> (tcp) T/TCP detected
</p>
</li>
<li>
<p>
<strong>116:57</strong> (tcp) obsolete TCP options found
</p>
</li>
<li>
<p>
<strong>116:58</strong> (tcp) experimental TCP options found
</p>
</li>
<li>
<p>
<strong>116:59</strong> (tcp) TCP window scale option found with length &gt; 14
</p>
</li>
<li>
<p>
<strong>116:95</strong> (udp) truncated UDP header
</p>
</li>
<li>
<p>
<strong>116:96</strong> (udp) invalid UDP header, length field &lt; 8
</p>
</li>
<li>
<p>
<strong>116:97</strong> (udp) short UDP packet, length field &gt; payload length
</p>
</li>
<li>
<p>
<strong>116:98</strong> (udp) long UDP packet, length field &lt; payload length
</p>
</li>
<li>
<p>
<strong>116:105</strong> (icmp4) ICMP header truncated
</p>
</li>
<li>
<p>
<strong>116:106</strong> (icmp4) ICMP timestamp header truncated
</p>
</li>
<li>
<p>
<strong>116:107</strong> (icmp4) ICMP address header truncated
</p>
</li>
<li>
<p>
<strong>116:109</strong> (arp) truncated ARP
</p>
</li>
<li>
<p>
<strong>116:110</strong> (eapol) truncated EAP header
</p>
</li>
<li>
<p>
<strong>116:111</strong> (eapol) EAP key truncated
</p>
</li>
<li>
<p>
<strong>116:112</strong> (eapol) EAP header truncated
</p>
</li>
<li>
<p>
<strong>116:120</strong> (pppoe) bad PPPOE frame detected
</p>
</li>
<li>
<p>
<strong>116:130</strong> (vlan) bad VLAN frame
</p>
</li>
<li>
<p>
<strong>116:131</strong> (vlan) bad LLC header
</p>
</li>
<li>
<p>
<strong>116:132</strong> (vlan) bad extra LLC info
</p>
</li>
<li>
<p>
<strong>116:133</strong> (wlan) bad 802.11 LLC header
</p>
</li>
<li>
<p>
<strong>116:134</strong> (wlan) bad 802.11 extra LLC info
</p>
</li>
<li>
<p>
<strong>116:150</strong> (decode) bad traffic loopback IP
</p>
</li>
<li>
<p>
<strong>116:151</strong> (decode) bad traffic same src/dst IP
</p>
</li>
<li>
<p>
<strong>116:160</strong> (gre) GRE header length &gt; payload length
</p>
</li>
<li>
<p>
<strong>116:161</strong> (gre) multiple encapsulations in packet
</p>
</li>
<li>
<p>
<strong>116:162</strong> (gre) invalid GRE version
</p>
</li>
<li>
<p>
<strong>116:163</strong> (gre) invalid GRE header
</p>
</li>
<li>
<p>
<strong>116:164</strong> (gre) invalid GRE v.1 PPTP header
</p>
</li>
<li>
<p>
<strong>116:165</strong> (gre) GRE trans header length &gt; payload length
</p>
</li>
<li>
<p>
<strong>116:170</strong> (mpls) bad MPLS frame
</p>
</li>
<li>
<p>
<strong>116:171</strong> (mpls) MPLS label 0 appears in non-bottom header
</p>
</li>
<li>
<p>
<strong>116:172</strong> (mpls) MPLS label 1 appears in bottom header
</p>
</li>
<li>
<p>
<strong>116:173</strong> (mpls) MPLS label 2 appears in non-bottom header
</p>
</li>
<li>
<p>
<strong>116:174</strong> (mpls) MPLS label 3 appears in header
</p>
</li>
<li>
<p>
<strong>116:175</strong> (mpls) MPLS label 4, 5,.. or 15 appears in header
</p>
</li>
<li>
<p>
<strong>116:176</strong> (mpls) too many MPLS headers
</p>
</li>
<li>
<p>
<strong>116:250</strong> (icmp4) ICMP original IP header truncated
</p>
</li>
<li>
<p>
<strong>116:251</strong> (icmp4) ICMP version and original IP header versions differ
</p>
</li>
<li>
<p>
<strong>116:252</strong> (icmp4) ICMP original datagram length &lt; original IP header length
</p>
</li>
<li>
<p>
<strong>116:253</strong> (icmp4) ICMP original IP payload &lt; 64 bits
</p>
</li>
<li>
<p>
<strong>116:254</strong> (icmp4) ICMP original IP payload &gt; 576 bytes
</p>
</li>
<li>
<p>
<strong>116:255</strong> (icmp4) ICMP original IP fragmented and offset not 0
</p>
</li>
<li>
<p>
<strong>116:270</strong> (ipv6) IPv6 packet below TTL limit
</p>
</li>
<li>
<p>
<strong>116:271</strong> (ipv6) IPv6 header claims to not be IPv6
</p>
</li>
<li>
<p>
<strong>116:272</strong> (ipv6) IPV6 truncated extension header
</p>
</li>
<li>
<p>
<strong>116:273</strong> (ipv6) IPV6 truncated header
</p>
</li>
<li>
<p>
<strong>116:274</strong> (ipv6) IP dgm len &lt; IP Hdr len
</p>
</li>
<li>
<p>
<strong>116:275</strong> (ipv6) IP dgm len &gt; captured len
</p>
</li>
<li>
<p>
<strong>116:276</strong> (ipv6) IPv6 packet with destination address ::0
</p>
</li>
<li>
<p>
<strong>116:277</strong> (ipv6) IPv6 packet with multicast source address
</p>
</li>
<li>
<p>
<strong>116:278</strong> (ipv6) IPv6 packet with reserved multicast destination address
</p>
</li>
<li>
<p>
<strong>116:279</strong> (ipv6) IPv6 header includes an undefined option type
</p>
</li>
<li>
<p>
<strong>116:280</strong> (ipv6) IPv6 address includes an unassigned multicast scope value
</p>
</li>
<li>
<p>
<strong>116:281</strong> (ipv6) IPv6 header includes an invalid value for the <em>next header</em> field
</p>
</li>
<li>
<p>
<strong>116:282</strong> (ipv6) IPv6 header includes a routing extension header followed by a hop-by-hop header
</p>
</li>
<li>
<p>
<strong>116:283</strong> (ipv6) IPv6 header includes two routing extension headers
</p>
</li>
<li>
<p>
<strong>116:285</strong> (icmp6) ICMPv6 packet of type 2 (message too big) with MTU field &lt; 1280
</p>
</li>
<li>
<p>
<strong>116:286</strong> (icmp6) ICMPv6 packet of type 1 (destination unreachable) with non-RFC 2463 code
</p>
</li>
<li>
<p>
<strong>116:287</strong> (icmp6) ICMPv6 router solicitation packet with a code not equal to 0
</p>
</li>
<li>
<p>
<strong>116:288</strong> (icmp6) ICMPv6 router advertisement packet with a code not equal to 0
</p>
</li>
<li>
<p>
<strong>116:289</strong> (icmp6) ICMPv6 router solicitation packet with the reserved field not equal to 0
</p>
</li>
<li>
<p>
<strong>116:290</strong> (icmp6) ICMPv6 router advertisement packet with the reachable time field set &gt; 1 hour
</p>
</li>
<li>
<p>
<strong>116:291</strong> (ipv6) IPV6 tunneled over IPv4, IPv6 header truncated, possible Linux kernel attack
</p>
</li>
<li>
<p>
<strong>116:292</strong> (ipv6) IPv6 header has destination options followed by a routing header
</p>
</li>
<li>
<p>
<strong>116:293</strong> (decode) two or more IP (v4 and/or v6) encapsulation layers present
</p>
</li>
<li>
<p>
<strong>116:294</strong> (esp) truncated encapsulated security payload header
</p>
</li>
<li>
<p>
<strong>116:295</strong> (ipv6) IPv6 header includes an option which is too big for the containing header
</p>
</li>
<li>
<p>
<strong>116:296</strong> (ipv6) IPv6 packet includes out-of-order extension headers
</p>
</li>
<li>
<p>
<strong>116:297</strong> (gtp) two or more GTP encapsulation layers present
</p>
</li>
<li>
<p>
<strong>116:298</strong> (gtp) GTP header length is invalid
</p>
</li>
<li>
<p>
<strong>116:400</strong> (tcp) XMAS attack detected
</p>
</li>
<li>
<p>
<strong>116:401</strong> (tcp) Nmap XMAS attack detected
</p>
</li>
<li>
<p>
<strong>116:402</strong> (tcp) DOS NAPTHA vulnerability detected
</p>
</li>
<li>
<p>
<strong>116:403</strong> (tcp) bad traffic SYN to multicast address
</p>
</li>
<li>
<p>
<strong>116:404</strong> (ipv4) IPV4 packet with zero TTL
</p>
</li>
<li>
<p>
<strong>116:405</strong> (ipv4) IPV4 packet with bad frag bits (both MF and DF set)
</p>
</li>
<li>
<p>
<strong>116:406</strong> (udp) invalid IPv6 UDP packet, checksum zero
</p>
</li>
<li>
<p>
<strong>116:407</strong> (ipv4) IPV4 packet frag offset + length exceed maximum
</p>
</li>
<li>
<p>
<strong>116:408</strong> (ipv4) IPV4 packet from <em>current net</em> source address
</p>
</li>
<li>
<p>
<strong>116:409</strong> (ipv4) IPV4 packet to <em>current net</em> dest address
</p>
</li>
<li>
<p>
<strong>116:410</strong> (ipv4) IPV4 packet from multicast source address
</p>
</li>
<li>
<p>
<strong>116:411</strong> (ipv4) IPV4 packet from reserved source address
</p>
</li>
<li>
<p>
<strong>116:412</strong> (ipv4) IPV4 packet to reserved dest address
</p>
</li>
<li>
<p>
<strong>116:413</strong> (ipv4) IPV4 packet from broadcast source address
</p>
</li>
<li>
<p>
<strong>116:414</strong> (ipv4) IPV4 packet to broadcast dest address
</p>
</li>
<li>
<p>
<strong>116:415</strong> (icmp4) ICMP4 packet to multicast dest address
</p>
</li>
<li>
<p>
<strong>116:416</strong> (icmp4) ICMP4 packet to broadcast dest address
</p>
</li>
<li>
<p>
<strong>116:418</strong> (icmp4) ICMP4 type other
</p>
</li>
<li>
<p>
<strong>116:419</strong> (tcp) TCP urgent pointer exceeds payload length or no payload
</p>
</li>
<li>
<p>
<strong>116:420</strong> (tcp) TCP SYN with FIN
</p>
</li>
<li>
<p>
<strong>116:421</strong> (tcp) TCP SYN with RST
</p>
</li>
<li>
<p>
<strong>116:422</strong> (tcp) TCP PDU missing ack for established session
</p>
</li>
<li>
<p>
<strong>116:423</strong> (tcp) TCP has no SYN, ACK, or RST
</p>
</li>
<li>
<p>
<strong>116:424</strong> (eth) truncated eth header
</p>
</li>
<li>
<p>
<strong>116:425</strong> (ipv4) truncated IP4 header
</p>
</li>
<li>
<p>
<strong>116:426</strong> (icmp4) truncated ICMP4 header
</p>
</li>
<li>
<p>
<strong>116:427</strong> (icmp6) truncated ICMP6 header
</p>
</li>
<li>
<p>
<strong>116:428</strong> (ipv4) IPV4 packet below TTL limit
</p>
</li>
<li>
<p>
<strong>116:429</strong> (ipv6) IPV6 packet has zero hop limit
</p>
</li>
<li>
<p>
<strong>116:430</strong> (ipv4) IPV4 packet both DF and offset set
</p>
</li>
<li>
<p>
<strong>116:431</strong> (icmp6) ICMP6 type not decoded
</p>
</li>
<li>
<p>
<strong>116:432</strong> (icmp6) ICMP6 packet to multicast address
</p>
</li>
<li>
<p>
<strong>116:433</strong> (tcp) DDOS shaft SYN flood
</p>
</li>
<li>
<p>
<strong>116:434</strong> (icmp4) ICMP ping NMAP
</p>
</li>
<li>
<p>
<strong>116:435</strong> (icmp4) ICMP icmpenum v1.1.1
</p>
</li>
<li>
<p>
<strong>116:436</strong> (icmp4) ICMP redirect host
</p>
</li>
<li>
<p>
<strong>116:437</strong> (icmp4) ICMP redirect net
</p>
</li>
<li>
<p>
<strong>116:438</strong> (icmp4) ICMP traceroute ipopts
</p>
</li>
<li>
<p>
<strong>116:439</strong> (icmp4) ICMP source quench
</p>
</li>
<li>
<p>
<strong>116:440</strong> (icmp4) broadscan smurf scanner
</p>
</li>
<li>
<p>
<strong>116:441</strong> (icmp4) ICMP destination unreachable communication administratively prohibited
</p>
</li>
<li>
<p>
<strong>116:442</strong> (icmp4) ICMP destination unreachable communication with destination host is administratively prohibited
</p>
</li>
<li>
<p>
<strong>116:443</strong> (icmp4) ICMP destination unreachable communication with destination network is administratively prohibited
</p>
</li>
<li>
<p>
<strong>116:444</strong> (ipv4) MISC IP option set
</p>
</li>
<li>
<p>
<strong>116:445</strong> (udp) misc large UDP Packet
</p>
</li>
<li>
<p>
<strong>116:446</strong> (tcp) BAD-TRAFFIC TCP port 0 traffic
</p>
</li>
<li>
<p>
<strong>116:447</strong> (udp) BAD-TRAFFIC UDP port 0 traffic
</p>
</li>
<li>
<p>
<strong>116:448</strong> (ipv4) BAD-TRAFFIC IP reserved bit set
</p>
</li>
<li>
<p>
<strong>116:449</strong> (ipv4) BAD-TRAFFIC unassigned/reserved IP protocol
</p>
</li>
<li>
<p>
<strong>116:450</strong> (decode) BAD-TRAFFIC bad IP protocol
</p>
</li>
<li>
<p>
<strong>116:451</strong> (icmp4) ICMP path MTU denial of service attempt
</p>
</li>
<li>
<p>
<strong>116:452</strong> (icmp4) BAD-TRAFFIC Linux ICMP header DOS attempt
</p>
</li>
<li>
<p>
<strong>116:453</strong> (ipv6) BAD-TRAFFIC ISATAP-addressed IPv6 traffic spoofing attempt
</p>
</li>
<li>
<p>
<strong>116:454</strong> (pgm) BAD-TRAFFIC PGM nak list overflow attempt
</p>
</li>
<li>
<p>
<strong>116:455</strong> (igmp) DOS IGMP IP options validation attempt
</p>
</li>
<li>
<p>
<strong>116:456</strong> (ipv6) too many IP6 extension headers
</p>
</li>
<li>
<p>
<strong>116:457</strong> (icmp6) ICMPv6 packet of type 1 (destination unreachable) with non-RFC 4443 code
</p>
</li>
<li>
<p>
<strong>116:458</strong> (ipv6) bogus fragmentation packet, possible BSD attack
</p>
</li>
<li>
<p>
<strong>116:459</strong> (decode) fragment with zero length
</p>
</li>
<li>
<p>
<strong>116:460</strong> (icmp6) ICMPv6 node info query/response packet with a code greater than 2
</p>
</li>
<li>
<p>
<strong>116:461</strong> (ipv6) IPV6 routing type 0 extension header
</p>
</li>
<li>
<p>
<strong>116:462</strong> (erspan2) ERSpan header version mismatch
</p>
</li>
<li>
<p>
<strong>116:463</strong> (erspan2) captured &lt; ERSpan type2 header length
</p>
</li>
<li>
<p>
<strong>116:464</strong> (erspan3) captured &lt; ERSpan type3 header length
</p>
</li>
<li>
<p>
<strong>116:465</strong> (auth) truncated authentication header
</p>
</li>
<li>
<p>
<strong>116:466</strong> (auth) bad authentication header length
</p>
</li>
<li>
<p>
<strong>116:467</strong> (decode) too many protocols present
</p>
</li>
<li>
<p>
<strong>119:1</strong> (http_global) ascii encoding
</p>
</li>
<li>
<p>
<strong>119:2</strong> (http_global) double decoding attack
</p>
</li>
<li>
<p>
<strong>119:3</strong> (http_global) u encoding
</p>
</li>
<li>
<p>
<strong>119:4</strong> (http_global) bare byte unicode encoding
</p>
</li>
<li>
<p>
<strong>119:5</strong> (http_global) base36 encoding
</p>
</li>
<li>
<p>
<strong>119:6</strong> (http_global) UTF-8 encoding
</p>
</li>
<li>
<p>
<strong>119:7</strong> (http_global) IIS unicode codepoint encoding
</p>
</li>
<li>
<p>
<strong>119:8</strong> (http_global) multi_slash encoding
</p>
</li>
<li>
<p>
<strong>119:9</strong> (http_global) IIS backslash evasion
</p>
</li>
<li>
<p>
<strong>119:10</strong> (http_global) self directory traversal
</p>
</li>
<li>
<p>
<strong>119:11</strong> (http_global) directory traversal
</p>
</li>
<li>
<p>
<strong>119:12</strong> (http_global) apache whitespace (tab)
</p>
</li>
<li>
<p>
<strong>119:13</strong> (http_global) non-RFC http delimiter
</p>
</li>
<li>
<p>
<strong>119:14</strong> (http_global) non-RFC defined char
</p>
</li>
<li>
<p>
<strong>119:15</strong> (http_global) oversize request-URI directory
</p>
</li>
<li>
<p>
<strong>119:16</strong> (http_global) oversize chunk encoding
</p>
</li>
<li>
<p>
<strong>119:17</strong> (http_global) unauthorized proxy use detected
</p>
</li>
<li>
<p>
<strong>119:18</strong> (http_global) webroot directory traversal
</p>
</li>
<li>
<p>
<strong>119:19</strong> (http_global) long header
</p>
</li>
<li>
<p>
<strong>119:20</strong> (http_global) max header fields
</p>
</li>
<li>
<p>
<strong>119:21</strong> (http_global) multiple content length
</p>
</li>
<li>
<p>
<strong>119:22</strong> (http_global) chunk size mismatch detected
</p>
</li>
<li>
<p>
<strong>119:23</strong> (http_global) invalid ip in true-client-IP/XFF header
</p>
</li>
<li>
<p>
<strong>119:24</strong> (http_global) multiple host hdrs detected
</p>
</li>
<li>
<p>
<strong>119:25</strong> (http_global) hostname exceeds 255 characters
</p>
</li>
<li>
<p>
<strong>119:26</strong> (http_global) header parsing space saturation
</p>
</li>
<li>
<p>
<strong>119:27</strong> (http_global) client consecutive small chunk sizes
</p>
</li>
<li>
<p>
<strong>119:28</strong> (http_global) post w/o content-length or chunks
</p>
</li>
<li>
<p>
<strong>119:29</strong> (http_global) multiple true IPs in a session
</p>
</li>
<li>
<p>
<strong>119:30</strong> (http_global) both true-client-IP and XFF hdrs present
</p>
</li>
<li>
<p>
<strong>119:31</strong> (http_global) unknown method
</p>
</li>
<li>
<p>
<strong>119:32</strong> (http_global) simple request
</p>
</li>
<li>
<p>
<strong>119:33</strong> (http_global) unescaped space in http URI
</p>
</li>
<li>
<p>
<strong>119:34</strong> (http_global) too many pipelined requests
</p>
</li>
<li>
<p>
<strong>120:1</strong> (http_inspect) anomalous http server on undefined HTTP port
</p>
</li>
<li>
<p>
<strong>120:2</strong> (http_inspect) invalid status code in HTTP response
</p>
</li>
<li>
<p>
<strong>120:3</strong> (http_inspect) no content-length or transfer-encoding in HTTP response
</p>
</li>
<li>
<p>
<strong>120:4</strong> (http_inspect) HTTP response has UTF charset which failed to normalize
</p>
</li>
<li>
<p>
<strong>120:5</strong> (http_inspect) HTTP response has UTF-7 charset
</p>
</li>
<li>
<p>
<strong>120:6</strong> (http_inspect) HTTP response gzip decompression failed
</p>
</li>
<li>
<p>
<strong>120:7</strong> (http_inspect) server consecutive small chunk sizes
</p>
</li>
<li>
<p>
<strong>120:8</strong> (http_inspect) invalid content-length or chunk size
</p>
</li>
<li>
<p>
<strong>120:9</strong> (http_inspect) javascript obfuscation levels exceeds 1
</p>
</li>
<li>
<p>
<strong>120:10</strong> (http_inspect) javascript whitespaces exceeds max allowed
</p>
</li>
<li>
<p>
<strong>120:11</strong> (http_inspect) multiple encodings within javascript obfuscated data
</p>
</li>
<li>
<p>
<strong>122:1</strong> (port_scan) TCP portscan
</p>
</li>
<li>
<p>
<strong>122:2</strong> (port_scan) TCP decoy portscan
</p>
</li>
<li>
<p>
<strong>122:3</strong> (port_scan) TCP portsweep
</p>
</li>
<li>
<p>
<strong>122:4</strong> (port_scan) TCP distributed portscan
</p>
</li>
<li>
<p>
<strong>122:5</strong> (port_scan) TCP filtered portscan
</p>
</li>
<li>
<p>
<strong>122:6</strong> (port_scan) TCP filtered decoy portscan
</p>
</li>
<li>
<p>
<strong>122:7</strong> (port_scan) TCP filtered portsweep
</p>
</li>
<li>
<p>
<strong>122:8</strong> (port_scan) TCP filtered distributed portscan
</p>
</li>
<li>
<p>
<strong>122:9</strong> (port_scan) IP protocol scan
</p>
</li>
<li>
<p>
<strong>122:10</strong> (port_scan) IP decoy protocol scan
</p>
</li>
<li>
<p>
<strong>122:11</strong> (port_scan) IP protocol sweep
</p>
</li>
<li>
<p>
<strong>122:12</strong> (port_scan) IP distributed protocol scan
</p>
</li>
<li>
<p>
<strong>122:13</strong> (port_scan) IP filtered protocol scan
</p>
</li>
<li>
<p>
<strong>122:14</strong> (port_scan) IP filtered decoy protocol scan
</p>
</li>
<li>
<p>
<strong>122:15</strong> (port_scan) IP filtered protocol sweep
</p>
</li>
<li>
<p>
<strong>122:16</strong> (port_scan) IP filtered distributed protocol scan
</p>
</li>
<li>
<p>
<strong>122:17</strong> (port_scan) UDP portscan
</p>
</li>
<li>
<p>
<strong>122:18</strong> (port_scan) UDP decoy portscan
</p>
</li>
<li>
<p>
<strong>122:19</strong> (port_scan) UDP portsweep
</p>
</li>
<li>
<p>
<strong>122:20</strong> (port_scan) UDP distributed portscan
</p>
</li>
<li>
<p>
<strong>122:21</strong> (port_scan) UDP filtered portscan
</p>
</li>
<li>
<p>
<strong>122:22</strong> (port_scan) UDP filtered decoy portscan
</p>
</li>
<li>
<p>
<strong>122:23</strong> (port_scan) UDP filtered portsweep
</p>
</li>
<li>
<p>
<strong>122:24</strong> (port_scan) UDP filtered distributed portscan
</p>
</li>
<li>
<p>
<strong>122:25</strong> (port_scan) ICMP sweep
</p>
</li>
<li>
<p>
<strong>122:26</strong> (port_scan) ICMP filtered sweep
</p>
</li>
<li>
<p>
<strong>122:27</strong> (port_scan) open port
</p>
</li>
<li>
<p>
<strong>123:1</strong> (stream_ip) inconsistent IP options on fragmented packets
</p>
</li>
<li>
<p>
<strong>123:2</strong> (stream_ip) teardrop attack
</p>
</li>
<li>
<p>
<strong>123:3</strong> (stream_ip) short fragment, possible DOS attempt
</p>
</li>
<li>
<p>
<strong>123:4</strong> (stream_ip) fragment packet ends after defragmented packet
</p>
</li>
<li>
<p>
<strong>123:5</strong> (stream_ip) zero-byte fragment packet
</p>
</li>
<li>
<p>
<strong>123:6</strong> (stream_ip) bad fragment size, packet size is negative
</p>
</li>
<li>
<p>
<strong>123:7</strong> (stream_ip) bad fragment size, packet size is greater than 65536
</p>
</li>
<li>
<p>
<strong>123:8</strong> (stream_ip) fragmentation overlap
</p>
</li>
<li>
<p>
<strong>123:11</strong> (stream_ip) TTL value less than configured minimum, not using for reassembly
</p>
</li>
<li>
<p>
<strong>123:12</strong> (stream_ip) excessive fragment overlap
</p>
</li>
<li>
<p>
<strong>123:13</strong> (stream_ip) tiny fragment
</p>
</li>
<li>
<p>
<strong>125:1</strong> (ftp_server) TELNET cmd on FTP command channel
</p>
</li>
<li>
<p>
<strong>125:2</strong> (ftp_server) invalid FTP command
</p>
</li>
<li>
<p>
<strong>125:3</strong> (ftp_server) FTP command parameters were too long
</p>
</li>
<li>
<p>
<strong>125:4</strong> (ftp_server) FTP command parameters were malformed
</p>
</li>
<li>
<p>
<strong>125:5</strong> (ftp_server) FTP command parameters contained potential string format
</p>
</li>
<li>
<p>
<strong>125:6</strong> (ftp_server) FTP response message was too long
</p>
</li>
<li>
<p>
<strong>125:7</strong> (ftp_server) FTP traffic encrypted
</p>
</li>
<li>
<p>
<strong>125:8</strong> (ftp_server) FTP bounce attempt
</p>
</li>
<li>
<p>
<strong>125:9</strong> (ftp_server) evasive (incomplete) TELNET cmd on FTP command channel
</p>
</li>
<li>
<p>
<strong>126:1</strong> (telnet) consecutive telnet AYT commands beyond threshold
</p>
</li>
<li>
<p>
<strong>126:2</strong> (telnet) telnet traffic encrypted
</p>
</li>
<li>
<p>
<strong>126:3</strong> (telnet) telnet subnegotiation begin command without subnegotiation end
</p>
</li>
<li>
<p>
<strong>129:1</strong> (stream_tcp) SYN on established session
</p>
</li>
<li>
<p>
<strong>129:2</strong> (stream_tcp) data on SYN packet
</p>
</li>
<li>
<p>
<strong>129:3</strong> (stream_tcp) data sent on stream not accepting data
</p>
</li>
<li>
<p>
<strong>129:4</strong> (stream_tcp) TCP timestamp is outside of PAWS window
</p>
</li>
<li>
<p>
<strong>129:5</strong> (stream_tcp) bad segment, adjusted size &#8656; 0
</p>
</li>
<li>
<p>
<strong>129:6</strong> (stream_tcp) window size (after scaling) larger than policy allows
</p>
</li>
<li>
<p>
<strong>129:7</strong> (stream_tcp) limit on number of overlapping TCP packets reached
</p>
</li>
<li>
<p>
<strong>129:8</strong> (stream_tcp) data sent on stream after TCP Reset sent
</p>
</li>
<li>
<p>
<strong>129:9</strong> (stream_tcp) TCP client possibly hijacked, different ethernet address
</p>
</li>
<li>
<p>
<strong>129:10</strong> (stream_tcp) TCP Server possibly hijacked, different ethernet address
</p>
</li>
<li>
<p>
<strong>129:11</strong> (stream_tcp) TCP data with no TCP flags set
</p>
</li>
<li>
<p>
<strong>129:12</strong> (stream_tcp) consecutive TCP small segments exceeding threshold
</p>
</li>
<li>
<p>
<strong>129:13</strong> (stream_tcp) 4-way handshake detected
</p>
</li>
<li>
<p>
<strong>129:14</strong> (stream_tcp) TCP timestamp is missing
</p>
</li>
<li>
<p>
<strong>129:15</strong> (stream_tcp) reset outside window
</p>
</li>
<li>
<p>
<strong>129:16</strong> (stream_tcp) FIN number is greater than prior FIN
</p>
</li>
<li>
<p>
<strong>129:17</strong> (stream_tcp) ACK number is greater than prior FIN
</p>
</li>
<li>
<p>
<strong>129:18</strong> (stream_tcp) data sent on stream after TCP Reset received
</p>
</li>
<li>
<p>
<strong>129:19</strong> (stream_tcp) TCP window closed before receiving data
</p>
</li>
<li>
<p>
<strong>129:20</strong> (stream_tcp) TCP session without 3-way handshake
</p>
</li>
<li>
<p>
<strong>134:1</strong> (ppm) rule options disabled by rule latency
</p>
</li>
<li>
<p>
<strong>134:2</strong> (ppm) rule options re-enabled by rule latency
</p>
</li>
<li>
<p>
<strong>134:3</strong> (ppm) packet aborted due to latency
</p>
</li>
<li>
<p>
<strong>219:1</strong> (new_http_inspect) ascii encoding
</p>
</li>
<li>
<p>
<strong>219:2</strong> (new_http_inspect) double decoding attack
</p>
</li>
<li>
<p>
<strong>219:3</strong> (new_http_inspect) u encoding
</p>
</li>
<li>
<p>
<strong>219:4</strong> (new_http_inspect) bare byte unicode encoding
</p>
</li>
<li>
<p>
<strong>219:5</strong> (new_http_inspect) obsolete event&#8212;should not appear
</p>
</li>
<li>
<p>
<strong>219:6</strong> (new_http_inspect) UTF-8 encoding
</p>
</li>
<li>
<p>
<strong>219:7</strong> (new_http_inspect) IIS unicode codepoint encoding
</p>
</li>
<li>
<p>
<strong>219:8</strong> (new_http_inspect) multi_slash encoding
</p>
</li>
<li>
<p>
<strong>219:9</strong> (new_http_inspect) IIS backslash evasion
</p>
</li>
<li>
<p>
<strong>219:10</strong> (new_http_inspect) self directory traversal
</p>
</li>
<li>
<p>
<strong>219:11</strong> (new_http_inspect) directory traversal
</p>
</li>
<li>
<p>
<strong>219:12</strong> (new_http_inspect) apache whitespace (tab)
</p>
</li>
<li>
<p>
<strong>219:13</strong> (new_http_inspect) non-RFC http delimiter
</p>
</li>
<li>
<p>
<strong>219:14</strong> (new_http_inspect) non-RFC defined char
</p>
</li>
<li>
<p>
<strong>219:15</strong> (new_http_inspect) oversize request-uri directory
</p>
</li>
<li>
<p>
<strong>219:16</strong> (new_http_inspect) oversize chunk encoding
</p>
</li>
<li>
<p>
<strong>219:17</strong> (new_http_inspect) unauthorized proxy use detected
</p>
</li>
<li>
<p>
<strong>219:18</strong> (new_http_inspect) webroot directory traversal
</p>
</li>
<li>
<p>
<strong>219:19</strong> (new_http_inspect) long header
</p>
</li>
<li>
<p>
<strong>219:20</strong> (new_http_inspect) max header fields
</p>
</li>
<li>
<p>
<strong>219:21</strong> (new_http_inspect) multiple content length
</p>
</li>
<li>
<p>
<strong>219:22</strong> (new_http_inspect) chunk size mismatch detected
</p>
</li>
<li>
<p>
<strong>219:23</strong> (new_http_inspect) invalid IP in true-client-IP/XFF header
</p>
</li>
<li>
<p>
<strong>219:24</strong> (new_http_inspect) multiple host hdrs detected
</p>
</li>
<li>
<p>
<strong>219:25</strong> (new_http_inspect) hostname exceeds 255 characters
</p>
</li>
<li>
<p>
<strong>219:26</strong> (new_http_inspect) header parsing space saturation
</p>
</li>
<li>
<p>
<strong>219:27</strong> (new_http_inspect) client consecutive small chunk sizes
</p>
</li>
<li>
<p>
<strong>219:28</strong> (new_http_inspect) post w/o content-length or chunks
</p>
</li>
<li>
<p>
<strong>219:29</strong> (new_http_inspect) multiple true ips in a session
</p>
</li>
<li>
<p>
<strong>219:30</strong> (new_http_inspect) both true-client-IP and XFF hdrs present
</p>
</li>
<li>
<p>
<strong>219:31</strong> (new_http_inspect) unknown method
</p>
</li>
<li>
<p>
<strong>219:32</strong> (new_http_inspect) simple request
</p>
</li>
<li>
<p>
<strong>219:33</strong> (new_http_inspect) unescaped space in HTTP URI
</p>
</li>
<li>
<p>
<strong>219:34</strong> (new_http_inspect) too many pipelined requests
</p>
</li>
<li>
<p>
<strong>219:35</strong> (new_http_inspect) anomalous http server on undefined HTTP port
</p>
</li>
<li>
<p>
<strong>219:36</strong> (new_http_inspect) invalid status code in HTTP response
</p>
</li>
<li>
<p>
<strong>219:37</strong> (new_http_inspect) no content-length or transfer-encoding in HTTP response
</p>
</li>
<li>
<p>
<strong>219:38</strong> (new_http_inspect) HTTP response has UTF charset which failed to normalize
</p>
</li>
<li>
<p>
<strong>219:39</strong> (new_http_inspect) HTTP response has UTF-7 charset
</p>
</li>
<li>
<p>
<strong>219:40</strong> (new_http_inspect) HTTP response gzip decompression failed
</p>
</li>
<li>
<p>
<strong>219:41</strong> (new_http_inspect) server consecutive small chunk sizes
</p>
</li>
<li>
<p>
<strong>219:42</strong> (new_http_inspect) invalid content-length or chunk size
</p>
</li>
<li>
<p>
<strong>219:43</strong> (new_http_inspect) javascript obfuscation levels exceeds 1
</p>
</li>
<li>
<p>
<strong>219:44</strong> (new_http_inspect) javascript whitespaces exceeds max allowed
</p>
</li>
<li>
<p>
<strong>219:45</strong> (new_http_inspect) multiple encodings within javascript obfuscated data
</p>
</li>
<li>
<p>
<strong>219:46</strong> (new_http_inspect) SWF file zlib decompression failure
</p>
</li>
<li>
<p>
<strong>219:47</strong> (new_http_inspect) SWF file LZMA decompression failure
</p>
</li>
<li>
<p>
<strong>219:48</strong> (new_http_inspect) PDF file deflate decompression failure
</p>
</li>
<li>
<p>
<strong>219:49</strong> (new_http_inspect) PDF file unsupported compression type
</p>
</li>
<li>
<p>
<strong>219:50</strong> (new_http_inspect) PDF file cascaded compression
</p>
</li>
<li>
<p>
<strong>219:51</strong> (new_http_inspect) PDF file parse failure
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_command_set">Command Set</h3>
<div class="ulist"><ul>
<li>
<p>
<strong>snort.detach</strong>(): exit shell w/o shutdown
</p>
</li>
<li>
<p>
<strong>snort.dump_stats</strong>(): show summary statistics
</p>
</li>
<li>
<p>
<strong>snort.help</strong>(): this output
</p>
</li>
<li>
<p>
<strong>snort.pause</strong>(): suspend packet processing
</p>
</li>
<li>
<p>
<strong>snort.quit</strong>(): shutdown and dump-stats
</p>
</li>
<li>
<p>
<strong>snort.reload_config</strong>(): load new configuration
</p>
</li>
<li>
<p>
<strong>snort.resume</strong>(): continue packet processing
</p>
</li>
<li>
<p>
<strong>snort.rotate_stats</strong>(): roll perfmonitor log files
</p>
</li>
<li>
<p>
<strong>snort.show_plugins</strong>(): show available plugins
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_signals">Signals</h3>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/important.png" alt="Important" />
</td>
<td class="content">Signal numbers are for the system that generated this
documentation and are not applicable elsewhere.</td>
</tr></table>
</div>
<div class="ulist"><ul>
<li>
<p>
<strong>term</strong>(15): shutdown normally
</p>
</li>
<li>
<p>
<strong>int</strong>(2): shutdown normally
</p>
</li>
<li>
<p>
<strong>quit</strong>(3): shutdown as if started with --dirty-pig
</p>
</li>
<li>
<p>
<strong>stats</strong>(30): dump stats to stdout
</p>
</li>
<li>
<p>
<strong>rotate</strong>(31): rotate stats files
</p>
</li>
<li>
<p>
<strong>reload</strong>(1): reload config file
</p>
</li>
<li>
<p>
<strong>hosts</strong>(16): reload hosts file
</p>
</li>
</ul></div>
</div>
<div class="sect2">
<h3 id="_configuration_changes">Configuration Changes</h3>
<div class="listingblock">
<div class="content">
<pre><code>change -&gt; alertfile: 'config alertfile:' ==&gt; 'alert_fast.file'
change -&gt; alertfile: 'config alertfile:' ==&gt; 'alert_full.file'
change -&gt; attribute_table: '&lt;FRAG_POLICY&gt;bsd-right&lt;/FRAG_POLICY&gt;' ==&gt; 'hosts.frag_policy = bsd_right'
change -&gt; attribute_table: '&lt;STREAM_POLICY&gt;grannysmith&lt;/STREAM_POLICY&gt;' ==&gt; 'hosts.tcp_policy = macos'
change -&gt; attribute_table: '&lt;STREAM_POLICY&gt;hpux11&lt;/STREAM_POLICY&gt;' ==&gt; 'hosts.tcp_policy = hpux'
change -&gt; attribute_table: '&lt;STREAM_POLICY&gt;win2003&lt;/STREAM_POLICY&gt;' ==&gt; 'hosts.tcp_policy = win-2003'
change -&gt; attribute_table: '&lt;STREAM_POLICY&gt;win2k3&lt;/STREAM_POLICY&gt;' ==&gt; 'hosts.tcp_policy = win-2003'
change -&gt; attribute_table: 'STREAM_POLICY' ==&gt; 'hosts: tcp_policy'
change -&gt; attribute_table: 'filename &lt;file_name&gt;' ==&gt; 'hosts[]'
change -&gt; config 'addressspace_agnostic'  ==&gt; 'packets.address_space_agnostic'
change -&gt; config 'autogenerate_preprocessor_decoder_rules'  ==&gt; 'ips.enable_builtin_rules'
change -&gt; config 'checksum_mode'  ==&gt; 'network.checksum_eval'
change -&gt; config 'daq'  ==&gt; 'daq.type'
change -&gt; config 'daq_dir'  ==&gt; 'daq.dir'
change -&gt; config 'daq_mode'  ==&gt; 'daq.mode'
change -&gt; config 'daq_var'  ==&gt; 'daq.var'
change -&gt; config 'detection_filter'  ==&gt; 'alerts.detection_filter_memcap'
change -&gt; config 'disable_inline_init_failopen'  ==&gt; 'packets.enable_inline_init_failopen'
change -&gt; config 'enable_deep_teredo_inspection'  ==&gt; 'udp.deep_teredo_inspection'
change -&gt; config 'event_filter'  ==&gt; 'alerts.event_filter_memcap'
change -&gt; config 'max_attribute_hosts'  ==&gt; 'attribute_table.max_hosts'
change -&gt; config 'max_attribute_services_per_host'  ==&gt; 'attribute_table.max_services_per_host'
change -&gt; config 'nopcre'  ==&gt; 'detection.pcre_enable'
change -&gt; config 'pkt_count'  ==&gt; 'packets.limit'
change -&gt; config 'policy_mode'  ==&gt; 'ips.mode'
change -&gt; config 'rate_filter'  ==&gt; 'alerts.rate_filter_memcap'
change -&gt; config 'react'  ==&gt; 'react.page'
change -&gt; config 'threshold'  ==&gt; 'alerts.event_filter_memcap'
change -&gt; csv: 'dgmlen' ==&gt; 'dgm_len'
change -&gt; csv: 'dst' ==&gt; 'dst_addr'
change -&gt; csv: 'dstport' ==&gt; 'dst_port'
change -&gt; csv: 'ethdst' ==&gt; 'eth_dst'
change -&gt; csv: 'ethlen' ==&gt; 'eth_len'
change -&gt; csv: 'ethsrc' ==&gt; 'eth_src'
change -&gt; csv: 'ethtype' ==&gt; 'eth_type'
change -&gt; csv: 'icmpcode' ==&gt; 'icmp_code'
change -&gt; csv: 'icmpid' ==&gt; 'icmp_id'
change -&gt; csv: 'icmpseq' ==&gt; 'icmp_seq'
change -&gt; csv: 'icmptype' ==&gt; 'icmp_type'
change -&gt; csv: 'iplen' ==&gt; 'ip_len'
change -&gt; csv: 'sig_generator' ==&gt; 'gid'
change -&gt; csv: 'sig_id' ==&gt; 'sid'
change -&gt; csv: 'sig_rev' ==&gt; 'rev'
change -&gt; csv: 'src' ==&gt; 'src_addr'
change -&gt; csv: 'srcport' ==&gt; 'src_port'
change -&gt; csv: 'tcpack' ==&gt; 'tcp_ack'
change -&gt; csv: 'tcpflags' ==&gt; 'tcp_flags'
change -&gt; csv: 'tcplen' ==&gt; 'tcp_len'
change -&gt; csv: 'tcpseq' ==&gt; 'tcp_seq'
change -&gt; csv: 'tcpwindow' ==&gt; 'tcp_win'
change -&gt; csv: 'udplength' ==&gt; 'udp_len'
change -&gt; detection: 'ac' ==&gt; 'ac_full_q'
change -&gt; detection: 'ac-banded' ==&gt; 'ac_banded'
change -&gt; detection: 'ac-bnfa' ==&gt; 'ac_bnfa_q'
change -&gt; detection: 'ac-bnfa-nq' ==&gt; 'ac_bnfa'
change -&gt; detection: 'ac-bnfa-q' ==&gt; 'ac_bnfa_q'
change -&gt; detection: 'ac-nq' ==&gt; 'ac_full'
change -&gt; detection: 'ac-q' ==&gt; 'ac_full_q'
change -&gt; detection: 'ac-sparsebands' ==&gt; 'ac_sparse_bands'
change -&gt; detection: 'ac-split' ==&gt; 'ac_full_q'
change -&gt; detection: 'ac-split' ==&gt; 'split_any_any'
change -&gt; detection: 'ac-std' ==&gt; 'ac_std'
change -&gt; detection: 'acs' ==&gt; 'ac_sparse'
change -&gt; detection: 'bleedover-port-limit' ==&gt; 'bleedover_port_limit'
change -&gt; detection: 'bleedover-warnings-enabled' ==&gt; 'bleedover_warnings_enabled'
change -&gt; detection: 'debug-print-fast-pattern' ==&gt; 'debug_print_fast_pattern'
change -&gt; detection: 'debug-print-nocontent-rule-tests' ==&gt; 'debug_print_nocontent_rule_tests'
change -&gt; detection: 'debug-print-rule-group-build-details' ==&gt; 'debug_print_rule_group_build_details'
change -&gt; detection: 'debug-print-rule-groups-compiled' ==&gt; 'debug_print_rule_groups_compiled'
change -&gt; detection: 'debug-print-rule-groups-uncompiled' ==&gt; 'debug_print_rule_groups_uncompiled'
change -&gt; detection: 'enable-single-rule-group' ==&gt; 'enable_single_rule_group'
change -&gt; detection: 'intel-cpm' ==&gt; 'intel_cpm'
change -&gt; detection: 'lowmem' ==&gt; 'lowmem_q'
change -&gt; detection: 'lowmem-nq' ==&gt; 'lowmem'
change -&gt; detection: 'lowmem-q' ==&gt; 'lowmem_q'
change -&gt; detection: 'max-pattern-len' ==&gt; 'max_pattern_len'
change -&gt; detection: 'search-method' ==&gt; 'search_method'
change -&gt; detection: 'search-optimize' ==&gt; 'search_optimize'
change -&gt; detection: 'split-any-any' ==&gt; 'split_any_any'
change -&gt; dynamicdetection ==&gt; 'snort.--plugin_path=&lt;path&gt;'
change -&gt; dynamicengine ==&gt; 'snort.--plugin_path=&lt;path&gt;'
change -&gt; dynamicpreprocessor ==&gt; 'snort.--plugin_path=&lt;path&gt;'
change -&gt; dynamicsidechannel ==&gt; 'snort.--plugin_path=&lt;path&gt;'
change -&gt; event_filter: 'gen_id' ==&gt; 'gid'
change -&gt; event_filter: 'sig_id' ==&gt; 'sid'
change -&gt; event_filter: 'threshold' ==&gt; 'event_filter'
change -&gt; file: 'config file: file_block_timeout' ==&gt; 'block_timeout'
change -&gt; file: 'config file: file_lookup_timeout' ==&gt; 'lookup_timeout'
change -&gt; file: 'config file: file_signature_depth' ==&gt; 'signature_depth'
change -&gt; file: 'config file: file_type_depth' ==&gt; 'type_depth'
change -&gt; file: 'config file: signature' ==&gt; 'enable_signature'
change -&gt; file: 'config file: type_id' ==&gt; 'enable_type'
change -&gt; frag3_engine: 'min_fragment_length' ==&gt; 'min_frag_length'
change -&gt; frag3_engine: 'overlap_limit' ==&gt; 'max_overlaps'
change -&gt; frag3_engine: 'policy bsd-right' ==&gt; 'policy = bsd_right'
change -&gt; frag3_engine: 'preprocessor frag3_engine: timeout 0' ==&gt; 'session_timeout 256'
change -&gt; frag3_engine: 'timeout' ==&gt; 'session_timeout'
change -&gt; ftp_telnet_protocol: 'alt_max_param_len' ==&gt; 'cmd_validity'
change -&gt; ftp_telnet_protocol: 'data_chan' ==&gt; 'ignore_data_chan'
change -&gt; ftp_telnet_protocol: 'ports' ==&gt; 'bindings'
change -&gt; gtp: 'ports' ==&gt; 'gtp_ports'
change -&gt; http_inspect: 'http_inspect' ==&gt; 'http_global'
change -&gt; http_inspect_server: 'enable_cookie' ==&gt; 'enable_cookies'
change -&gt; http_inspect_server: 'flow_depth' ==&gt; 'server_flow_depth'
change -&gt; http_inspect_server: 'http_inspect_server' ==&gt; 'http_inspect'
change -&gt; http_inspect_server: 'non_rfc_char' ==&gt; 'non_rfc_chars'
change -&gt; http_inspect_server: 'ports' ==&gt; 'bindings'
change -&gt; http_inspect_server: 'post_depth [-1:65495]' ==&gt; 'post_depth [-1:65535]'
change -&gt; mpls_payload_type: 'config mpls_payload_type: ethernet' ==&gt; 'mpls_payload_type = eth'
change -&gt; mpls_payload_type: 'config mpls_payload_type: ipv4' ==&gt; 'mpls_payload_type = ip4'
change -&gt; mpls_payload_type: 'config mpls_payload_type: ipv6' ==&gt; 'mpls_payload_type = ip6'
change -&gt; normalizers: 'block' ==&gt; 'base'
change -&gt; normalizers: 'pad' ==&gt; 'base'
change -&gt; normalizers: 'req_pay' ==&gt; 'base'
change -&gt; normalizers: 'req_urg' ==&gt; 'base'
change -&gt; normalizers: 'req_urp' ==&gt; 'base'
change -&gt; normalizers: 'rsv' ==&gt; 'base'
change -&gt; normalizers: 'trim_mss' ==&gt; 'trim'
change -&gt; normalizers: 'trim_rst' ==&gt; 'trim'
change -&gt; normalizers: 'trim_syn' ==&gt; 'trim'
change -&gt; normalizers: 'trim_win' ==&gt; 'trim'
change -&gt; paf_max: 'paf_max [0:63780]' ==&gt; 'max_pdu [1460:63780]'
change -&gt; perfmonitor: 'accumulate' ==&gt; 'reset = false'
change -&gt; perfmonitor: 'flow-file' ==&gt; 'flow_file = true'
change -&gt; perfmonitor: 'flow-ip' ==&gt; 'flow_ip'
change -&gt; perfmonitor: 'flow-ip-file' ==&gt; 'flow_ip_file = true'
change -&gt; perfmonitor: 'flow-ip-memcap' ==&gt; 'flow_ip_memcap'
change -&gt; perfmonitor: 'flow-ports' ==&gt; 'flow_ports'
change -&gt; perfmonitor: 'pktcnt' ==&gt; 'packets'
change -&gt; perfmonitor: 'snortfile' ==&gt; 'file = true'
change -&gt; perfmonitor: 'time' ==&gt; 'seconds'
change -&gt; ppm: 'debug-pkts' ==&gt; 'debug_pkts'
change -&gt; ppm: 'fastpath-expensive-packets' ==&gt; 'fastpath_expensive_packets'
change -&gt; ppm: 'max-pkt-time' ==&gt; 'max_pkt_time'
change -&gt; ppm: 'max-rule-time' ==&gt; 'max_rule_time'
change -&gt; ppm: 'pkt-log' ==&gt; 'pkt_log'
change -&gt; ppm: 'rule-log' ==&gt; 'rule_log'
change -&gt; ppm: 'suspend-expensive-rules' ==&gt; 'suspend_expensive_rules'
change -&gt; ppm: 'suspend-timeout' ==&gt; 'suspend_timeout'
change -&gt; preprocessor 'normalize_icmp4' ==&gt; 'normalize.icmp4'
change -&gt; preprocessor 'normalize_icmp6' ==&gt; 'normalize.icmp6'
change -&gt; preprocessor 'normalize_ip6' ==&gt; 'normalize.ip6'
change -&gt; profile: 'print' ==&gt; 'count'
change -&gt; profile: 'sort avg_ticks_per_nomatch' ==&gt; 'sort = avg_ticks_per_no_match'
change -&gt; rate_filter: 'gen_id' ==&gt; 'gid'
change -&gt; rate_filter: 'sig_id' ==&gt; 'sid'
change -&gt; rule_state: 'disabled' ==&gt; 'enable'
change -&gt; rule_state: 'enabled' ==&gt; 'enable'
change -&gt; sfportscan: 'proto' ==&gt; 'protos'
change -&gt; sfportscan: 'scan_type' ==&gt; 'scan_types'
change -&gt; stream5_global: 'max_active_responses' ==&gt; 'max_responses'
change -&gt; stream5_global: 'max_icmp' ==&gt; 'max_sessions'
change -&gt; stream5_global: 'max_ip' ==&gt; 'max_sessions'
change -&gt; stream5_global: 'max_tcp' ==&gt; 'max_sessions'
change -&gt; stream5_global: 'max_udp' ==&gt; 'max_sessions'
change -&gt; stream5_global: 'min_response_seconds' ==&gt; 'min_interval'
change -&gt; stream5_global: 'prune_log_max' ==&gt; 'histogram'
change -&gt; stream5_global: 'tcp_cache_nominal_timeout' ==&gt; 'pruning_timeout'
change -&gt; stream5_global: 'tcp_cache_pruning_timeout' ==&gt; 'idle_timeout'
change -&gt; stream5_global: 'udp_cache_nominal_timeout' ==&gt; 'idle_timeout'
change -&gt; stream5_global: 'udp_cache_pruning_timeout' ==&gt; 'pruning_timeout'
change -&gt; stream5_ip: 'timeout' ==&gt; 'session_timeout'
change -&gt; stream5_tcp: 'bind_to' ==&gt; 'bindings'
change -&gt; stream5_tcp: 'both ports' ==&gt; 'binder.when.ports; binder.when.role = any'
change -&gt; stream5_tcp: 'both protocol' ==&gt; 'binder.when.proto; binder.when.role = any'
change -&gt; stream5_tcp: 'client ports' ==&gt; 'binder.when.ports; binder.when.role = client'
change -&gt; stream5_tcp: 'client protocol' ==&gt; 'binder.when.proto; binder.when.role = client'
change -&gt; stream5_tcp: 'dont_reassemble_async' ==&gt; 'reassemble_async'
change -&gt; stream5_tcp: 'max_queued_bytes' ==&gt; 'queue_limit.max_bytes'
change -&gt; stream5_tcp: 'max_queued_segs' ==&gt; 'queue_limit.max_segments'
change -&gt; stream5_tcp: 'policy grannysmith' ==&gt; 'stream_tcp.policy = macos'
change -&gt; stream5_tcp: 'policy hpux11' ==&gt; 'stream_tcp.policy = hpux'
change -&gt; stream5_tcp: 'policy win2003' ==&gt; 'stream_tcp.policy = win-2003'
change -&gt; stream5_tcp: 'policy win2k3' ==&gt; 'stream_tcp.policy = win-2003'
change -&gt; stream5_tcp: 'server ports' ==&gt; 'binder.when.ports; binder.when.role = server'
change -&gt; stream5_tcp: 'server protocol' ==&gt; 'binder.when.proto; binder.when.role = server'
change -&gt; stream5_tcp: 'timeout' ==&gt; 'session_timeout'
change -&gt; stream5_tcp: 'use_static_footprint_sizes' ==&gt; 'footprint'
change -&gt; stream5_udp: 'timeout' ==&gt; 'session_timeout'
change -&gt; suppress: 'gen_id' ==&gt; 'gid'
change -&gt; suppress: 'sig_id' ==&gt; 'sid'
change -&gt; syslog: 'log_alert' ==&gt; 'level = alert'
change -&gt; syslog: 'log_auth' ==&gt; 'facility = auth'
change -&gt; syslog: 'log_authpriv' ==&gt; 'facility = authpriv'
change -&gt; syslog: 'log_cons' ==&gt; 'options = cons'
change -&gt; syslog: 'log_crit' ==&gt; 'level = crit'
change -&gt; syslog: 'log_daemon' ==&gt; 'facility = daemon'
change -&gt; syslog: 'log_debug' ==&gt; 'level = debug'
change -&gt; syslog: 'log_emerg' ==&gt; 'level = emerg'
change -&gt; syslog: 'log_err' ==&gt; 'level = err'
change -&gt; syslog: 'log_info' ==&gt; 'level = info'
change -&gt; syslog: 'log_local0' ==&gt; 'facility = local0'
change -&gt; syslog: 'log_local1' ==&gt; 'facility = local1'
change -&gt; syslog: 'log_local2' ==&gt; 'facility = local2'
change -&gt; syslog: 'log_local3' ==&gt; 'facility = local3'
change -&gt; syslog: 'log_local4' ==&gt; 'facility = local4'
change -&gt; syslog: 'log_local5' ==&gt; 'facility = local5'
change -&gt; syslog: 'log_local6' ==&gt; 'facility = local6'
change -&gt; syslog: 'log_local7' ==&gt; 'facility = local7'
change -&gt; syslog: 'log_ndelay' ==&gt; 'options = ndelay'
change -&gt; syslog: 'log_notice' ==&gt; 'level = notice'
change -&gt; syslog: 'log_perror' ==&gt; 'options = perror'
change -&gt; syslog: 'log_pid' ==&gt; 'options = pid'
change -&gt; syslog: 'log_user' ==&gt; 'facility = user'
change -&gt; syslog: 'log_warning' ==&gt; 'level = warning'
change -&gt; threshold: 'ips_option: threshold' ==&gt; 'event_filter'
change -&gt; unified2: 'alert_unified2' ==&gt; 'unified2'
change -&gt; unified2: 'log_unified2' ==&gt; 'unified2'
change -&gt; unified2: 'unified2' ==&gt; 'unified2'
deleted -&gt; arpspoof: 'unicast'
deleted -&gt; attribute_table: '&lt;FRAG_POLICY&gt;hpux&lt;/FRAG_POLICY&gt;'
deleted -&gt; attribute_table: '&lt;FRAG_POLICY&gt;irix&lt;/FRAG_POLICY&gt;'
deleted -&gt; attribute_table: '&lt;FRAG_POLICY&gt;old-linux&lt;/FRAG_POLICY&gt;'
deleted -&gt; attribute_table: '&lt;FRAG_POLICY&gt;unknown&lt;/FRAG_POLICY&gt;'
deleted -&gt; attribute_table: '&lt;STREAM_POLICY&gt;noack&lt;/STREAM_POLICY&gt;'
deleted -&gt; attribute_table: '&lt;STREAM_POLICY&gt;unknown&lt;/STREAM_POLICY&gt;'
deleted -&gt; config 'cs_dir'
deleted -&gt; config 'disable_attribute_reload_thread'
deleted -&gt; config 'disable_decode_alerts'
deleted -&gt; config 'disable_decode_drops'
deleted -&gt; config 'disable_ipopt_alerts'
deleted -&gt; config 'disable_ipopt_drops'
deleted -&gt; config 'disable_tcpopt_alerts'
deleted -&gt; config 'disable_tcpopt_drops'
deleted -&gt; config 'disable_tcpopt_experimental_alerts'
deleted -&gt; config 'disable_tcpopt_experimental_drops'
deleted -&gt; config 'disable_tcpopt_obsolete_alerts'
deleted -&gt; config 'disable_tcpopt_obsolete_drops'
deleted -&gt; config 'disable_tcpopt_ttcp_alerts'
deleted -&gt; config 'disable_ttcp_alerts'
deleted -&gt; config 'disable_ttcp_drops'
deleted -&gt; config 'dump_dynamic_rules_path'
deleted -&gt; config 'enable_decode_drops'
deleted -&gt; config 'enable_decode_oversized_alerts'
deleted -&gt; config 'enable_decode_oversized_drops'
deleted -&gt; config 'enable_ipopt_drops'
deleted -&gt; config 'enable_tcpopt_drops'
deleted -&gt; config 'enable_tcpopt_experimental_drops'
deleted -&gt; config 'enable_tcpopt_obsolete_drops'
deleted -&gt; config 'enable_tcpopt_ttcp_drops'
deleted -&gt; config 'enable_ttcp_drops'
deleted -&gt; config 'flexresp2_attempts'
deleted -&gt; config 'flexresp2_interface'
deleted -&gt; config 'flexresp2_memcap'
deleted -&gt; config 'flexresp2_rows'
deleted -&gt; config 'include_vlan_in_alerts'
deleted -&gt; config 'interface'
deleted -&gt; config 'layer2resets'
deleted -&gt; config 'policy_version'
deleted -&gt; config 'so_rule_memcap'
deleted -&gt; csv: '&lt;filename&gt; can no longer be specific'
deleted -&gt; csv: 'default'
deleted -&gt; csv: 'trheader'
deleted -&gt; detection: 'mwm'
deleted -&gt; fast: '&lt;filename&gt; can no longer be specific'
deleted -&gt; frag3_engine: 'detect_anomalies'
deleted -&gt; frag3_global: 'disabled'
deleted -&gt; ftp_telnet_protocol: 'detect_anomalies'
deleted -&gt; full: '&lt;filename&gt; can no longer be specific'
deleted -&gt; http_inspect: 'disabled'
deleted -&gt; http_inspect_server: 'no_alerts'
deleted -&gt; perfmonitor: 'atexitonly'
deleted -&gt; perfmonitor: 'atexitonly: base-stats'
deleted -&gt; perfmonitor: 'atexitonly: events-stats'
deleted -&gt; perfmonitor: 'atexitonly: flow-ip-stats'
deleted -&gt; perfmonitor: 'atexitonly: flow-stats'
deleted -&gt; react: 'block'
deleted -&gt; react: 'warn'
deleted -&gt; rpc_decode: 'alert_fragments'
deleted -&gt; rpc_decode: 'no_alert_incomplete'
deleted -&gt; rpc_decode: 'no_alert_large_fragments'
deleted -&gt; rpc_decode: 'no_alert_multiple_requests'
deleted -&gt; rule_state: 'action'
deleted -&gt; sfportscan: 'detect_ack_scans'
deleted -&gt; sfportscan: 'disabled'
deleted -&gt; sfportscan: 'logfile'
deleted -&gt; stream5_global: 'disabled'
deleted -&gt; stream5_global: 'flush_on_alert'
deleted -&gt; stream5_global: 'no_midstream_drop_alerts'
deleted -&gt; stream5_tcp: 'check_session_hijacking'
deleted -&gt; stream5_tcp: 'detect_anomalies'
deleted -&gt; stream5_tcp: 'dont_store_large_packets'
deleted -&gt; stream5_tcp: 'policy noack'
deleted -&gt; stream5_tcp: 'policy unknown'
deleted -&gt; tcpdump: '&lt;filename&gt; can no longer be specific'
deleted -&gt; test: 'file'
deleted -&gt; test: 'stdout'
deleted -&gt; unified2: 'filename'</code></pre>
</div></div>
</div>
<div class="sect2">
<h3 id="_module_listing">Module Listing</h3>
<div class="ulist"><ul>
<li>
<p>
<strong>ack</strong> (ips_option): rule option to match on TCP ack numbers
</p>
</li>
<li>
<p>
<strong>active</strong> (basic): configure responses
</p>
</li>
<li>
<p>
<strong>alert_csv</strong> (logger): output event in csv format
</p>
</li>
<li>
<p>
<strong>alert_fast</strong> (logger): output event with brief text format
</p>
</li>
<li>
<p>
<strong>alert_full</strong> (logger): output event with full packet dump
</p>
</li>
<li>
<p>
<strong>alert_syslog</strong> (logger): output event to syslog
</p>
</li>
<li>
<p>
<strong>alert_test</strong> (logger): output event in custom tsv format
</p>
</li>
<li>
<p>
<strong>alert_unixsock</strong> (logger): output event over unix socket
</p>
</li>
<li>
<p>
<strong>alerts</strong> (basic): configure alerts
</p>
</li>
<li>
<p>
<strong>arp</strong> (codec): support for address resolution protocol
</p>
</li>
<li>
<p>
<strong>arp_spoof</strong> (inspector): detect ARP attacks and anomalies
</p>
</li>
<li>
<p>
<strong>asn1</strong> (ips_option): rule option for asn1 detection
</p>
</li>
<li>
<p>
<strong>attribute_table</strong> (basic): configure hosts loading
</p>
</li>
<li>
<p>
<strong>auth</strong> (codec): support for IP authentication header
</p>
</li>
<li>
<p>
<strong>back_orifice</strong> (inspector): back orifice detection
</p>
</li>
<li>
<p>
<strong>base64_decode</strong> (ips_option): rule option to decode base64 data - must be used with base64_data option
</p>
</li>
<li>
<p>
<strong>binder</strong> (inspector): configure processing based on CIDRs, ports, services, etc.
</p>
</li>
<li>
<p>
<strong>bufferlen</strong> (ips_option): rule option to check length of current buffer
</p>
</li>
<li>
<p>
<strong>byte_extract</strong> (ips_option): rule option to convert data to an integer variable
</p>
</li>
<li>
<p>
<strong>byte_jump</strong> (ips_option): rule option to move the detection cursor
</p>
</li>
<li>
<p>
<strong>byte_test</strong> (ips_option): rule option to convert data to integer and compare
</p>
</li>
<li>
<p>
<strong>classifications</strong> (basic): define rule categories with priority
</p>
</li>
<li>
<p>
<strong>classtype</strong> (ips_option): general rule option for rule classification
</p>
</li>
<li>
<p>
<strong>content</strong> (ips_option): payload rule option for basic pattern matching
</p>
</li>
<li>
<p>
<strong>cvs</strong> (ips_option): payload rule option for detecting specific attacks
</p>
</li>
<li>
<p>
<strong>daq</strong> (basic): configure packet acquisition interface
</p>
</li>
<li>
<p>
<strong>decode</strong> (basic): general decoder rules
</p>
</li>
<li>
<p>
<strong>detection</strong> (basic): configure general IPS rule processing parameters
</p>
</li>
<li>
<p>
<strong>detection_filter</strong> (ips_option): rule option to require multiple hits before a rule generates an event
</p>
</li>
<li>
<p>
<strong>dsize</strong> (ips_option): rule option to test payload size
</p>
</li>
<li>
<p>
<strong>eapol</strong> (codec): support for extensible authentication protocol over LAN
</p>
</li>
<li>
<p>
<strong>erspan2</strong> (codec): support for encapsulated remote switched port analyzer - type 2
</p>
</li>
<li>
<p>
<strong>erspan3</strong> (codec): support for encapsulated remote switched port analyzer - type 3
</p>
</li>
<li>
<p>
<strong>esp</strong> (codec): support for encapsulating security payload
</p>
</li>
<li>
<p>
<strong>eth</strong> (codec): support for ethernet protocol (DLT 1) (DLT 51)
</p>
</li>
<li>
<p>
<strong>event_filter</strong> (basic): configure thresholding of events
</p>
</li>
<li>
<p>
<strong>event_queue</strong> (basic): configure event queue parameters
</p>
</li>
<li>
<p>
<strong>file_data</strong> (ips_option): rule option to set detection cursor to file data
</p>
</li>
<li>
<p>
<strong>file_id</strong> (basic): configure file identification
</p>
</li>
<li>
<p>
<strong>flags</strong> (ips_option): rule option to test TCP control flags
</p>
</li>
<li>
<p>
<strong>flow</strong> (ips_option): rule option to check session properties
</p>
</li>
<li>
<p>
<strong>flowbits</strong> (ips_option): rule option to set and test arbitrary boolean flags
</p>
</li>
<li>
<p>
<strong>fragbits</strong> (ips_option): rule option to test IP frag flags
</p>
</li>
<li>
<p>
<strong>fragoffset</strong> (ips_option): rule option to test IP frag offset
</p>
</li>
<li>
<p>
<strong>ftp_client</strong> (data): FTP client configuration module for use with ftp_server
</p>
</li>
<li>
<p>
<strong>ftp_data</strong> (inspector): FTP data channel handler
</p>
</li>
<li>
<p>
<strong>ftp_server</strong> (inspector): main FTP module; ftp_client should also be configured
</p>
</li>
<li>
<p>
<strong>gid</strong> (ips_option): rule option specifying rule generator
</p>
</li>
<li>
<p>
<strong>gre</strong> (codec): support for generic routing encapsulation
</p>
</li>
<li>
<p>
<strong>gtp</strong> (codec): support for general-packet-radio-service tunnelling protocol
</p>
</li>
<li>
<p>
<strong>hosts</strong> (basic): configure hosts
</p>
</li>
<li>
<p>
<strong>http_client_body</strong> (ips_option): rule option to set the detection cursor to the request body
</p>
</li>
<li>
<p>
<strong>http_cookie</strong> (ips_option): rule option to set the detection cursor to the HTTP cookie
</p>
</li>
<li>
<p>
<strong>http_global</strong> (data): http inspector global configuration and client rules for use with http_server
</p>
</li>
<li>
<p>
<strong>http_header</strong> (ips_option): rule option to set the detection cursor to the normalized header(s)
</p>
</li>
<li>
<p>
<strong>http_inspect</strong> (inspector): http inspection and server rules; also configure http_inspect
</p>
</li>
<li>
<p>
<strong>http_method</strong> (ips_option): rule option to set the detection cursor to the HTTP request method
</p>
</li>
<li>
<p>
<strong>http_raw_cookie</strong> (ips_option): rule option to set the detection cursor to the unnormalized cookie
</p>
</li>
<li>
<p>
<strong>http_raw_header</strong> (ips_option): rule option to set the detection cursor to the unnormalized headers
</p>
</li>
<li>
<p>
<strong>http_raw_uri</strong> (ips_option): rule option to set the detection cursor to the unnormalized URI
</p>
</li>
<li>
<p>
<strong>http_stat_code</strong> (ips_option): rule option to set the detection cursor to the HTTP status code
</p>
</li>
<li>
<p>
<strong>http_stat_msg</strong> (ips_option): rule option to set the detection cursor to the HTTP status message
</p>
</li>
<li>
<p>
<strong>http_uri</strong> (ips_option): rule option to set the detection cursor to the normalized URI buffer
</p>
</li>
<li>
<p>
<strong>icmp4</strong> (codec): support for Internet control message protocol v4
</p>
</li>
<li>
<p>
<strong>icmp6</strong> (codec): support for Internet control message protocol v6
</p>
</li>
<li>
<p>
<strong>icmp_id</strong> (ips_option): rule option to check ICMP ID
</p>
</li>
<li>
<p>
<strong>icmp_seq</strong> (ips_option): rule option to check ICMP sequence number
</p>
</li>
<li>
<p>
<strong>icode</strong> (ips_option): rule option to check ICMP code
</p>
</li>
<li>
<p>
<strong>id</strong> (ips_option): rule option to check the IP ID field
</p>
</li>
<li>
<p>
<strong>igmp</strong> (codec): support for Internet group management protocol
</p>
</li>
<li>
<p>
<strong>ip_proto</strong> (ips_option): rule option to check the IP protocol number
</p>
</li>
<li>
<p>
<strong>ipopts</strong> (ips_option): rule option to check for IP options
</p>
</li>
<li>
<p>
<strong>ips</strong> (basic): configure IPS rule processing
</p>
</li>
<li>
<p>
<strong>ipv4</strong> (codec): support for Internet protocol v4
</p>
</li>
<li>
<p>
<strong>ipv6</strong> (codec): support for Internet protocol v6
</p>
</li>
<li>
<p>
<strong>isdataat</strong> (ips_option): rule option to check for the presence of payload data
</p>
</li>
<li>
<p>
<strong>itype</strong> (ips_option): rule option to check ICMP type
</p>
</li>
<li>
<p>
<strong>log_codecs</strong> (logger): log protocols in packet by layer
</p>
</li>
<li>
<p>
<strong>log_pcap</strong> (logger): log packet in pcap format
</p>
</li>
<li>
<p>
<strong>metadata</strong> (ips_option): rule option for conveying arbitrary name, value data within the rule text
</p>
</li>
<li>
<p>
<strong>mpls</strong> (codec): support for multiprotocol label switching
</p>
</li>
<li>
<p>
<strong>msg</strong> (ips_option): rule option summarizing rule purpose output with events
</p>
</li>
<li>
<p>
<strong>network</strong> (basic): configure basic network parameters
</p>
</li>
<li>
<p>
<strong>new_http_inspect</strong> (inspector): new HTTP inspector
</p>
</li>
<li>
<p>
<strong>normalizer</strong> (inspector): packet scrubbing for inline mode
</p>
</li>
<li>
<p>
<strong>output</strong> (basic): configure general output parameters
</p>
</li>
<li>
<p>
<strong>packets</strong> (basic): configure basic packet handling
</p>
</li>
<li>
<p>
<strong>pcre</strong> (ips_option): rule option for matching payload data with regex
</p>
</li>
<li>
<p>
<strong>perf_monitor</strong> (inspector): performance monitoring and flow statistics collection
</p>
</li>
<li>
<p>
<strong>pgm</strong> (codec): support for pragmatic general multicast
</p>
</li>
<li>
<p>
<strong>pkt_data</strong> (ips_option): rule option to set the detection cursor to the normalized packet data
</p>
</li>
<li>
<p>
<strong>port_scan</strong> (inspector): port scan inspector; also configure port_scan_global
</p>
</li>
<li>
<p>
<strong>port_scan_global</strong> (data): shared settings for port_scan inspectors for use with port_scan
</p>
</li>
<li>
<p>
<strong>ppm</strong> (basic): packet and rule latency monitoring and control (requires --enable-ppm)
</p>
</li>
<li>
<p>
<strong>pppoe</strong> (codec): support for point-to-point protocol over ethernet
</p>
</li>
<li>
<p>
<strong>priority</strong> (ips_option): rule option for prioritizing events
</p>
</li>
<li>
<p>
<strong>process</strong> (basic): configure basic process setup
</p>
</li>
<li>
<p>
<strong>profile</strong> (basic): configure profiling of rules and/or modules (requires --enable-perf-profiling)
</p>
</li>
<li>
<p>
<strong>rate_filter</strong> (basic): configure rate filters (which change rule actions)
</p>
</li>
<li>
<p>
<strong>raw_data</strong> (ips_option): rule option to set the detection cursor to the raw packet data
</p>
</li>
<li>
<p>
<strong>react</strong> (ips_action): send response to client and terminate session
</p>
</li>
<li>
<p>
<strong>reference</strong> (ips_option): rule option to indicate relevant attack identification system
</p>
</li>
<li>
<p>
<strong>references</strong> (basic): define reference systems used in rules
</p>
</li>
<li>
<p>
<strong>reject</strong> (ips_action): terminate session with TCP reset or ICMP unreachable
</p>
</li>
<li>
<p>
<strong>rem</strong> (ips_option): rule option to convey an arbitrary comment in the rule body
</p>
</li>
<li>
<p>
<strong>replace</strong> (ips_option): rule option to overwrite payload data; use with rewrite action
</p>
</li>
<li>
<p>
<strong>rev</strong> (ips_option): rule option to indicate current revision of signature
</p>
</li>
<li>
<p>
<strong>rewrite</strong> (ips_action): overwrite packet contents
</p>
</li>
<li>
<p>
<strong>rpc</strong> (ips_option): rule option to check SUNRPC CALL parameters
</p>
</li>
<li>
<p>
<strong>rpc_decode</strong> (inspector): RPC inspector
</p>
</li>
<li>
<p>
<strong>rule_state</strong> (basic): enable/disable specific IPS rules
</p>
</li>
<li>
<p>
<strong>search_engine</strong> (basic): configure fast pattern matcher
</p>
</li>
<li>
<p>
<strong>seq</strong> (ips_option): rule option to check TCP sequence number
</p>
</li>
<li>
<p>
<strong>session</strong> (ips_option): rule option to check user data from TCP sessions
</p>
</li>
<li>
<p>
<strong>sid</strong> (ips_option): rule option to indicate signature number
</p>
</li>
<li>
<p>
<strong>snort</strong> (basic): command line configuration and shell commands
</p>
</li>
<li>
<p>
<strong>so</strong> (ips_option): rule option to call custom eval function
</p>
</li>
<li>
<p>
<strong>soid</strong> (ips_option): rule option to specify a shared object rule ID
</p>
</li>
<li>
<p>
<strong>stream</strong> (inspector): common flow tracking
</p>
</li>
<li>
<p>
<strong>stream_icmp</strong> (inspector): stream inspector for ICMP flow tracking
</p>
</li>
<li>
<p>
<strong>stream_ip</strong> (inspector): stream inspector for IP flow tracking and defragmentation
</p>
</li>
<li>
<p>
<strong>stream_reassemble</strong> (ips_option): detection option for stream reassembly control
</p>
</li>
<li>
<p>
<strong>stream_size</strong> (ips_option): detection option for stream size checking
</p>
</li>
<li>
<p>
<strong>stream_tcp</strong> (inspector): stream inspector for TCP flow tracking and stream normalization and reassembly
</p>
</li>
<li>
<p>
<strong>stream_udp</strong> (inspector): stream inspector for UDP flow tracking
</p>
</li>
<li>
<p>
<strong>suppress</strong> (basic): configure event suppressions
</p>
</li>
<li>
<p>
<strong>tag</strong> (ips_option): rule option to log additional packets
</p>
</li>
<li>
<p>
<strong>tcp</strong> (codec): support for transmission control protocol
</p>
</li>
<li>
<p>
<strong>telnet</strong> (inspector): telnet inspection and normalization
</p>
</li>
<li>
<p>
<strong>tos</strong> (ips_option): rule option to check type of service field
</p>
</li>
<li>
<p>
<strong>ttl</strong> (ips_option): rule option to check time to live field
</p>
</li>
<li>
<p>
<strong>udp</strong> (codec): support for user datagram protocol
</p>
</li>
<li>
<p>
<strong>unified2</strong> (logger): output event and packet in unified2 format file
</p>
</li>
<li>
<p>
<strong>vlan</strong> (codec): support for local area network
</p>
</li>
<li>
<p>
<strong>window</strong> (ips_option): rule option to check TCP window field
</p>
</li>
<li>
<p>
<strong>wizard</strong> (inspector): inspector that implements port-independent protocol identification
</p>
</li>
<li>
<p>
<strong>wlan</strong> (codec): support for wireless local area network protocol (DLT 105)
:leveloffset: 0
</p>
</li>
</ul></div>
<div class="sect3">
<h4 id="_plugin_listing">Plugin Listing</h4>
<div class="ulist"><ul>
<li>
<p>
<strong>codec::arp</strong>: support for address resolution protocol
</p>
</li>
<li>
<p>
<strong>codec::auth</strong>: support for IP authentication header
</p>
</li>
<li>
<p>
<strong>codec::eapol</strong>: support for extensible authentication protocol over LAN
</p>
</li>
<li>
<p>
<strong>codec::erspan2</strong>: support for encapsulated remote switched port analyzer - type 2
</p>
</li>
<li>
<p>
<strong>codec::erspan3</strong>: support for encapsulated remote switched port analyzer - type 3
</p>
</li>
<li>
<p>
<strong>codec::esp</strong>: support for encapsulating security payload
</p>
</li>
<li>
<p>
<strong>codec::eth</strong>: support for ethernet protocol (DLT 1) (DLT 51)
</p>
</li>
<li>
<p>
<strong>codec::gre</strong>: support for generic routing encapsulation
</p>
</li>
<li>
<p>
<strong>codec::gtp</strong>: support for general-packet-radio-service tunnelling protocol
</p>
</li>
<li>
<p>
<strong>codec::icmp4</strong>: support for Internet control message protocol v4
</p>
</li>
<li>
<p>
<strong>codec::icmp4_ip</strong>: support for IP in ICMPv4
</p>
</li>
<li>
<p>
<strong>codec::icmp6</strong>: support for Internet control message protocol v6
</p>
</li>
<li>
<p>
<strong>codec::icmp6_ip</strong>: support for IP in ICMPv6
</p>
</li>
<li>
<p>
<strong>codec::igmp</strong>: support for Internet group management protocol
</p>
</li>
<li>
<p>
<strong>codec::ipv4</strong>: support for Internet protocol v4
</p>
</li>
<li>
<p>
<strong>codec::ipv6</strong>: support for Internet protocol v6
</p>
</li>
<li>
<p>
<strong>codec::ipv6_dst_opts</strong>: support for ipv6 destination options
</p>
</li>
<li>
<p>
<strong>codec::ipv6_frag</strong>: support for IPv6 fragment decoding
</p>
</li>
<li>
<p>
<strong>codec::ipv6_hop_opts</strong>: support for IPv6 hop options
</p>
</li>
<li>
<p>
<strong>codec::ipv6_mobility</strong>: support for mobility
</p>
</li>
<li>
<p>
<strong>codec::ipv6_no_next</strong>: sentinel codec
</p>
</li>
<li>
<p>
<strong>codec::ipv6_routing</strong>: support for IPv6 routing extension
</p>
</li>
<li>
<p>
<strong>codec::linux_sll</strong>: support for Linux SLL (DLT 113)
</p>
</li>
<li>
<p>
<strong>codec::llc</strong>: support for logical link control
</p>
</li>
<li>
<p>
<strong>codec::mpls</strong>: support for multiprotocol label switching
</p>
</li>
<li>
<p>
<strong>codec::null</strong>: support for null encapsulation (DLT 0)
</p>
</li>
<li>
<p>
<strong>codec::pgm</strong>: support for pragmatic general multicast
</p>
</li>
<li>
<p>
<strong>codec::ppp</strong>: support for point-to-point encapsulation (DLT 9)
</p>
</li>
<li>
<p>
<strong>codec::ppp_encap</strong>: support for point-to-point encapsulation
</p>
</li>
<li>
<p>
<strong>codec::pppoe_disc</strong>: support for point-to-point discovery
</p>
</li>
<li>
<p>
<strong>codec::pppoe_sess</strong>: support for point-to-point session
</p>
</li>
<li>
<p>
<strong>codec::raw4</strong>: support for unencapsulated IPv4 (DLT 12) (DLT 228)
</p>
</li>
<li>
<p>
<strong>codec::raw6</strong>: support for unencapsulated IPv6 (DLT 229)
</p>
</li>
<li>
<p>
<strong>codec::sun_nd</strong>: support for Sun ND
</p>
</li>
<li>
<p>
<strong>codec::swipe</strong>: support for Swipe
</p>
</li>
<li>
<p>
<strong>codec::tcp</strong>: support for transmission control protocol
</p>
</li>
<li>
<p>
<strong>codec::teredo</strong>: support for teredo
</p>
</li>
<li>
<p>
<strong>codec::trans_bridge</strong>: support for trans-bridging
</p>
</li>
<li>
<p>
<strong>codec::udp</strong>: support for user datagram protocol
</p>
</li>
<li>
<p>
<strong>codec::vlan</strong>: support for local area network
</p>
</li>
<li>
<p>
<strong>codec::wlan</strong>: support for wireless local area network protocol (DLT 105)
</p>
</li>
<li>
<p>
<strong>data::ftp_client</strong>: FTP inspector client module
</p>
</li>
<li>
<p>
<strong>data::http_global</strong>: shared HTTP inspector settings
</p>
</li>
<li>
<p>
<strong>data::port_scan_global</strong>: shared settings for port_scan inspectors for use with port_scan
</p>
</li>
<li>
<p>
<strong>inspector::arp_spoof</strong>: detect ARP attacks and anomalies
</p>
</li>
<li>
<p>
<strong>inspector::back_orifice</strong>: back orifice detection
</p>
</li>
<li>
<p>
<strong>inspector::binder</strong>: configure processing based on CIDRs, ports, services, etc.
</p>
</li>
<li>
<p>
<strong>inspector::ftp_data</strong>: FTP data channel handler
</p>
</li>
<li>
<p>
<strong>inspector::ftp_server</strong>: FTP inspector server module
</p>
</li>
<li>
<p>
<strong>inspector::http_inspect</strong>: main HTTP inspector module
</p>
</li>
<li>
<p>
<strong>inspector::new_http_inspect</strong>: the new HTTP inspector!
</p>
</li>
<li>
<p>
<strong>inspector::normalizer</strong>: packet scrubbing for inline mode
</p>
</li>
<li>
<p>
<strong>inspector::perf_monitor</strong>: performance monitoring and flow statistics collection
</p>
</li>
<li>
<p>
<strong>inspector::port_scan</strong>: port scan inspector; also configure port_scan_global
</p>
</li>
<li>
<p>
<strong>inspector::rpc_decode</strong>: RPC inspector
</p>
</li>
<li>
<p>
<strong>inspector::stream</strong>: common flow tracking
</p>
</li>
<li>
<p>
<strong>inspector::stream_icmp</strong>: stream inspector for ICMP flow tracking
</p>
</li>
<li>
<p>
<strong>inspector::stream_ip</strong>: stream inspector for IP flow tracking and defragmentation
</p>
</li>
<li>
<p>
<strong>inspector::stream_tcp</strong>: stream inspector for TCP flow tracking and stream normalization and reassembly
</p>
</li>
<li>
<p>
<strong>inspector::stream_udp</strong>: stream inspector for UDP flow tracking
</p>
</li>
<li>
<p>
<strong>inspector::telnet</strong>: telnet inspection and normalization
</p>
</li>
<li>
<p>
<strong>inspector::wizard</strong>: inspector that implements port-independent protocol identification
</p>
</li>
<li>
<p>
<strong>ips_action::react</strong>: send response to client and terminate session
</p>
</li>
<li>
<p>
<strong>ips_action::reject</strong>: terminate session with TCP reset or ICMP unreachable
</p>
</li>
<li>
<p>
<strong>ips_action::rewrite</strong>: overwrite packet contents
</p>
</li>
<li>
<p>
<strong>ips_option::ack</strong>: rule option to match on TCP ack numbers
</p>
</li>
<li>
<p>
<strong>ips_option::asn1</strong>: rule option for asn1 detection
</p>
</li>
<li>
<p>
<strong>ips_option::base64_data</strong>: set detection cursor to decoded Base64 data
</p>
</li>
<li>
<p>
<strong>ips_option::base64_decode</strong>: rule option to decode base64 data - must be used with base64_data option
</p>
</li>
<li>
<p>
<strong>ips_option::bufferlen</strong>: rule option to check length of current buffer
</p>
</li>
<li>
<p>
<strong>ips_option::byte_extract</strong>: rule option to convert data to an integer variable
</p>
</li>
<li>
<p>
<strong>ips_option::byte_jump</strong>: rule option to move the detection cursor
</p>
</li>
<li>
<p>
<strong>ips_option::byte_test</strong>: rule option to convert data to integer and compare
</p>
</li>
<li>
<p>
<strong>ips_option::classtype</strong>: general rule option for rule classification
</p>
</li>
<li>
<p>
<strong>ips_option::content</strong>: payload rule option for basic pattern matching
</p>
</li>
<li>
<p>
<strong>ips_option::cvs</strong>: payload rule option for detecting specific attacks
</p>
</li>
<li>
<p>
<strong>ips_option::detection_filter</strong>: rule option to require multiple hits before a rule generates an event
</p>
</li>
<li>
<p>
<strong>ips_option::dsize</strong>: rule option to test payload size
</p>
</li>
<li>
<p>
<strong>ips_option::file_data</strong>: rule option to set detection cursor to file data
</p>
</li>
<li>
<p>
<strong>ips_option::flags</strong>: rule option to test TCP control flags
</p>
</li>
<li>
<p>
<strong>ips_option::flow</strong>: rule option to check session properties
</p>
</li>
<li>
<p>
<strong>ips_option::flowbits</strong>: rule option to set and test arbitrary boolean flags
</p>
</li>
<li>
<p>
<strong>ips_option::fragbits</strong>: rule option to test IP frag flags
</p>
</li>
<li>
<p>
<strong>ips_option::fragoffset</strong>: rule option to test IP frag offset
</p>
</li>
<li>
<p>
<strong>ips_option::gid</strong>: rule option specifying rule generator
</p>
</li>
<li>
<p>
<strong>ips_option::http_client_body</strong>: rule option to set the detection cursor to the request body
</p>
</li>
<li>
<p>
<strong>ips_option::http_cookie</strong>: rule option to set the detection cursor to the HTTP cookie
</p>
</li>
<li>
<p>
<strong>ips_option::http_header</strong>: rule option to set the detection cursor to the normalized header(s)
</p>
</li>
<li>
<p>
<strong>ips_option::http_method</strong>: rule option to set the detection cursor to the HTTP request method
</p>
</li>
<li>
<p>
<strong>ips_option::http_raw_cookie</strong>: rule option to set the detection cursor to the unnormalized cookie
</p>
</li>
<li>
<p>
<strong>ips_option::http_raw_header</strong>: rule option to set the detection cursor to the unnormalized headers
</p>
</li>
<li>
<p>
<strong>ips_option::http_raw_uri</strong>: rule option to set the detection cursor to the unnormalized URI
</p>
</li>
<li>
<p>
<strong>ips_option::http_stat_code</strong>: rule option to set the detection cursor to the HTTP status code
</p>
</li>
<li>
<p>
<strong>ips_option::http_stat_msg</strong>: rule option to set the detection cursor to the HTTP status message
</p>
</li>
<li>
<p>
<strong>ips_option::http_uri</strong>: rule option to set the detection cursor to the normalized URI buffer
</p>
</li>
<li>
<p>
<strong>ips_option::icmp_id</strong>: rule option to check ICMP ID
</p>
</li>
<li>
<p>
<strong>ips_option::icmp_seq</strong>: rule option to check ICMP sequence number
</p>
</li>
<li>
<p>
<strong>ips_option::icode</strong>: rule option to check ICMP code
</p>
</li>
<li>
<p>
<strong>ips_option::id</strong>: rule option to check the IP ID field
</p>
</li>
<li>
<p>
<strong>ips_option::ip_proto</strong>: rule option to check the IP protocol number
</p>
</li>
<li>
<p>
<strong>ips_option::ipopts</strong>: rule option to check for IP options
</p>
</li>
<li>
<p>
<strong>ips_option::isdataat</strong>: rule option to check for the presence of payload data
</p>
</li>
<li>
<p>
<strong>ips_option::itype</strong>: rule option to check ICMP type
</p>
</li>
<li>
<p>
<strong>ips_option::metadata</strong>: rule option for conveying arbitrary name, value data within the rule text
</p>
</li>
<li>
<p>
<strong>ips_option::msg</strong>: rule option summarizing rule purpose output with events
</p>
</li>
<li>
<p>
<strong>ips_option::pcre</strong>: rule option for matching payload data with regex
</p>
</li>
<li>
<p>
<strong>ips_option::pkt_data</strong>: rule option to set the detection cursor to the normalized packet data
</p>
</li>
<li>
<p>
<strong>ips_option::priority</strong>: rule option for prioritizing events
</p>
</li>
<li>
<p>
<strong>ips_option::raw_data</strong>: rule option to set the detection cursor to the raw packet data
</p>
</li>
<li>
<p>
<strong>ips_option::reference</strong>: rule option to indicate relevant attack identification system
</p>
</li>
<li>
<p>
<strong>ips_option::rem</strong>: rule option to convey an arbitrary comment in the rule body
</p>
</li>
<li>
<p>
<strong>ips_option::replace</strong>: rule option to overwrite payload data; use with rewrite action
</p>
</li>
<li>
<p>
<strong>ips_option::rev</strong>: rule option to indicate current revision of signature
</p>
</li>
<li>
<p>
<strong>ips_option::rpc</strong>: rule option to check SUNRPC CALL parameters
</p>
</li>
<li>
<p>
<strong>ips_option::seq</strong>: rule option to check TCP sequence number
</p>
</li>
<li>
<p>
<strong>ips_option::session</strong>: rule option to check user data from TCP sessions
</p>
</li>
<li>
<p>
<strong>ips_option::sid</strong>: rule option to indicate signature number
</p>
</li>
<li>
<p>
<strong>ips_option::so</strong>: rule option to call custom eval function
</p>
</li>
<li>
<p>
<strong>ips_option::soid</strong>: rule option to specify a shared object rule ID
</p>
</li>
<li>
<p>
<strong>ips_option::stream_reassemble</strong>: detection option for stream reassembly control
</p>
</li>
<li>
<p>
<strong>ips_option::stream_size</strong>: detection option for stream size checking
</p>
</li>
<li>
<p>
<strong>ips_option::tag</strong>: rule option to log additional packets
</p>
</li>
<li>
<p>
<strong>ips_option::tos</strong>: rule option to check type of service field
</p>
</li>
<li>
<p>
<strong>ips_option::ttl</strong>: rule option to check time to live field
</p>
</li>
<li>
<p>
<strong>ips_option::window</strong>: rule option to check TCP window field
</p>
</li>
<li>
<p>
<strong>logger::alert_csv</strong>: output event in csv format
</p>
</li>
<li>
<p>
<strong>logger::alert_fast</strong>: output event with brief text format
</p>
</li>
<li>
<p>
<strong>logger::alert_full</strong>: output event with full packet dump
</p>
</li>
<li>
<p>
<strong>logger::alert_syslog</strong>: output event to syslog
</p>
</li>
<li>
<p>
<strong>logger::alert_test</strong>: output event in custom tsv format
</p>
</li>
<li>
<p>
<strong>logger::alert_unixsock</strong>: output event over unix socket
</p>
</li>
<li>
<p>
<strong>logger::log_codecs</strong>: log protocols in packet by layer
</p>
</li>
<li>
<p>
<strong>logger::log_null</strong>: support for null encapsulation
</p>
</li>
<li>
<p>
<strong>logger::log_pcap</strong>: log packet in pcap format
</p>
</li>
<li>
<p>
<strong>logger::unified2</strong>: output event and packet in unified2 format file
</p>
</li>
<li>
<p>
<strong>search_engine::ac_banded</strong>: Aho-Corasick Banded (high memory, moderate performance)
</p>
</li>
<li>
<p>
<strong>search_engine::ac_bnfa</strong>: Aho-Corasick Binary NFA (low memory, high performance) MPSE
</p>
</li>
<li>
<p>
<strong>search_engine::ac_bnfa_q</strong>: Aho-Corasick Binary NFA (low memory, high performance) with queued events
</p>
</li>
<li>
<p>
<strong>search_engine::ac_full</strong>: Aho-Corasick Full (high memory, best performance)
</p>
</li>
<li>
<p>
<strong>search_engine::ac_full_q</strong>: Aho-Corasick Full (high memory, best performance) with queued events
</p>
</li>
<li>
<p>
<strong>search_engine::ac_sparse</strong>: Aho-Corasick Sparse (high memory, moderate performance) MPSE
</p>
</li>
<li>
<p>
<strong>search_engine::ac_sparse_bands</strong>: Aho-Corasick Sparse-Banded (high memory, moderate performance) MPSE
</p>
</li>
<li>
<p>
<strong>search_engine::ac_std</strong>: Aho-Corasick Full (high memory, best performance) MPSE
</p>
</li>
</ul></div>
</div>
</div>
<div class="sect2">
<h3 id="_extending_snort">Extending Snort++</h3>
<div class="sect3">
<h4 id="_plugins_2">Plugins</h4>
<div class="paragraph"><p>Snort++ uses a variety of plugins to accomplish much of its processing
objectives, including:</p></div>
<div class="ulist"><ul>
<li>
<p>
Codec - to decode and encode packets
</p>
</li>
<li>
<p>
Inspector - like the prior preprocessors, for normalization, etc.
</p>
</li>
<li>
<p>
IpsOption - for detection in Snort++ rules
</p>
</li>
<li>
<p>
IpsAction - for custom actions
</p>
</li>
<li>
<p>
Logger - for handling events
</p>
</li>
<li>
<p>
Mpse - for fast pattern matching
</p>
</li>
<li>
<p>
So - for dynamic rules
</p>
</li>
</ul></div>
<div class="paragraph"><p>Plugins have an associated API defined for each type, all of which share a
common <em>header</em>, called the BaseApi.  A dynamic library makes its plugins
available by exporting the snort_plugins symbol, which is a null terminated
array of BaseApi pointers.</p></div>
<div class="paragraph"><p>The BaseApi includes type, name, API version, plugin version, and function
pointers for constructing and destructing a Module.  The specific API add
various other data and functions for their given roles.</p></div>
<div class="paragraph"><p>The Module is pervasive in Snort<code>.  It is how everything, including
plugins, are configured.  It also provides access to builtin rules.  And as
the glue that binds functionality to Snort</code>, the capabilities of a Module
are expected to grow to include statistics support, etc.</p></div>
<div class="paragraph"><p>Module configuration is handled by a list of Parameters.  Most parameters
can be validated by the framework, which means for example that conversion
from string to number is done in exactly one place.  Providing the builtin
rules allows the documentation to include them automatically and also allows
for autogenerating the rules at startup.</p></div>
<div class="paragraph"><p>If we are defining a new Inspector called, say, gadget, it might be
configured in snort.lua like this:</p></div>
<div class="literalblock">
<div class="content">
<pre><code>gadget =
{
    brain = true,
    claw = 3
}</code></pre>
</div></div>
<div class="paragraph"><p>When the gadget table is processed, Snort++ will look for a module called
gadget.  If that Module has an associated API, it will be used to configure
a new instance of the plugin.  In this case, a GadgetModule would be
instantiated, brain and claw would be set, and the Module instance would be
passed to the GadgetInspector constructor.</p></div>
<div class="paragraph"><p>Module has three key virtual methods:</p></div>
<div class="ulist"><ul>
<li>
<p>
<strong>begin()</strong> - called when Snort++ starts processing the associated Lua
  table.  This is a good place to allocate any required data and set
  defaults.
</p>
</li>
<li>
<p>
<strong>set()</strong> - called to set each parameter after validation.
</p>
</li>
<li>
<p>
<strong>end()</strong> - called when Snort++ finishes processing the associated Lua
  table.  This is where additional integrity checks of related parameters
  should be done.
</p>
</li>
</ul></div>
<div class="paragraph"><p>The configured Module is passed to the plugin constructor which pulls the
configuration data from the Module.  For non-trivial configurations, the
working paradigm is that Module hands a pointer to the configured data to
the plugin instance which takes ownership.</p></div>
<div class="paragraph"><p>Note that there is at most one instance of a given Module, even if multiple
plugin instances are created which use that Module.  (Multiple instances
require Snort++ binding configuration.)</p></div>
</div>
<div class="sect3">
<h4 id="_coding_style">Coding Style</h4>
<div class="paragraph"><p>All new code should try to follow these style guidelines.  These are not
yet firm so feedback is welcome to get something we can live with.</p></div>
<div class="sect4">
<h5 id="_general">General</h5>
<div class="ulist"><ul>
<li>
<p>
Generally try to follow
  <a href="http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml">http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml</a>,
  but there are a few differences.
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_naming">Naming</h5>
<div class="ulist"><ul>
<li>
<p>
Use camel case for namespaces, classes, and types like WhizBangPdfChecker.
</p>
</li>
<li>
<p>
Use lower case identifiers with underscore separators, e.g. some_function()
  and my_var.
</p>
</li>
<li>
<p>
Use lower case filenames with underscores.
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_comments">Comments</h5>
<div class="ulist"><ul>
<li>
<p>
Write comments sparingly with a mind towards future proofing.  Often the
  comments can be obviated with better code.  Clear code is better than a
  comment.
</p>
</li>
<li>
<p>
Function comment blocks are generally just noise that quickly becomes
  obsolete.  If you absolutely must comment on parameters, put each on a
  separate line along with the comment.  That way changing the signature
  may prompt a change to the comments too.
</p>
</li>
<li>
<p>
Use FIXIT (not FIXTHIS or TODO or whatever) to mark things left for a
  day or even just a minute.  That way we can find them easily and won&#8217;t
  lose track of them.
</p>
</li>
<li>
<p>
Presently using FIXIT-X where X = P | H | M | L, indicating perf, high,
  med, or low priority.  For now, H, M, or L can indicate alpha 1, 2, or 3.
  Perf changes fall between alpha 1 and 2.
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_logging">Logging</h5>
<div class="ulist"><ul>
<li>
<p>
Messages intended for the user should not look like debug messages. In,
  other words, the function name should not be included.
</p>
</li>
<li>
<p>
Most debug messages should just be deleted.
</p>
</li>
<li>
<p>
Don&#8217;t bang your messages (no !).  The user feels bad enough about the
  problem already w/o you shouting at him.
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_types">Types</h5>
<div class="ulist"><ul>
<li>
<p>
Use logical types to make the code clearer and to help the compiler catch
  problems.  typedef uint16_t Port; bool foo(Port) is way better than
  int foo(int port).
</p>
</li>
<li>
<p>
Use forward declarations (e.g. struct SnortConfig;) instead of void*.
</p>
</li>
<li>
<p>
Try not to use extern data unless absolutely necessary and then put the
  extern in an appropriate header.
</p>
</li>
<li>
<p>
Use const liberally.  In most cases, const char* s = "foo" should be
  const char* const s = "foo".  The former goes in the initialized data
  section and the latter in read only data section.
</p>
</li>
<li>
<p>
But use const char s[] = "foo" instead of const char* s = "foo" when
  possible.  The latter form allocates a pointer variable and the data
  while the former allocates only the data.
</p>
</li>
<li>
<p>
Use static wherever possible to minimize public symbols and eliminate
  unneeded relocations.
</p>
</li>
<li>
<p>
Declare functions virtual only in the parent class introducing the
  function (not in a derived class that is overriding the function).
  This makes it clear which class introduces the function.
</p>
</li>
<li>
<p>
Declare functions as override if they are intended to override a
  function.  This makes it possible to find derived implementations that
  didn&#8217;t get updated and therefore won&#8217;t get called due a change in the
  parent signature.
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_macros_aka_defines">Macros (aka defines)</h5>
<div class="ulist"><ul>
<li>
<p>
In many cases, even in C++, use #define name "value" instead of a
  const char* const name = "value" because it will eliminate a symbol from
  the binary.
</p>
</li>
<li>
<p>
Use inline functions instead of macros where possible (pretty much all
  cases except where stringification is necessary).  Functions offer better
  typing, avoid re-expansions, and a debugger can break there.
</p>
</li>
<li>
<p>
All macros except simple const values should be wrapped in () and all
  args should be wrapped in () too to avoid surprises upon expansion.
  Example:
</p>
<div class="literalblock">
<div class="content">
<pre><code>#define SEQ_LT(a,b)  ((int)((a) - (b)) &lt;  0)</code></pre>
</div></div>
</li>
<li>
<p>
Multiline macros should be blocked (i.e. inside { }) to avoid if-else type
  surprises.
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_formatting">Formatting</h5>
<div class="ulist"><ul>
<li>
<p>
Indent 4 space chars &#8230; no tabs!
</p>
</li>
<li>
<p>
If you need to indent many times, something could be rewritten or
  restructured to make it clearer.  Fewer indents is generally easier to
  write, easier to read, and overall better code.
</p>
</li>
<li>
<p>
Braces go on the line immediately following a new scope (function
  signature, if, else, loop, switch, etc.
</p>
</li>
<li>
<p>
Use consistent spacing and line breaks.  Always indent 4 spaces from the
  breaking line.  Keep lines less than 100 chars; it greatly helps
  readability.
</p>
<div class="literalblock">
<div class="content">
<pre><code>No:
    calling_a_func_with_a_long_name(arg1,
                                    arg2,
                                    arg3);</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>Yes:
    calling_a_func_with_a_long_name(
        arg1, arg2, arg3);</code></pre>
</div></div>
</li>
<li>
<p>
Put function signature on one line, except when breaking for the arg
  list:
</p>
<div class="literalblock">
<div class="content">
<pre><code>No:
    inline
    bool foo()
    { // ...</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>Yes:
    inline bool foo()
    { // ...</code></pre>
</div></div>
</li>
<li>
<p>
Put conditional code on the line following the if so it is easy to break
  on the conditional block:
</p>
<div class="literalblock">
<div class="content">
<pre><code>No:
    if ( test ) foo();</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>Yes:
    if ( test )
        foo();</code></pre>
</div></div>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_headers">Headers</h5>
<div class="ulist"><ul>
<li>
<p>
Don&#8217;t hesitate to create a new header if it is needed.  Don&#8217;t lump
  unrelated stuff into a header because it is convenient.
</p>
</li>
<li>
<p>
Write header guards like this (leading underscores are reserved for
  system stuff).  In my_header.h:
</p>
<div class="literalblock">
<div class="content">
<pre><code>#ifndef MY_HEADER_H
#define MY_HEADER_H
// ...
#endif</code></pre>
</div></div>
</li>
<li>
<p>
Includes from a different directory should specify parent directory.
  This makes it clear exactly what is included and avoids the primordial
  soup that results from using -I this -I that -I the-other-thing &#8230; .
</p>
<div class="literalblock">
<div class="content">
<pre><code>// given:
src/foo/foo.cc
src/bar/bar.cc
src/bar/baz.cc</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>// in baz.cc
#include "bar.h"</code></pre>
</div></div>
<div class="literalblock">
<div class="content">
<pre><code>// in foo.cc
#include "bar/bar.h"</code></pre>
</div></div>
</li>
<li>
<p>
Just because it is a #define doesn&#8217;t mean it goes in a header.
  Everything should be scoped as tightly as possible.  Shared
  implementation declarations should go in a separate header from the
  interface.  And so on.
</p>
</li>
<li>
<p>
A .cc should include its own .h before any others (including
  system headers).  This ensures that the header stands on its own and can
  be used by clients without include prerequisites.
</p>
</li>
<li>
<p>
Include required headers, all required headers, and nothing but required
  headers.  Don&#8217;t just clone a bunch of headers because it is convenient.
</p>
</li>
<li>
<p>
Any file depending of #ifdefs should include config.h as shown below.  A
  .h should include it before any other includes, and a .cc should include
  it immediately after the include of its own .h.
</p>
<div class="literalblock">
<div class="content">
<pre><code>#ifdef HAVE_CONFIG_H
#include "config.h"
#endif</code></pre>
</div></div>
</li>
<li>
<p>
Do not put using statements in headers.
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_warnings">Warnings</h5>
<div class="ulist"><ul>
<li>
<p>
With g++, use at least these compiler flags:
</p>
<div class="literalblock">
<div class="content">
<pre><code>-Wall -Wextra -pedantic -Wformat -Wformat-security
-Wunused-but-set-variable -Wno-deprecated-declarations</code></pre>
</div></div>
</li>
<li>
<p>
Then Fix All Warnings.  None Allowed.
</p>
</li>
</ul></div>
</div>
<div class="sect4">
<h5 id="_other">Other</h5>
<div class="ulist"><ul>
<li>
<p>
Prefer <em>and</em> over &amp;&amp; and <em>or</em> over || for new source files.
</p>
</li>
</ul></div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Last updated 2014-12-15 12:42:35 EST
</div>
</div>
</body>
</html>
