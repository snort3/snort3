if ( ENABLE_UNIT_TESTS )
    set(TEST_FILES test/stream_tcp_test_utils.cc)
endif()

add_library( stream_tcp OBJECT
    held_packet_queue.cc
    held_packet_queue.h
    ips_stream_reassemble.cc
    ips_stream_size.cc
    segment_overlap_editor.cc
    segment_overlap_editor.h
    stream_tcp.cc
    stream_tcp.h
    tcp_defs.h
    tcp_event_logger.cc
    tcp_event_logger.h
    tcp_ha.cc
    tcp_ha.h
    tcp_module.cc
    tcp_module.h
    tcp_normalizer.cc
    tcp_normalizer.h
    tcp_normalizers.cc
    tcp_normalizers.h
    tcp_reassembler.cc
    tcp_reassembler.h
    tcp_reassemblers.cc
    tcp_reassemblers.h
    tcp_segment_descriptor.cc
    tcp_segment_descriptor.h
    tcp_segment_node.cc
    tcp_segment_node.h
    tcp_session.cc
    tcp_session.h
    tcp_state_closed.cc
    tcp_state_closed.h
    tcp_state_close_wait.cc
    tcp_state_close_wait.h
    tcp_state_closing.cc
    tcp_state_closing.h
    tcp_state_established.cc
    tcp_state_established.h
    tcp_state_fin_wait1.cc
    tcp_state_fin_wait1.h
    tcp_state_fin_wait2.cc
    tcp_state_fin_wait2.h
    tcp_state_handler.cc
    tcp_state_handler.h
    tcp_state_last_ack.cc
    tcp_state_last_ack.h
    tcp_state_listen.cc
    tcp_state_listen.h
    tcp_state_machine.cc
    tcp_state_machine.h
    tcp_state_mid_stream_recv.cc
    tcp_state_mid_stream_recv.h
    tcp_state_mid_stream_sent.cc
    tcp_state_mid_stream_sent.h
    tcp_state_none.cc
    tcp_state_none.h
    tcp_state_syn_recv.cc
    tcp_state_syn_recv.h
    tcp_state_syn_sent.cc
    tcp_state_syn_sent.h
    tcp_state_time_wait.cc
    tcp_state_time_wait.h
    tcp_stream_config.cc
    tcp_stream_config.h
    tcp_stream_session.cc
    tcp_stream_session.h
    tcp_stream_tracker.cc
    tcp_stream_tracker.h
    tcp_trace.cc
    tcp_trace.h
    ${TEST_FILES}
)

add_subdirectory ( test )
